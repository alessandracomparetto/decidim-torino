{"ast":null,"code":"import moment from \"moment\";\n$(function () {\n  var $impersonationWarning = $(\".impersonation-warning\");\n\n  if ($impersonationWarning.length) {\n    var endsAt = moment($impersonationWarning.data(\"session-ends-at\"));\n    var exitInterval = setInterval(function () {\n      var diff = (endsAt - moment()) / 60000;\n      var diffInMinutes = Math.round(diff);\n      $impersonationWarning.find(\".minutes\").html(diffInMinutes);\n\n      if (diff <= 0) {\n        window.location.reload();\n      }\n    }, 1000); // Prevent reload when page is already unloading, otherwise it may cause infinite reloads.\n\n    window.addEventListener(\"beforeunload\", function () {\n      clearInterval(exitInterval);\n      return;\n    });\n  }\n});","map":{"version":3,"mappings":"AAAA,OAAOA,MAAP,MAAmB,QAAnB;AAEAC,CAAC,CAAC,YAAM;AACN,MAAMC,qBAAqB,GAAGD,CAAC,CAAC,wBAAD,CAA/B;;AACA,MAAIC,qBAAqB,CAACC,MAA1B,EAAkC;AAChC,QAAMC,MAAM,GAAGJ,MAAM,CAACE,qBAAqB,CAACG,IAAtBH,CAA2B,iBAA3BA,CAAD,CAArB;AACA,QAAMI,YAAY,GAAGC,WAAW,CAAC,YAAM;AACrC,UAAMC,IAAI,GAAG,CAACJ,MAAM,GAAGJ,MAAM,EAAhB,IAAsB,KAAnC;AACA,UAAMS,aAAa,GAAGC,IAAI,CAACC,KAALD,CAAWF,IAAXE,CAAtB;AACAR,2BAAqB,CAACU,IAAtBV,CAA2B,UAA3BA,EAAuCW,IAAvCX,CAA4CO,aAA5CP;;AAEA,UAAIM,IAAI,IAAI,CAAZ,EAAe;AACbM,cAAM,CAACC,QAAPD,CAAgBE,MAAhBF;AACD;AAP6B,OAQ7B,IAR6B,CAAhC,CAFgC,CAYhC;;AACAA,UAAM,CAACG,gBAAPH,CAAwB,cAAxBA,EAAwC,YAAM;AAC5CI,mBAAa,CAACZ,YAAD,CAAbY;AACA;AAFF;AAID;AAnBF,EAADjB","names":["moment","$","$impersonationWarning","length","endsAt","data","exitInterval","setInterval","diff","diffInMinutes","Math","round","find","html","window","location","reload","addEventListener","clearInterval"],"sources":["/var/lib/gems/2.7.0/gems/decidim-core-0.26.0/app/packs/src/decidim/impersonation.js"],"sourcesContent":["import moment from \"moment\"\n\n$(() => {\n  const $impersonationWarning = $(\".impersonation-warning\");\n  if ($impersonationWarning.length) {\n    const endsAt = moment($impersonationWarning.data(\"session-ends-at\"));\n    const exitInterval = setInterval(() => {\n      const diff = (endsAt - moment()) / 60000;\n      const diffInMinutes = Math.round(diff);\n      $impersonationWarning.find(\".minutes\").html(diffInMinutes);\n\n      if (diff <= 0) {\n        window.location.reload();\n      }\n    }, 1000);\n\n    // Prevent reload when page is already unloading, otherwise it may cause infinite reloads.\n    window.addEventListener(\"beforeunload\", () => {\n      clearInterval(exitInterval);\n      return;\n    });\n  }\n});\n"]},"metadata":{},"sourceType":"module"}