{"ast":null,"code":"import AutoButtonsByPositionComponent from \"src/decidim/admin/auto_buttons_by_position.component\";\nimport AutoLabelByPositionComponent from \"src/decidim/admin/auto_label_by_position.component\";\nimport createDynamicFields from \"src/decidim/admin/dynamic_fields.component\";\nimport createSortList from \"src/decidim/admin/sort_list.component\";\n$(function () {\n  var dynamicFieldDefinitions = [{\n    placeHolderId: \"external-domain-id\",\n    wrapperSelector: \".external-domains\",\n    fieldSelector: \".external-domain\",\n    addFieldSelector: \".add-external-domain\"\n  }];\n  dynamicFieldDefinitions.forEach(function (section) {\n    var fieldSelectorSuffix = section.fieldSelector.replace(\".\", \"\");\n    var autoButtonsByPosition = new AutoButtonsByPositionComponent({\n      listSelector: \"\".concat(section.fieldSelector, \":not(.hidden)\"),\n      hideOnFirstSelector: \".move-up-question\",\n      hideOnLastSelector: \".move-down-question\"\n    });\n    var autoLabelByPosition = new AutoLabelByPositionComponent({\n      listSelector: \"\".concat(section.fieldSelector, \":not(.hidden)\"),\n      labelSelector: \".card-title span:first\",\n      onPositionComputed: function onPositionComputed(el, idx) {\n        $(el).find(\"input[name$=\\\\[position\\\\]]\").val(idx);\n      }\n    });\n\n    var createSortableList = function createSortableList() {\n      createSortList(\".external-domains-list:not(.published)\", {\n        handle: \".external-domain-divider\",\n        placeholder: '<div style=\"border-style: dashed; border-color: #000\"></div>',\n        forcePlaceholderSize: true,\n        onSortUpdate: function onSortUpdate() {\n          autoLabelByPosition.run();\n          autoButtonsByPosition.run();\n        }\n      });\n    };\n\n    var hideDeletedItem = function hideDeletedItem($target) {\n      var inputDeleted = $target.find(\"input[name$=\\\\[deleted\\\\]]\").val();\n\n      if (inputDeleted === \"true\") {\n        $target.addClass(\"hidden\");\n        $target.hide(); // Allows re-submitting of the form\n\n        $(\"input\", $target).removeAttr(\"required\");\n      }\n    };\n\n    createDynamicFields({\n      placeholderId: section.placeHolderId,\n      wrapperSelector: section.wrapperSelector,\n      containerSelector: \"\".concat(section.wrapperSelector, \"-list\"),\n      fieldSelector: section.fieldSelector,\n      addFieldButtonSelector: section.addFieldSelector,\n      removeFieldButtonSelector: \".remove-\".concat(fieldSelectorSuffix),\n      moveUpFieldButtonSelector: \".move-up-question\",\n      moveDownFieldButtonSelector: \".move-down-question\",\n      onAddField: function onAddField() {\n        createSortableList();\n        autoLabelByPosition.run();\n        autoButtonsByPosition.run();\n      },\n      onRemoveField: function onRemoveField($field) {\n        autoLabelByPosition.run();\n        autoButtonsByPosition.run(); // Allows re-submitting of the form\n\n        $(\"input\", $field).removeAttr(\"required\");\n      },\n      onMoveUpField: function onMoveUpField() {\n        autoLabelByPosition.run();\n        autoButtonsByPosition.run();\n      },\n      onMoveDownField: function onMoveDownField() {\n        autoLabelByPosition.run();\n        autoButtonsByPosition.run();\n      }\n    });\n    createSortableList();\n    $(section.fieldSelector).each(function (_idx, el) {\n      var $target = $(el);\n      hideDeletedItem($target);\n    });\n    autoLabelByPosition.run();\n    autoButtonsByPosition.run();\n  });\n});","map":{"version":3,"mappings":"AAAA,OAAOA,8BAAP,MAA2C,sDAA3C;AACA,OAAOC,4BAAP,MAAyC,oDAAzC;AACA,OAAOC,mBAAP,MAAgC,4CAAhC;AACA,OAAOC,cAAP,MAA2B,uCAA3B;AAEAC,CAAC,CAAC,YAAM;AACN,MAAMC,uBAAuB,GAAG,CAC9B;AACEC,iBAAa,EAAE,oBADjB;AAEEC,mBAAe,EAAE,mBAFnB;AAGEC,iBAAa,EAAE,kBAHjB;AAIEC,oBAAgB,EAAE;AAJpB,GAD8B,CAAhC;AASAJ,yBAAuB,CAACK,OAAxBL,CAAgC,UAACM,OAAD,EAAa;AAC3C,QAAMC,mBAAmB,GAAGD,OAAO,CAACH,aAARG,CAAsBE,OAAtBF,CAA8B,GAA9BA,EAAmC,EAAnCA,CAA5B;AAEA,QAAMG,qBAAqB,GAAG,IAAId,8BAAJ,CAAmC;AAC/De,kBAAY,YAAKJ,OAAO,CAACH,aAAb,kBADmD;AAE/DQ,yBAAmB,EAAE,mBAF0C;AAG/DC,wBAAkB,EAAE;AAH2C,KAAnC,CAA9B;AAMA,QAAMC,mBAAmB,GAAG,IAAIjB,4BAAJ,CAAiC;AAC3Dc,kBAAY,YAAKJ,OAAO,CAACH,aAAb,kBAD+C;AAE3DW,mBAAa,EAAE,wBAF4C;AAG3DC,wBAAkB,EAAE,4BAACC,EAAD,EAAKC,GAAL,EAAa;AAC/BlB,SAAC,CAACiB,EAAD,CAADjB,CAAMmB,IAANnB,CAAW,6BAAXA,EAA0CoB,GAA1CpB,CAA8CkB,GAA9ClB;AACD;AAL0D,KAAjC,CAA5B;;AAQA,QAAMqB,kBAAkB,GAAG,SAArBA,kBAAqB,GAAM;AAC/BtB,oBAAc,CAAC,wCAAD,EAA2C;AACvDuB,cAAM,EAAE,0BAD+C;AAEvDC,mBAAW,EAAE,8DAF0C;AAGvDC,4BAAoB,EAAE,IAHiC;AAIvDC,oBAAY,EAAE,wBAAM;AAClBX,6BAAmB,CAACY,GAApBZ;AACAJ,+BAAqB,CAACgB,GAAtBhB;AACD;AAPsD,OAA3C,CAAdX;AADF;;AAYA,QAAM4B,eAAe,GAAG,SAAlBA,eAAkB,CAACC,OAAD,EAAa;AACnC,UAAMC,YAAY,GAAGD,OAAO,CAACT,IAARS,CAAa,4BAAbA,EAA2CR,GAA3CQ,EAArB;;AAEA,UAAIC,YAAY,KAAK,MAArB,EAA6B;AAC3BD,eAAO,CAACE,QAARF,CAAiB,QAAjBA;AACAA,eAAO,CAACG,IAARH,GAF2B,CAI3B;;AACA5B,SAAC,CAAC,OAAD,EAAU4B,OAAV,CAAD5B,CAAoBgC,UAApBhC,CAA+B,UAA/BA;AACD;AATH;;AAYAF,uBAAmB,CAAC;AAClBmC,mBAAa,EAAE1B,OAAO,CAACL,aADL;AAElBC,qBAAe,EAAEI,OAAO,CAACJ,eAFP;AAGlB+B,uBAAiB,YAAK3B,OAAO,CAACJ,eAAb,UAHC;AAIlBC,mBAAa,EAAEG,OAAO,CAACH,aAJL;AAKlB+B,4BAAsB,EAAE5B,OAAO,CAACF,gBALd;AAMlB+B,+BAAyB,oBAAa5B,mBAAb,CANP;AAOlB6B,+BAAyB,EAAE,mBAPT;AAQlBC,iCAA2B,EAAE,qBARX;AASlBC,gBAAU,EAAE,sBAAM;AAChBlB,0BAAkB;AAElBP,2BAAmB,CAACY,GAApBZ;AACAJ,6BAAqB,CAACgB,GAAtBhB;AAbgB;AAelB8B,mBAAa,EAAE,uBAACC,MAAD,EAAY;AACzB3B,2BAAmB,CAACY,GAApBZ;AACAJ,6BAAqB,CAACgB,GAAtBhB,GAFyB,CAIzB;;AACAV,SAAC,CAAC,OAAD,EAAUyC,MAAV,CAADzC,CAAmBgC,UAAnBhC,CAA8B,UAA9BA;AApBgB;AAsBlB0C,mBAAa,EAAE,yBAAM;AACnB5B,2BAAmB,CAACY,GAApBZ;AACAJ,6BAAqB,CAACgB,GAAtBhB;AAxBgB;AA0BlBiC,qBAAe,EAAE,2BAAM;AACrB7B,2BAAmB,CAACY,GAApBZ;AACAJ,6BAAqB,CAACgB,GAAtBhB;AACD;AA7BiB,KAAD,CAAnBZ;AAgCAuB,sBAAkB;AAElBrB,KAAC,CAACO,OAAO,CAACH,aAAT,CAADJ,CAAyB4C,IAAzB5C,CAA8B,UAAC6C,IAAD,EAAO5B,EAAP,EAAc;AAC1C,UAAMW,OAAO,GAAG5B,CAAC,CAACiB,EAAD,CAAjB;AAEAU,qBAAe,CAACC,OAAD,CAAfD;AAHF;AAMAb,uBAAmB,CAACY,GAApBZ;AACAJ,yBAAqB,CAACgB,GAAtBhB;AAlFF;AAVD,EAADV","names":["AutoButtonsByPositionComponent","AutoLabelByPositionComponent","createDynamicFields","createSortList","$","dynamicFieldDefinitions","placeHolderId","wrapperSelector","fieldSelector","addFieldSelector","forEach","section","fieldSelectorSuffix","replace","autoButtonsByPosition","listSelector","hideOnFirstSelector","hideOnLastSelector","autoLabelByPosition","labelSelector","onPositionComputed","el","idx","find","val","createSortableList","handle","placeholder","forcePlaceholderSize","onSortUpdate","run","hideDeletedItem","$target","inputDeleted","addClass","hide","removeAttr","placeholderId","containerSelector","addFieldButtonSelector","removeFieldButtonSelector","moveUpFieldButtonSelector","moveDownFieldButtonSelector","onAddField","onRemoveField","$field","onMoveUpField","onMoveDownField","each","_idx"],"sources":["/var/lib/gems/2.7.0/gems/decidim-admin-0.26.0/app/packs/src/decidim/admin/external_domain_whitelist.js"],"sourcesContent":["import AutoButtonsByPositionComponent from \"src/decidim/admin/auto_buttons_by_position.component\"\nimport AutoLabelByPositionComponent from \"src/decidim/admin/auto_label_by_position.component\"\nimport createDynamicFields from \"src/decidim/admin/dynamic_fields.component\"\nimport createSortList from \"src/decidim/admin/sort_list.component\"\n\n$(() => {\n  const dynamicFieldDefinitions = [\n    {\n      placeHolderId: \"external-domain-id\",\n      wrapperSelector: \".external-domains\",\n      fieldSelector: \".external-domain\",\n      addFieldSelector: \".add-external-domain\"\n    }\n  ];\n\n  dynamicFieldDefinitions.forEach((section) => {\n    const fieldSelectorSuffix = section.fieldSelector.replace(\".\", \"\");\n\n    const autoButtonsByPosition = new AutoButtonsByPositionComponent({\n      listSelector: `${section.fieldSelector}:not(.hidden)`,\n      hideOnFirstSelector: \".move-up-question\",\n      hideOnLastSelector: \".move-down-question\"\n    });\n\n    const autoLabelByPosition = new AutoLabelByPositionComponent({\n      listSelector: `${section.fieldSelector}:not(.hidden)`,\n      labelSelector: \".card-title span:first\",\n      onPositionComputed: (el, idx) => {\n        $(el).find(\"input[name$=\\\\[position\\\\]]\").val(idx);\n      }\n    });\n\n    const createSortableList = () => {\n      createSortList(\".external-domains-list:not(.published)\", {\n        handle: \".external-domain-divider\",\n        placeholder: '<div style=\"border-style: dashed; border-color: #000\"></div>',\n        forcePlaceholderSize: true,\n        onSortUpdate: () => {\n          autoLabelByPosition.run();\n          autoButtonsByPosition.run();\n        }\n      });\n    };\n\n    const hideDeletedItem = ($target) => {\n      const inputDeleted = $target.find(\"input[name$=\\\\[deleted\\\\]]\").val();\n\n      if (inputDeleted === \"true\") {\n        $target.addClass(\"hidden\");\n        $target.hide();\n\n        // Allows re-submitting of the form\n        $(\"input\", $target).removeAttr(\"required\");\n      }\n    };\n\n    createDynamicFields({\n      placeholderId: section.placeHolderId,\n      wrapperSelector: section.wrapperSelector,\n      containerSelector: `${section.wrapperSelector}-list`,\n      fieldSelector: section.fieldSelector,\n      addFieldButtonSelector: section.addFieldSelector,\n      removeFieldButtonSelector: `.remove-${fieldSelectorSuffix}`,\n      moveUpFieldButtonSelector: \".move-up-question\",\n      moveDownFieldButtonSelector: \".move-down-question\",\n      onAddField: () => {\n        createSortableList();\n\n        autoLabelByPosition.run();\n        autoButtonsByPosition.run();\n      },\n      onRemoveField: ($field) => {\n        autoLabelByPosition.run();\n        autoButtonsByPosition.run();\n\n        // Allows re-submitting of the form\n        $(\"input\", $field).removeAttr(\"required\");\n      },\n      onMoveUpField: () => {\n        autoLabelByPosition.run();\n        autoButtonsByPosition.run();\n      },\n      onMoveDownField: () => {\n        autoLabelByPosition.run();\n        autoButtonsByPosition.run();\n      }\n    });\n\n    createSortableList();\n\n    $(section.fieldSelector).each((_idx, el) => {\n      const $target = $(el);\n\n      hideDeletedItem($target);\n    });\n\n    autoLabelByPosition.run();\n    autoButtonsByPosition.run();\n  });\n});\n"]},"metadata":{},"sourceType":"module"}