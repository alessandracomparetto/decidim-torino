{"ast":null,"code":"import AutoButtonsByPositionComponent from \"src/decidim/admin/auto_buttons_by_position.component\";\nimport AutoLabelByPositionComponent from \"src/decidim/admin/auto_label_by_position.component\";\nimport createSortList from \"src/decidim/admin/sort_list.component\";\nimport createDynamicFields from \"src/decidim/admin/dynamic_fields.component\";\nimport createQuillEditor from \"src/decidim/editor\";\nvar wrapperSelector = \".meeting-agenda-items\";\nvar fieldSelector = \".meeting-agenda-item\";\nvar childsWrapperSelector = \".meeting-agenda-item-childs\";\nvar childFieldSelector = \".meeting-agenda-item-child\";\nvar autoLabelByPosition = new AutoLabelByPositionComponent({\n  listSelector: \".meeting-agenda-item:not(.hidden)\",\n  labelSelector: \".card-title span:first\",\n  onPositionComputed: function onPositionComputed(el, idx) {\n    $(el).find(\"input[name$=\\\\[position\\\\]]\").val(idx);\n  }\n});\nvar autoButtonsByPosition = new AutoButtonsByPositionComponent({\n  listSelector: \".meeting-agenda-item:not(.hidden)\",\n  hideOnFirstSelector: \".move-up-agenda-item\",\n  hideOnLastSelector: \".move-down-agenda-item\"\n});\n\nvar createSortableList = function createSortableList() {\n  createSortList(\".meeting-agenda-items-list:not(.published)\", {\n    handle: \".agenda-item-divider\",\n    placeholder: '<div style=\"border-style: dashed; border-color: #000\"></div>',\n    forcePlaceholderSize: true,\n    onSortUpdate: function onSortUpdate() {\n      autoLabelByPosition.run();\n    }\n  });\n};\n\nvar createSortableListChild = function createSortableListChild() {\n  createSortList(\".meeting-agenda-item-childs-list:not(.published)\", {\n    handle: \".agenda-item-child-divider\",\n    placeholder: '<div style=\"border-style: dashed; border-color: #000\"></div>',\n    forcePlaceholderSize: true,\n    onSortUpdate: function onSortUpdate() {\n      autoLabelByPosition.run();\n    }\n  });\n};\n\nvar autoLabelByPositionChild = new AutoLabelByPositionComponent({\n  listSelector: \".meeting-agenda-item-child:not(.hidden)\",\n  labelSelector: \".card-title span:first\",\n  onPositionComputed: function onPositionComputed(el, idx) {\n    $(el).find(\"input[name$=\\\\[position\\\\]]\").val(idx);\n  }\n});\nvar autoButtonsByPositionChild = new AutoButtonsByPositionComponent({\n  listSelector: \".meeting-agenda-item-child:not(.hidden)\",\n  hideOnFirstSelector: \".move-up-agenda-item-child\",\n  hideOnLastSelector: \".move-down-agenda-item-child\"\n});\n\nvar createDynamicFieldsForAgendaItemChilds = function createDynamicFieldsForAgendaItemChilds(fieldId) {\n  return createDynamicFields({\n    placeholderId: \"meeting-agenda-item-child-id\",\n    wrapperSelector: \"#\".concat(fieldId, \" \").concat(childsWrapperSelector),\n    containerSelector: \".meeting-agenda-item-childs-list\",\n    fieldSelector: childFieldSelector,\n    addFieldButtonSelector: \".add-agenda-item-child\",\n    removeFieldButtonSelector: \".remove-agenda-item-child\",\n    moveUpFieldButtonSelector: \".move-up-agenda-item-child\",\n    moveDownFieldButtonSelector: \".move-down-agenda-item-child\",\n    onAddField: function onAddField($field) {\n      createSortableListChild();\n      $field.find(\".editor-container\").each(function (idx, el) {\n        createQuillEditor(el);\n      });\n      autoLabelByPositionChild.run();\n      autoButtonsByPositionChild.run();\n    },\n    onRemoveField: function onRemoveField() {\n      autoLabelByPositionChild.run();\n      autoButtonsByPositionChild.run();\n    },\n    onMoveUpField: function onMoveUpField() {\n      autoLabelByPositionChild.run();\n      autoButtonsByPositionChild.run();\n    },\n    onMoveDownField: function onMoveDownField() {\n      autoLabelByPositionChild.run();\n      autoButtonsByPositionChild.run();\n    }\n  });\n};\n\nvar dynamicFieldsForAgendaItemChilds = {};\n\nvar setupInitialAgendaItemChildAttributes = function setupInitialAgendaItemChildAttributes($target) {\n  var fieldId = $target.attr(\"id\");\n  dynamicFieldsForAgendaItemChilds[fieldId] = createDynamicFieldsForAgendaItemChilds(fieldId);\n};\n\nvar hideDeletedAgendaItem = function hideDeletedAgendaItem($target) {\n  var inputDeleted = $target.find(\"input[name$=\\\\[deleted\\\\]]\").val();\n\n  if (inputDeleted === \"true\") {\n    $target.addClass(\"hidden\");\n    $target.hide();\n  }\n};\n\ncreateDynamicFields({\n  placeholderId: \"meeting-agenda-item-id\",\n  wrapperSelector: wrapperSelector,\n  containerSelector: \".meeting-agenda-items-list\",\n  fieldSelector: fieldSelector,\n  addFieldButtonSelector: \".add-agenda-item\",\n  removeFieldButtonSelector: \".remove-agenda-item\",\n  moveUpFieldButtonSelector: \".move-up-agenda-item\",\n  moveDownFieldButtonSelector: \".move-down-agenda-item\",\n  onAddField: function onAddField($field) {\n    // createDynamicFieldsForAgendaItemChilds($field);\n    setupInitialAgendaItemChildAttributes($field);\n    createSortableList();\n    $field.find(\".editor-container\").each(function (idx, el) {\n      createQuillEditor(el);\n    });\n    autoLabelByPosition.run();\n    autoButtonsByPosition.run();\n  },\n  onRemoveField: function onRemoveField() {\n    autoLabelByPosition.run();\n    autoButtonsByPosition.run();\n  },\n  onMoveUpField: function onMoveUpField() {\n    autoLabelByPosition.run();\n    autoButtonsByPosition.run();\n  },\n  onMoveDownField: function onMoveDownField() {\n    autoLabelByPosition.run();\n    autoButtonsByPosition.run();\n  }\n});\ncreateSortableList();\n$(fieldSelector).each(function (idx, el) {\n  var $target = $(el);\n  hideDeletedAgendaItem($target);\n  setupInitialAgendaItemChildAttributes($target);\n});\nautoLabelByPosition.run();\nautoButtonsByPosition.run();\nautoLabelByPositionChild.run();\nautoButtonsByPositionChild.run();","map":{"version":3,"mappings":"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","names":["AutoButtonsByPositionComponent","AutoLabelByPositionComponent","createSortList","createDynamicFields","createQuillEditor","wrapperSelector","fieldSelector","childsWrapperSelector","childFieldSelector","autoLabelByPosition","listSelector","labelSelector","onPositionComputed","el","idx","$","find","val","autoButtonsByPosition","hideOnFirstSelector","hideOnLastSelector","createSortableList","handle","placeholder","forcePlaceholderSize","onSortUpdate","run","createSortableListChild","autoLabelByPositionChild","autoButtonsByPositionChild","createDynamicFieldsForAgendaItemChilds","fieldId","placeholderId","containerSelector","addFieldButtonSelector","removeFieldButtonSelector","moveUpFieldButtonSelector","moveDownFieldButtonSelector","onAddField","$field","each","onRemoveField","onMoveUpField","onMoveDownField","dynamicFieldsForAgendaItemChilds","setupInitialAgendaItemChildAttributes","$target","attr","hideDeletedAgendaItem","inputDeleted","addClass","hide"],"sources":["/var/lib/gems/2.7.0/gems/decidim-meetings-0.26.0/app/packs/src/decidim/meetings/admin/agendas.js"],"sourcesContent":["import AutoButtonsByPositionComponent from \"src/decidim/admin/auto_buttons_by_position.component\"\nimport AutoLabelByPositionComponent from \"src/decidim/admin/auto_label_by_position.component\"\nimport createSortList from \"src/decidim/admin/sort_list.component\"\nimport createDynamicFields from \"src/decidim/admin/dynamic_fields.component\"\nimport createQuillEditor from \"src/decidim/editor\"\n\nconst wrapperSelector = \".meeting-agenda-items\";\nconst fieldSelector = \".meeting-agenda-item\";\nconst childsWrapperSelector = \".meeting-agenda-item-childs\";\nconst childFieldSelector = \".meeting-agenda-item-child\";\n\nconst autoLabelByPosition = new AutoLabelByPositionComponent({\n  listSelector: \".meeting-agenda-item:not(.hidden)\",\n  labelSelector: \".card-title span:first\",\n  onPositionComputed: (el, idx) => {\n    $(el).find(\"input[name$=\\\\[position\\\\]]\").val(idx);\n  }\n});\n\nconst autoButtonsByPosition = new AutoButtonsByPositionComponent({\n  listSelector: \".meeting-agenda-item:not(.hidden)\",\n  hideOnFirstSelector: \".move-up-agenda-item\",\n  hideOnLastSelector: \".move-down-agenda-item\"\n});\n\nconst createSortableList = () => {\n  createSortList(\".meeting-agenda-items-list:not(.published)\", {\n    handle: \".agenda-item-divider\",\n    placeholder: '<div style=\"border-style: dashed; border-color: #000\"></div>',\n    forcePlaceholderSize: true,\n    onSortUpdate: () => { autoLabelByPosition.run() }\n  });\n};\n\nconst createSortableListChild = () => {\n  createSortList(\".meeting-agenda-item-childs-list:not(.published)\", {\n    handle: \".agenda-item-child-divider\",\n    placeholder: '<div style=\"border-style: dashed; border-color: #000\"></div>',\n    forcePlaceholderSize: true,\n    onSortUpdate: () => { autoLabelByPosition.run() }\n  });\n};\n\nconst autoLabelByPositionChild = new AutoLabelByPositionComponent({\n  listSelector: \".meeting-agenda-item-child:not(.hidden)\",\n  labelSelector: \".card-title span:first\",\n  onPositionComputed: (el, idx) => {\n    $(el).find(\"input[name$=\\\\[position\\\\]]\").val(idx);\n  }\n});\n\nconst autoButtonsByPositionChild = new AutoButtonsByPositionComponent({\n  listSelector: \".meeting-agenda-item-child:not(.hidden)\",\n  hideOnFirstSelector: \".move-up-agenda-item-child\",\n  hideOnLastSelector: \".move-down-agenda-item-child\"\n});\n\nconst createDynamicFieldsForAgendaItemChilds = (fieldId) => {\n  return createDynamicFields({\n    placeholderId: \"meeting-agenda-item-child-id\",\n    wrapperSelector: `#${fieldId} ${childsWrapperSelector}`,\n    containerSelector: \".meeting-agenda-item-childs-list\",\n    fieldSelector: childFieldSelector,\n    addFieldButtonSelector: \".add-agenda-item-child\",\n    removeFieldButtonSelector: \".remove-agenda-item-child\",\n    moveUpFieldButtonSelector: \".move-up-agenda-item-child\",\n    moveDownFieldButtonSelector: \".move-down-agenda-item-child\",\n\n    onAddField: ($field) => {\n      createSortableListChild();\n\n      $field.find(\".editor-container\").each((idx, el) => {\n        createQuillEditor(el);\n      });\n\n      autoLabelByPositionChild.run();\n      autoButtonsByPositionChild.run();\n    },\n    onRemoveField: () => {\n      autoLabelByPositionChild.run();\n      autoButtonsByPositionChild.run();\n    },\n    onMoveUpField: () => {\n      autoLabelByPositionChild.run();\n      autoButtonsByPositionChild.run();\n    },\n    onMoveDownField: () => {\n      autoLabelByPositionChild.run();\n      autoButtonsByPositionChild.run();\n    }\n  });\n};\n\nconst dynamicFieldsForAgendaItemChilds = {};\n\nconst setupInitialAgendaItemChildAttributes = ($target) => {\n  const fieldId = $target.attr(\"id\");\n\n  dynamicFieldsForAgendaItemChilds[fieldId] = createDynamicFieldsForAgendaItemChilds(fieldId);\n\n}\n\nconst hideDeletedAgendaItem = ($target) => {\n  const inputDeleted = $target.find(\"input[name$=\\\\[deleted\\\\]]\").val();\n\n  if (inputDeleted === \"true\") {\n    $target.addClass(\"hidden\");\n    $target.hide();\n  }\n};\n\ncreateDynamicFields({\n  placeholderId: \"meeting-agenda-item-id\",\n  wrapperSelector: wrapperSelector,\n  containerSelector: \".meeting-agenda-items-list\",\n  fieldSelector: fieldSelector,\n  addFieldButtonSelector: \".add-agenda-item\",\n  removeFieldButtonSelector: \".remove-agenda-item\",\n  moveUpFieldButtonSelector: \".move-up-agenda-item\",\n  moveDownFieldButtonSelector: \".move-down-agenda-item\",\n  onAddField: ($field) => {\n    // createDynamicFieldsForAgendaItemChilds($field);\n    setupInitialAgendaItemChildAttributes($field);\n    createSortableList();\n\n    $field.find(\".editor-container\").each((idx, el) => {\n      createQuillEditor(el);\n    });\n\n    autoLabelByPosition.run();\n    autoButtonsByPosition.run();\n  },\n  onRemoveField: () => {\n    autoLabelByPosition.run();\n    autoButtonsByPosition.run();\n  },\n  onMoveUpField: () => {\n    autoLabelByPosition.run();\n    autoButtonsByPosition.run();\n  },\n  onMoveDownField: () => {\n    autoLabelByPosition.run();\n    autoButtonsByPosition.run();\n  }\n});\n\ncreateSortableList();\n\n$(fieldSelector).each((idx, el) => {\n  const $target = $(el);\n\n  hideDeletedAgendaItem($target);\n  setupInitialAgendaItemChildAttributes($target);\n});\n\nautoLabelByPosition.run();\nautoButtonsByPosition.run();\nautoLabelByPositionChild.run();\nautoButtonsByPositionChild.run();\n"]},"metadata":{},"sourceType":"module"}