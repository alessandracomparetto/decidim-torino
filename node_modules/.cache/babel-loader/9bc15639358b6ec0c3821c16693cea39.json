{"ast":null,"code":"/* eslint-disable */\n\n/* Origin: https://github.com/Platoniq/quill-image-upload */\n(function () {\n  var exports = {};\n  \"use strict\";\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n\n  var _createClass = function () {\n    function e(e, t) {\n      for (var a = 0; a < t.length; a++) {\n        var i = t[a];\n        i.enumerable = i.enumerable || false;\n        i.configurable = true;\n        if (\"value\" in i) i.writable = true;\n        Object.defineProperty(e, i.key, i);\n      }\n    }\n\n    return function (t, a, i) {\n      if (a) e(t.prototype, a);\n      if (i) e(t, i);\n      return t;\n    };\n  }();\n\n  function _classCallCheck(e, t) {\n    if (!(e instanceof t)) {\n      throw new TypeError(\"Cannot call a class as a function\");\n    }\n  }\n\n  var ImageUpload = exports.ImageUpload = function () {\n    function e(t) {\n      var a = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n      _classCallCheck(this, e);\n\n      this.quill = t;\n      this.options = a;\n      this.quill.getModule(\"toolbar\").addHandler(\"image\", this.selectLocalImage.bind(this));\n      this.handleDrop = this.handleDrop.bind(this);\n      this.handlePaste = this.handlePaste.bind(this);\n      this.quill.root.addEventListener(\"drop\", this.handleDrop, false);\n      this.quill.root.addEventListener(\"paste\", this.handlePaste, false);\n    }\n\n    _createClass(e, [{\n      key: \"selectLocalImage\",\n      value: function e() {\n        var t = this;\n        var a = document.createElement(\"input\");\n        a.setAttribute(\"type\", \"file\");\n        a.click();\n\n        a.onchange = function () {\n          var e = a.files[0];\n\n          if (/^image\\//.test(e.type)) {\n            var i = t.options.checkBeforeSend || t.checkBeforeSend.bind(t);\n            i(e, t.sendToServer.bind(t));\n          } else {\n            console.warn(\"You could only upload images.\");\n          }\n        };\n      }\n    }, {\n      key: \"checkBeforeSend\",\n      value: function e(t, a) {\n        a(t);\n      }\n    }, {\n      key: \"sendToServer\",\n      value: function e(t) {\n        var a = this;\n\n        if (this.options.customUploader) {\n          this.options.customUploader(t, function (e) {\n            a.insert(e);\n          });\n        } else {\n          var i = this.options.url,\n              n = this.options.method || \"POST\",\n              s = this.options.name || \"image\",\n              o = this.options.headers || {},\n              r = this.options.callbackOK || this.uploadImageCallbackOK.bind(this),\n              l = this.options.callbackKO || this.uploadImageCallbackKO.bind(this);\n\n          if (i) {\n            var d = new FormData();\n            d.append(s, t);\n\n            if (this.options.csrf) {\n              d.append(this.options.csrf.token, this.options.csrf.hash);\n            }\n\n            var c = new XMLHttpRequest();\n            c.open(n, i, true);\n\n            for (var u in o) {\n              c.setRequestHeader(u, o[u]);\n            }\n\n            c.onload = function () {\n              if (c.status === 200) {\n                r(JSON.parse(c.responseText), a.insert.bind(a));\n              } else {\n                l({\n                  code: c.status,\n                  type: c.statusText,\n                  body: c.responseText\n                });\n              }\n            };\n\n            if (this.options.withCredentials) {\n              c.withCredentials = true;\n            }\n\n            c.send(d);\n          } else {\n            var f = new FileReader();\n\n            f.onload = function (e) {\n              r(e.target.result, a.insert.bind(a));\n            };\n\n            f.readAsDataURL(t);\n          }\n        }\n      }\n    }, {\n      key: \"handleDrop\",\n      value: function e(t) {\n        t.preventDefault();\n\n        if (t.dataTransfer && t.dataTransfer.files && t.dataTransfer.files.length) {\n          if (document.caretRangeFromPoint) {\n            var a = document.getSelection();\n            var i = document.caretRangeFromPoint(t.clientX, t.clientY);\n\n            if (a && i) {\n              a.setBaseAndExtent(i.startContainer, i.startOffset, i.startContainer, i.startOffset);\n            }\n          }\n\n          this.readFiles(t.dataTransfer.files, this.sendToServer.bind(this));\n        }\n      }\n    }, {\n      key: \"handlePaste\",\n      value: function e(t) {\n        var a = this;\n        var i = Quill[\"import\"](\"delta\");\n\n        if (t.clipboardData && t.clipboardData.items && t.clipboardData.items.length) {\n          this.readFiles(t.clipboardData.items, function (e) {\n            var t = a.quill.getSelection();\n\n            if (t) {\n              a.quill.updateContents(new i().retain(t.index - 1)[\"delete\"](1));\n            }\n\n            setTimeout(function () {\n              return a.sendToServer(e.getAsFile());\n            }, 0);\n          });\n        }\n      }\n    }, {\n      key: \"readFiles\",\n      value: function e(t, a) {\n        var i = this;\n        [].forEach.call(t, function (e) {\n          if (!/^image\\//.test(e.type)) {\n            return;\n          }\n\n          var t = new FileReader();\n\n          t.onload = function (t) {\n            var n = i.options.checkBeforeSend || i.checkBeforeSend.bind(i);\n            n(e, a);\n          };\n\n          var n = e.getAsFile ? e.getAsFile() : e;\n\n          if (n instanceof Blob) {\n            t.readAsDataURL(n);\n          }\n        });\n      }\n    }, {\n      key: \"insert\",\n      value: function e(t) {\n        var a = (this.quill.getSelection() || {}).index || this.quill.getLength();\n        this.quill.insertEmbed(a, \"image\", t, \"user\");\n      }\n    }, {\n      key: \"uploadImageCallbackOK\",\n      value: function e(t, a) {\n        a(t);\n      }\n    }, {\n      key: \"uploadImageCallbackKO\",\n      value: function e(t) {\n        alert(t);\n      }\n    }]);\n\n    return e;\n  }();\n\n  window.Quill.register('modules/imageUpload', exports.ImageUpload);\n})();","map":{"version":3,"mappings":"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","names":["exports","Object","defineProperty","value","_createClass","e","t","a","length","i","enumerable","configurable","writable","key","prototype","_classCallCheck","TypeError","ImageUpload","arguments","undefined","quill","options","getModule","addHandler","selectLocalImage","bind","handleDrop","handlePaste","root","addEventListener","document","createElement","setAttribute","click","onchange","files","test","type","checkBeforeSend","sendToServer","console","warn","customUploader","insert","url","n","method","s","name","o","headers","r","callbackOK","uploadImageCallbackOK","l","callbackKO","uploadImageCallbackKO","d","FormData","append","csrf","token","hash","c","XMLHttpRequest","open","u","setRequestHeader","onload","status","JSON","parse","responseText","code","statusText","body","withCredentials","send","f","FileReader","target","result","readAsDataURL","preventDefault","dataTransfer","caretRangeFromPoint","getSelection","clientX","clientY","setBaseAndExtent","startContainer","startOffset","readFiles","Quill","clipboardData","items","updateContents","retain","index","setTimeout","getAsFile","forEach","call","Blob","getLength","insertEmbed","alert","window","register"],"sources":["/var/lib/gems/2.7.0/gems/decidim-core-0.26.0/app/packs/src/decidim/vendor/image-upload.min.js"],"sourcesContent":["/* eslint-disable */\n\n/* Origin: https://github.com/Platoniq/quill-image-upload */\n(function () {\n    var exports = {};\n\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:true});var _createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||false;i.configurable=true;if(\"value\"in i)i.writable=true;Object.defineProperty(e,i.key,i)}}return function(t,a,i){if(a)e(t.prototype,a);if(i)e(t,i);return t}}();function _classCallCheck(e,t){if(!(e instanceof t)){throw new TypeError(\"Cannot call a class as a function\")}}var ImageUpload=exports.ImageUpload=function(){function e(t){var a=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};_classCallCheck(this,e);this.quill=t;this.options=a;this.quill.getModule(\"toolbar\").addHandler(\"image\",this.selectLocalImage.bind(this));this.handleDrop=this.handleDrop.bind(this);this.handlePaste=this.handlePaste.bind(this);this.quill.root.addEventListener(\"drop\",this.handleDrop,false);this.quill.root.addEventListener(\"paste\",this.handlePaste,false)}_createClass(e,[{key:\"selectLocalImage\",value:function e(){var t=this;var a=document.createElement(\"input\");a.setAttribute(\"type\",\"file\");a.click();a.onchange=function(){var e=a.files[0];if(/^image\\//.test(e.type)){var i=t.options.checkBeforeSend||t.checkBeforeSend.bind(t);i(e,t.sendToServer.bind(t))}else{console.warn(\"You could only upload images.\")}}}},{key:\"checkBeforeSend\",value:function e(t,a){a(t)}},{key:\"sendToServer\",value:function e(t){var a=this;if(this.options.customUploader){this.options.customUploader(t,function(e){a.insert(e)})}else{var i=this.options.url,n=this.options.method||\"POST\",s=this.options.name||\"image\",o=this.options.headers||{},r=this.options.callbackOK||this.uploadImageCallbackOK.bind(this),l=this.options.callbackKO||this.uploadImageCallbackKO.bind(this);if(i){var d=new FormData;d.append(s,t);if(this.options.csrf){d.append(this.options.csrf.token,this.options.csrf.hash)}var c=new XMLHttpRequest;c.open(n,i,true);for(var u in o){c.setRequestHeader(u,o[u])}c.onload=function(){if(c.status===200){r(JSON.parse(c.responseText),a.insert.bind(a))}else{l({code:c.status,type:c.statusText,body:c.responseText})}};if(this.options.withCredentials){c.withCredentials=true}c.send(d)}else{var f=new FileReader;f.onload=function(e){r(e.target.result,a.insert.bind(a))};f.readAsDataURL(t)}}}},{key:\"handleDrop\",value:function e(t){t.preventDefault();if(t.dataTransfer&&t.dataTransfer.files&&t.dataTransfer.files.length){if(document.caretRangeFromPoint){var a=document.getSelection();var i=document.caretRangeFromPoint(t.clientX,t.clientY);if(a&&i){a.setBaseAndExtent(i.startContainer,i.startOffset,i.startContainer,i.startOffset)}}this.readFiles(t.dataTransfer.files,this.sendToServer.bind(this))}}},{key:\"handlePaste\",value:function e(t){var a=this;var i=Quill.import(\"delta\");if(t.clipboardData&&t.clipboardData.items&&t.clipboardData.items.length){this.readFiles(t.clipboardData.items,function(e){var t=a.quill.getSelection();if(t){a.quill.updateContents((new i).retain(t.index-1).delete(1))}setTimeout(function(){return a.sendToServer(e.getAsFile())},0)})}}},{key:\"readFiles\",value:function e(t,a){var i=this;[].forEach.call(t,function(e){if(!/^image\\//.test(e.type)){return}var t=new FileReader;t.onload=function(t){var n=i.options.checkBeforeSend||i.checkBeforeSend.bind(i);n(e,a)};var n=e.getAsFile?e.getAsFile():e;if(n instanceof Blob){t.readAsDataURL(n)}})}},{key:\"insert\",value:function e(t){var a=(this.quill.getSelection()||{}).index||this.quill.getLength();this.quill.insertEmbed(a,\"image\",t,\"user\")}},{key:\"uploadImageCallbackOK\",value:function e(t,a){a(t)}},{key:\"uploadImageCallbackKO\",value:function e(t){alert(t)}}]);return e}();\n    window.Quill.register('modules/imageUpload', exports.ImageUpload);\n})();\n"]},"metadata":{},"sourceType":"module"}