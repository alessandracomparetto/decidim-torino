{"ast":null,"code":"import attachGeocoding from \"src/decidim/geocoding/attach_input\";\nimport getCoordinateInputName from \"src/decidim/geocoding/coordinate_input\";\n$(function () {\n  var $checkbox = $(\"input:checkbox[name$='[has_address]']\");\n  var $addressInput = $(\"#address_input\");\n  var $addressInputField = $(\"input\", $addressInput);\n  var $map = $(\"#address_map\");\n  var latFieldName = \"latitude\";\n  var longFieldName = \"longitude\";\n\n  if ($addressInputField.length > 0) {\n    latFieldName = getCoordinateInputName(\"latitude\", $addressInputField, {});\n    longFieldName = getCoordinateInputName(\"longitude\", $addressInputField, {});\n  }\n\n  $map.hide();\n\n  if ($checkbox.length > 0) {\n    var toggleInput = function toggleInput() {\n      if ($checkbox[0].checked) {\n        $addressInput.show();\n        $addressInputField.prop(\"disabled\", false);\n      } else {\n        $addressInput.hide();\n        $addressInputField.prop(\"disabled\", true);\n      }\n    };\n\n    toggleInput();\n    $checkbox.on(\"change\", toggleInput);\n  }\n\n  if ($addressInput.length > 0) {\n    if ($checkbox[0].checked) {\n      $map.show();\n    }\n\n    var ctrl = $(\"[data-decidim-map]\").data(\"map-controller\");\n    ctrl.setEventHandler(\"coordinates\", function (ev) {\n      $(\"input[name='\".concat(latFieldName, \"']\")).val(ev.lat);\n      $(\"input[name='\".concat(longFieldName, \"']\")).val(ev.lng);\n    });\n    attachGeocoding($addressInputField, null, function (coordinates) {\n      $map.show(); // Remove previous marker when user updates address in address field\n\n      ctrl.removeMarker();\n      ctrl.addMarker({\n        latitude: coordinates[0],\n        longitude: coordinates[1],\n        address: $addressInput.val()\n      });\n    });\n  }\n});","map":{"version":3,"mappings":"AAAA,OAAOA,eAAP,MAA4B,oCAA5B;AACA,OAAOC,sBAAP,MAAmC,wCAAnC;AAEAC,CAAC,CAAC,YAAM;AACN,MAAMC,SAAS,GAAGD,CAAC,CAAC,uCAAD,CAAnB;AACA,MAAME,aAAa,GAAGF,CAAC,CAAC,gBAAD,CAAvB;AACA,MAAMG,kBAAkB,GAAGH,CAAC,CAAC,OAAD,EAAUE,aAAV,CAA5B;AACA,MAAME,IAAI,GAAGJ,CAAC,CAAC,cAAD,CAAd;AACA,MAAIK,YAAY,GAAG,UAAnB;AACA,MAAIC,aAAa,GAAG,WAApB;;AAEA,MAAIH,kBAAkB,CAACI,MAAnBJ,GAA4B,CAAhC,EAAmC;AACjCE,gBAAY,GAAGN,sBAAsB,CAAC,UAAD,EAAaI,kBAAb,EAAiC,EAAjC,CAArCE;AACAC,iBAAa,GAAGP,sBAAsB,CAAC,WAAD,EAAcI,kBAAd,EAAkC,EAAlC,CAAtCG;AACD;;AAEDF,MAAI,CAACI,IAALJ;;AAEA,MAAIH,SAAS,CAACM,MAAVN,GAAmB,CAAvB,EAA0B;AACxB,QAAMQ,WAAW,GAAG,SAAdA,WAAc,GAAM;AACxB,UAAIR,SAAS,CAAC,CAAD,CAATA,CAAaS,OAAjB,EAA0B;AACxBR,qBAAa,CAACS,IAAdT;AACAC,0BAAkB,CAACS,IAAnBT,CAAwB,UAAxBA,EAAoC,KAApCA;AAFF,aAGO;AACLD,qBAAa,CAACM,IAAdN;AACAC,0BAAkB,CAACS,IAAnBT,CAAwB,UAAxBA,EAAoC,IAApCA;AACD;AAPH;;AASAM,eAAW;AACXR,aAAS,CAACY,EAAVZ,CAAa,QAAbA,EAAuBQ,WAAvBR;AACD;;AAED,MAAIC,aAAa,CAACK,MAAdL,GAAuB,CAA3B,EAA8B;AAC5B,QAAID,SAAS,CAAC,CAAD,CAATA,CAAaS,OAAjB,EAA0B;AACxBN,UAAI,CAACO,IAALP;AACD;;AAED,QAAMU,IAAI,GAAGd,CAAC,CAAC,oBAAD,CAADA,CAAwBe,IAAxBf,CAA6B,gBAA7BA,CAAb;AACAc,QAAI,CAACE,eAALF,CAAqB,aAArBA,EAAoC,UAACG,EAAD,EAAQ;AAC1CjB,OAAC,uBAAgBK,YAAhB,QAADL,CAAmCkB,GAAnClB,CAAuCiB,EAAE,CAACE,GAA1CnB;AACAA,OAAC,uBAAgBM,aAAhB,QAADN,CAAoCkB,GAApClB,CAAwCiB,EAAE,CAACG,GAA3CpB;AAFF;AAKAF,mBAAe,CAACK,kBAAD,EAAqB,IAArB,EAA2B,UAACkB,WAAD,EAAiB;AACzDjB,UAAI,CAACO,IAALP,GADyD,CAEzD;;AACAU,UAAI,CAACQ,YAALR;AACAA,UAAI,CAACS,SAALT,CAAe;AACbU,gBAAQ,EAAEH,WAAW,CAAC,CAAD,CADR;AAEbI,iBAAS,EAAEJ,WAAW,CAAC,CAAD,CAFT;AAGbK,eAAO,EAAExB,aAAa,CAACgB,GAAdhB;AAHI,OAAfY;AAJa,MAAfhB;AAUD;AAlDF,EAADE","names":["attachGeocoding","getCoordinateInputName","$","$checkbox","$addressInput","$addressInputField","$map","latFieldName","longFieldName","length","hide","toggleInput","checked","show","prop","on","ctrl","data","setEventHandler","ev","val","lat","lng","coordinates","removeMarker","addMarker","latitude","longitude","address"],"sources":["/var/lib/gems/2.7.0/gems/decidim-proposals-0.26.0/app/packs/src/decidim/proposals/add_proposal.js"],"sourcesContent":["import attachGeocoding from \"src/decidim/geocoding/attach_input\"\nimport getCoordinateInputName from \"src/decidim/geocoding/coordinate_input\";\n\n$(() => {\n  const $checkbox = $(\"input:checkbox[name$='[has_address]']\");\n  const $addressInput = $(\"#address_input\");\n  const $addressInputField = $(\"input\", $addressInput);\n  const $map = $(\"#address_map\");\n  let latFieldName = \"latitude\";\n  let longFieldName = \"longitude\";\n\n  if ($addressInputField.length > 0) {\n    latFieldName = getCoordinateInputName(\"latitude\", $addressInputField, {})\n    longFieldName = getCoordinateInputName(\"longitude\", $addressInputField, {})\n  }\n\n  $map.hide();\n\n  if ($checkbox.length > 0) {\n    const toggleInput = () => {\n      if ($checkbox[0].checked) {\n        $addressInput.show();\n        $addressInputField.prop(\"disabled\", false);\n      } else {\n        $addressInput.hide();\n        $addressInputField.prop(\"disabled\", true);\n      }\n    }\n    toggleInput();\n    $checkbox.on(\"change\", toggleInput);\n  }\n\n  if ($addressInput.length > 0) {\n    if ($checkbox[0].checked) {\n      $map.show();\n    }\n\n    const ctrl = $(\"[data-decidim-map]\").data(\"map-controller\");\n    ctrl.setEventHandler(\"coordinates\", (ev) => {\n      $(`input[name='${latFieldName}']`).val(ev.lat);\n      $(`input[name='${longFieldName}']`).val(ev.lng);\n    });\n\n    attachGeocoding($addressInputField, null, (coordinates) => {\n      $map.show();\n      // Remove previous marker when user updates address in address field\n      ctrl.removeMarker();\n      ctrl.addMarker({\n        latitude: coordinates[0],\n        longitude: coordinates[1],\n        address: $addressInput.val()\n      });\n    });\n  }\n});\n"]},"metadata":{},"sourceType":"module"}