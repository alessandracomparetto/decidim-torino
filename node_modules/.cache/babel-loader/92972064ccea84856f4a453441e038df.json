{"ast":null,"code":"/* eslint-disable max-lines */\n\n/* eslint-disable require-jsdoc */\nimport AutoButtonsByMinItemsComponent from \"src/decidim/forms/admin/auto_buttons_by_min_items.component\";\nimport AutoSelectOptionsByTotalItemsComponent from \"src/decidim/forms/admin/auto_select_options_by_total_items.component\";\nimport AutoSelectOptionsFromUrl from \"src/decidim/forms/admin/auto_select_options_from_url.component\";\nimport createLiveTextUpdateComponent from \"src/decidim/forms/admin/live_text_update.component\";\nimport AutoButtonsByPositionComponent from \"src/decidim/admin/auto_buttons_by_position.component\";\nimport AutoLabelByPositionComponent from \"src/decidim/admin/auto_label_by_position.component\";\nimport createSortList from \"src/decidim/admin/sort_list.component\";\nimport createDynamicFields from \"src/decidim/admin/dynamic_fields.component\";\nimport createFieldDependentInputs from \"src/decidim/admin/field_dependent_inputs.component\";\nimport createQuillEditor from \"src/decidim/editor\";\nexport default function createEditableForm() {\n  var wrapperSelector = \".questionnaire-questions\";\n  var fieldSelector = \".questionnaire-question\";\n  var questionTypeSelector = \"select[name$=\\\\[question_type\\\\]]\";\n  var answerOptionFieldSelector = \".questionnaire-question-answer-option\";\n  var answerOptionsWrapperSelector = \".questionnaire-question-answer-options\";\n  var answerOptionRemoveFieldButtonSelector = \".remove-answer-option\";\n  var matrixRowFieldSelector = \".questionnaire-question-matrix-row\";\n  var matrixRowsWrapperSelector = \".questionnaire-question-matrix-rows\";\n  var matrixRowRemoveFieldButtonSelector = \".remove-matrix-row\";\n  var addMatrixRowButtonSelector = \".add-matrix-row\";\n  var maxChoicesWrapperSelector = \".questionnaire-question-max-choices\";\n  var displayConditionFieldSelector = \".questionnaire-question-display-condition\";\n  var displayConditionsWrapperSelector = \".questionnaire-question-display-conditions\";\n  var displayConditionRemoveFieldButtonSelector = \".remove-display-condition\";\n  var displayConditionQuestionSelector = \"select[name$=\\\\[decidim_condition_question_id\\\\]]\";\n  var displayConditionAnswerOptionSelector = \"select[name$=\\\\[decidim_answer_option_id\\\\]]\";\n  var displayConditionTypeSelector = \"select[name$=\\\\[condition_type\\\\]]\";\n  var deletedInputSelector = \"input[name$=\\\\[deleted\\\\]]\";\n  var displayConditionValueWrapperSelector = \".questionnaire-question-display-condition-value\";\n  var displayconditionAnswerOptionWrapperSelector = \".questionnaire-question-display-condition-answer-option\";\n  var addDisplayConditionButtonSelector = \".add-display-condition\";\n\n  var removeDisplayConditionsForFirstQuestion = function removeDisplayConditionsForFirstQuestion() {\n    $(fieldSelector).each(function (idx, el) {\n      var $question = $(el);\n\n      if (idx) {\n        $question.find(displayConditionsWrapperSelector).find(deletedInputSelector).val(\"false\");\n        $question.find(displayConditionsWrapperSelector).show();\n      } else {\n        $question.find(displayConditionsWrapperSelector).find(deletedInputSelector).val(\"true\");\n        $question.find(displayConditionsWrapperSelector).hide();\n      }\n    });\n  };\n\n  var autoButtonsByPosition = new AutoButtonsByPositionComponent({\n    listSelector: \".questionnaire-question:not(.hidden)\",\n    hideOnFirstSelector: \".move-up-question\",\n    hideOnLastSelector: \".move-down-question\"\n  });\n  var autoLabelByPosition = new AutoLabelByPositionComponent({\n    listSelector: \".questionnaire-question:not(.hidden)\",\n    labelSelector: \".card-title span:first\",\n    onPositionComputed: function onPositionComputed(el, idx) {\n      $(el).find(\"input[name$=\\\\[position\\\\]]:not([name*=\\\\[matrix_rows\\\\]])\").val(idx);\n      autoButtonsByPosition.run();\n      removeDisplayConditionsForFirstQuestion();\n    }\n  });\n  var MULTIPLE_CHOICE_VALUES = [\"single_option\", \"multiple_option\", \"sorting\", \"matrix_single\", \"matrix_multiple\"];\n  var MATRIX_VALUES = [\"matrix_single\", \"matrix_multiple\"];\n\n  var createAutoMaxChoicesByNumberOfAnswerOptions = function createAutoMaxChoicesByNumberOfAnswerOptions(fieldId) {\n    return new AutoSelectOptionsByTotalItemsComponent({\n      wrapperSelector: fieldSelector,\n      selectSelector: \"\".concat(maxChoicesWrapperSelector, \" select\"),\n      listSelector: \"#\".concat(fieldId, \" \").concat(answerOptionsWrapperSelector, \" .questionnaire-question-answer-option:not(.hidden)\")\n    });\n  };\n\n  var createAutoButtonsByMinItemsForAnswerOptions = function createAutoButtonsByMinItemsForAnswerOptions(fieldId) {\n    return new AutoButtonsByMinItemsComponent({\n      wrapperSelector: fieldSelector,\n      listSelector: \"#\".concat(fieldId, \" \").concat(answerOptionsWrapperSelector, \" .questionnaire-question-answer-option:not(.hidden)\"),\n      minItems: 2,\n      hideOnMinItemsOrLessSelector: answerOptionRemoveFieldButtonSelector\n    });\n  };\n\n  var createAutoSelectOptionsFromUrl = function createAutoSelectOptionsFromUrl($field) {\n    return new AutoSelectOptionsFromUrl({\n      source: $field.find(displayConditionQuestionSelector),\n      select: $field.find(displayConditionAnswerOptionSelector),\n      sourceToParams: function sourceToParams($element) {\n        return {\n          id: $element.val()\n        };\n      }\n    });\n  };\n\n  var createSortableList = function createSortableList() {\n    createSortList(\".questionnaire-questions-list:not(.published)\", {\n      handle: \".question-divider\",\n      placeholder: '<div style=\"border-style: dashed; border-color: #000\"></div>',\n      forcePlaceholderSize: true,\n      onSortUpdate: function onSortUpdate() {\n        autoLabelByPosition.run();\n        autoButtonsByPosition.run();\n      }\n    });\n  };\n\n  var createDynamicQuestionTitle = function createDynamicQuestionTitle(fieldId) {\n    var targetSelector = \"#\".concat(fieldId, \" .question-title-statement\");\n    var locale = $(targetSelector).data(\"locale\");\n    var maxLength = $(targetSelector).data(\"max-length\");\n    var omission = $(targetSelector).data(\"omission\");\n    var placeholder = $(targetSelector).data(\"placeholder\");\n    return createLiveTextUpdateComponent({\n      inputSelector: \"#\".concat(fieldId, \" input[name$=\\\\[body_\").concat(locale, \"\\\\]]\"),\n      targetSelector: targetSelector,\n      maxLength: maxLength,\n      omission: omission,\n      placeholder: placeholder\n    });\n  };\n\n  var createCollapsibleQuestion = function createCollapsibleQuestion($target) {\n    var $collapsible = $target.find(\".collapsible\");\n\n    if ($collapsible.length > 0) {\n      var collapsibleId = $collapsible.attr(\"id\").replace(\"-question-card\", \"\");\n      var toggleAttr = \"\".concat(collapsibleId, \"-question-card button--collapse-question-\").concat(collapsibleId, \" button--expand-question-\").concat(collapsibleId);\n      $target.find(\".question--collapse\").data(\"toggle\", toggleAttr);\n    }\n  };\n\n  var createDynamicFieldsForAnswerOptions = function createDynamicFieldsForAnswerOptions(fieldId) {\n    var autoButtons = createAutoButtonsByMinItemsForAnswerOptions(fieldId);\n    var autoSelectOptions = createAutoMaxChoicesByNumberOfAnswerOptions(fieldId);\n    return createDynamicFields({\n      placeholderId: \"questionnaire-question-answer-option-id\",\n      wrapperSelector: \"#\".concat(fieldId, \" \").concat(answerOptionsWrapperSelector),\n      containerSelector: \".questionnaire-question-answer-options-list\",\n      fieldSelector: answerOptionFieldSelector,\n      addFieldButtonSelector: \".add-answer-option\",\n      fieldTemplateSelector: \".decidim-answer-option-template\",\n      removeFieldButtonSelector: answerOptionRemoveFieldButtonSelector,\n      onAddField: function onAddField() {\n        autoButtons.run();\n        autoSelectOptions.run();\n      },\n      onRemoveField: function onRemoveField() {\n        autoButtons.run();\n        autoSelectOptions.run();\n      }\n    });\n  };\n\n  var dynamicFieldsForAnswerOptions = {};\n\n  var createDynamicFieldsForMatrixRows = function createDynamicFieldsForMatrixRows(fieldId) {\n    return createDynamicFields({\n      placeholderId: \"questionnaire-question-matrix-row-id\",\n      wrapperSelector: \"#\".concat(fieldId, \" \").concat(matrixRowsWrapperSelector),\n      containerSelector: \".questionnaire-question-matrix-rows-list\",\n      fieldSelector: matrixRowFieldSelector,\n      addFieldButtonSelector: addMatrixRowButtonSelector,\n      fieldTemplateSelector: \".decidim-matrix-row-template\",\n      removeFieldButtonSelector: matrixRowRemoveFieldButtonSelector,\n      onAddField: function onAddField() {},\n      onRemoveField: function onRemoveField() {}\n    });\n  };\n\n  var dynamicFieldsForMatrixRows = {};\n\n  var isMultipleChoiceOption = function isMultipleChoiceOption(value) {\n    return MULTIPLE_CHOICE_VALUES.indexOf(value) >= 0;\n  };\n\n  var isMatrix = function isMatrix(value) {\n    return MATRIX_VALUES.indexOf(value) >= 0;\n  };\n\n  var getSelectedQuestionType = function getSelectedQuestionType(select) {\n    var selectedOption = select.options[select.selectedIndex];\n    return $(selectedOption).data(\"type\");\n  };\n\n  var onDisplayConditionQuestionChange = function onDisplayConditionQuestionChange($field) {\n    var $questionSelector = $field.find(displayConditionQuestionSelector);\n    var selectedQuestionType = getSelectedQuestionType($questionSelector[0]);\n    var isMultiple = isMultipleChoiceOption(selectedQuestionType);\n    var conditionTypes = [\"answered\", \"not_answered\"];\n\n    if (isMultiple) {\n      conditionTypes.push(\"equal\");\n      conditionTypes.push(\"not_equal\");\n    }\n\n    conditionTypes.push(\"match\");\n    var $conditionTypeSelect = $field.find(displayConditionTypeSelector);\n    $conditionTypeSelect.find(\"option\").each(function (idx, option) {\n      var $option = $(option);\n      var value = $option.val();\n\n      if (!value) {\n        return;\n      }\n\n      $option.show();\n\n      if (conditionTypes.indexOf(value) < 0) {\n        $option.hide();\n      }\n    });\n\n    if (conditionTypes.indexOf($conditionTypeSelect.val()) < 0) {\n      $conditionTypeSelect.val(conditionTypes[0]);\n    }\n\n    $conditionTypeSelect.trigger(\"change\");\n  };\n\n  var onDisplayConditionTypeChange = function onDisplayConditionTypeChange($field) {\n    var value = $field.find(displayConditionTypeSelector).val();\n    var $valueWrapper = $field.find(displayConditionValueWrapperSelector);\n    var $answerOptionWrapper = $field.find(displayconditionAnswerOptionWrapperSelector);\n    var $questionSelector = $field.find(displayConditionQuestionSelector);\n    var selectedQuestionType = getSelectedQuestionType($questionSelector[0]);\n    var isMultiple = isMultipleChoiceOption(selectedQuestionType);\n\n    if (value === \"match\") {\n      $valueWrapper.show();\n    } else {\n      $valueWrapper.hide();\n    }\n\n    if (isMultiple && (value === \"not_equal\" || value === \"equal\")) {\n      $answerOptionWrapper.show();\n    } else {\n      $answerOptionWrapper.hide();\n    }\n  };\n\n  var initializeDisplayConditionField = function initializeDisplayConditionField($field) {\n    var autoSelectByUrl = createAutoSelectOptionsFromUrl($field);\n    autoSelectByUrl.run();\n    $field.find(displayConditionQuestionSelector).on(\"change\", function () {\n      onDisplayConditionQuestionChange($field);\n    });\n    $field.find(displayConditionTypeSelector).on(\"change\", function () {\n      onDisplayConditionTypeChange($field);\n    });\n    onDisplayConditionTypeChange($field);\n    onDisplayConditionQuestionChange($field);\n  };\n\n  var createDynamicFieldsForDisplayConditions = function createDynamicFieldsForDisplayConditions(fieldId) {\n    return createDynamicFields({\n      placeholderId: \"questionnaire-question-display-condition-id\",\n      wrapperSelector: \"#\".concat(fieldId, \" \").concat(displayConditionsWrapperSelector),\n      containerSelector: \".questionnaire-question-display-conditions-list\",\n      fieldSelector: displayConditionFieldSelector,\n      addFieldButtonSelector: addDisplayConditionButtonSelector,\n      removeFieldButtonSelector: displayConditionRemoveFieldButtonSelector,\n      onAddField: function onAddField($field) {\n        initializeDisplayConditionField($field);\n      },\n      onRemoveField: function onRemoveField() {}\n    });\n  };\n\n  var dynamicFieldsForDisplayConditions = {};\n\n  var setupInitialQuestionAttributes = function setupInitialQuestionAttributes($target) {\n    var fieldId = $target.attr(\"id\");\n    var $fieldQuestionTypeSelect = $target.find(questionTypeSelector);\n    createCollapsibleQuestion($target);\n    createDynamicQuestionTitle(fieldId);\n    createFieldDependentInputs({\n      controllerField: $fieldQuestionTypeSelect,\n      wrapperSelector: fieldSelector,\n      dependentFieldsSelector: answerOptionsWrapperSelector,\n      dependentInputSelector: \"\".concat(answerOptionFieldSelector, \" input\"),\n      enablingCondition: function enablingCondition($field) {\n        return isMultipleChoiceOption($field.val());\n      }\n    });\n    createFieldDependentInputs({\n      controllerField: $fieldQuestionTypeSelect,\n      wrapperSelector: fieldSelector,\n      dependentFieldsSelector: maxChoicesWrapperSelector,\n      dependentInputSelector: \"select\",\n      enablingCondition: function enablingCondition($field) {\n        return $field.val() === \"multiple_option\" || $field.val() === \"matrix_multiple\";\n      }\n    });\n    createFieldDependentInputs({\n      controllerField: $fieldQuestionTypeSelect,\n      wrapperSelector: fieldSelector,\n      dependentFieldsSelector: matrixRowsWrapperSelector,\n      dependentInputSelector: \"\".concat(matrixRowFieldSelector, \" input\"),\n      enablingCondition: function enablingCondition($field) {\n        return isMatrix($field.val());\n      }\n    });\n    dynamicFieldsForAnswerOptions[fieldId] = createDynamicFieldsForAnswerOptions(fieldId);\n    dynamicFieldsForMatrixRows[fieldId] = createDynamicFieldsForMatrixRows(fieldId);\n    dynamicFieldsForDisplayConditions[fieldId] = createDynamicFieldsForDisplayConditions(fieldId);\n    var dynamicFieldsAnswerOptions = dynamicFieldsForAnswerOptions[fieldId];\n    var dynamicFieldsMatrixRows = dynamicFieldsForMatrixRows[fieldId];\n\n    var onQuestionTypeChange = function onQuestionTypeChange() {\n      if (isMultipleChoiceOption($fieldQuestionTypeSelect.val())) {\n        var nOptions = $fieldQuestionTypeSelect.parents(fieldSelector).find(answerOptionFieldSelector).length;\n\n        if (nOptions === 0) {\n          dynamicFieldsAnswerOptions._addField();\n\n          dynamicFieldsAnswerOptions._addField();\n        }\n      }\n\n      if (isMatrix($fieldQuestionTypeSelect.val())) {\n        var nRows = $fieldQuestionTypeSelect.parents(fieldSelector).find(matrixRowFieldSelector).length;\n\n        if (nRows === 0) {\n          dynamicFieldsMatrixRows._addField();\n\n          dynamicFieldsMatrixRows._addField();\n        }\n      }\n    };\n\n    $fieldQuestionTypeSelect.on(\"change\", onQuestionTypeChange);\n    onQuestionTypeChange();\n  };\n\n  var hideDeletedQuestion = function hideDeletedQuestion($target) {\n    var inputDeleted = $target.find(\"input[name$=\\\\[deleted\\\\]]\").val();\n\n    if (inputDeleted === \"true\") {\n      $target.addClass(\"hidden\");\n      $target.hide();\n    }\n  };\n\n  createDynamicFields({\n    placeholderId: \"questionnaire-question-id\",\n    wrapperSelector: wrapperSelector,\n    containerSelector: \".questionnaire-questions-list\",\n    fieldSelector: fieldSelector,\n    addFieldButtonSelector: \".add-question\",\n    addSeparatorButtonSelector: \".add-separator\",\n    addTitleAndDescriptionButtonSelector: \".add-title-and-description\",\n    fieldTemplateSelector: \".decidim-question-template\",\n    separatorTemplateSelector: \".decidim-separator-template\",\n    TitleAndDescriptionTemplateSelector: \".decidim-title-and-description-template\",\n    removeFieldButtonSelector: \".remove-question\",\n    moveUpFieldButtonSelector: \".move-up-question\",\n    moveDownFieldButtonSelector: \".move-down-question\",\n    onAddField: function onAddField($field) {\n      setupInitialQuestionAttributes($field);\n      createSortableList();\n      $field.find(\".editor-container\").each(function (idx, el) {\n        createQuillEditor(el);\n      });\n      autoLabelByPosition.run();\n      autoButtonsByPosition.run();\n    },\n    onRemoveField: function onRemoveField($field) {\n      autoLabelByPosition.run();\n      autoButtonsByPosition.run();\n      $field.find(answerOptionRemoveFieldButtonSelector).each(function (idx, el) {\n        dynamicFieldsForAnswerOptions[$field.attr(\"id\")]._removeField(el);\n      });\n      $field.find(matrixRowRemoveFieldButtonSelector).each(function (idx, el) {\n        dynamicFieldsForMatrixRows[$field.attr(\"id\")]._removeField(el);\n      });\n      $field.find(displayConditionRemoveFieldButtonSelector).each(function (idx, el) {\n        dynamicFieldsForDisplayConditions[$field.attr(\"id\")]._removeField(el);\n      });\n    },\n    onMoveUpField: function onMoveUpField() {\n      autoLabelByPosition.run();\n      autoButtonsByPosition.run();\n    },\n    onMoveDownField: function onMoveDownField() {\n      autoLabelByPosition.run();\n      autoButtonsByPosition.run();\n    }\n  });\n  createSortableList();\n  $(fieldSelector).each(function (idx, el) {\n    var $target = $(el);\n    hideDeletedQuestion($target);\n    setupInitialQuestionAttributes($target);\n  });\n  $(displayConditionFieldSelector).each(function (idx, el) {\n    var $field = $(el);\n    initializeDisplayConditionField($field);\n  });\n  autoLabelByPosition.run();\n  autoButtonsByPosition.run();\n}","map":{"version":3,"mappings":"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","names":["AutoButtonsByMinItemsComponent","AutoSelectOptionsByTotalItemsComponent","AutoSelectOptionsFromUrl","createLiveTextUpdateComponent","AutoButtonsByPositionComponent","AutoLabelByPositionComponent","createSortList","createDynamicFields","createFieldDependentInputs","createQuillEditor","createEditableForm","wrapperSelector","fieldSelector","questionTypeSelector","answerOptionFieldSelector","answerOptionsWrapperSelector","answerOptionRemoveFieldButtonSelector","matrixRowFieldSelector","matrixRowsWrapperSelector","matrixRowRemoveFieldButtonSelector","addMatrixRowButtonSelector","maxChoicesWrapperSelector","displayConditionFieldSelector","displayConditionsWrapperSelector","displayConditionRemoveFieldButtonSelector","displayConditionQuestionSelector","displayConditionAnswerOptionSelector","displayConditionTypeSelector","deletedInputSelector","displayConditionValueWrapperSelector","displayconditionAnswerOptionWrapperSelector","addDisplayConditionButtonSelector","removeDisplayConditionsForFirstQuestion","$","each","idx","el","$question","find","val","show","hide","autoButtonsByPosition","listSelector","hideOnFirstSelector","hideOnLastSelector","autoLabelByPosition","labelSelector","onPositionComputed","run","MULTIPLE_CHOICE_VALUES","MATRIX_VALUES","createAutoMaxChoicesByNumberOfAnswerOptions","fieldId","selectSelector","createAutoButtonsByMinItemsForAnswerOptions","minItems","hideOnMinItemsOrLessSelector","createAutoSelectOptionsFromUrl","$field","source","select","sourceToParams","$element","id","createSortableList","handle","placeholder","forcePlaceholderSize","onSortUpdate","createDynamicQuestionTitle","targetSelector","locale","data","maxLength","omission","inputSelector","createCollapsibleQuestion","$target","$collapsible","length","collapsibleId","attr","replace","toggleAttr","createDynamicFieldsForAnswerOptions","autoButtons","autoSelectOptions","placeholderId","containerSelector","addFieldButtonSelector","fieldTemplateSelector","removeFieldButtonSelector","onAddField","onRemoveField","dynamicFieldsForAnswerOptions","createDynamicFieldsForMatrixRows","dynamicFieldsForMatrixRows","isMultipleChoiceOption","value","indexOf","isMatrix","getSelectedQuestionType","selectedOption","options","selectedIndex","onDisplayConditionQuestionChange","$questionSelector","selectedQuestionType","isMultiple","conditionTypes","push","$conditionTypeSelect","option","$option","trigger","onDisplayConditionTypeChange","$valueWrapper","$answerOptionWrapper","initializeDisplayConditionField","autoSelectByUrl","on","createDynamicFieldsForDisplayConditions","dynamicFieldsForDisplayConditions","setupInitialQuestionAttributes","$fieldQuestionTypeSelect","controllerField","dependentFieldsSelector","dependentInputSelector","enablingCondition","dynamicFieldsAnswerOptions","dynamicFieldsMatrixRows","onQuestionTypeChange","nOptions","parents","_addField","nRows","hideDeletedQuestion","inputDeleted","addClass","addSeparatorButtonSelector","addTitleAndDescriptionButtonSelector","separatorTemplateSelector","TitleAndDescriptionTemplateSelector","moveUpFieldButtonSelector","moveDownFieldButtonSelector","_removeField","onMoveUpField","onMoveDownField"],"sources":["/var/lib/gems/2.7.0/gems/decidim-forms-0.26.0/app/packs/src/decidim/forms/admin/forms.js"],"sourcesContent":["/* eslint-disable max-lines */\n/* eslint-disable require-jsdoc */\n\nimport AutoButtonsByMinItemsComponent from \"src/decidim/forms/admin/auto_buttons_by_min_items.component\"\nimport AutoSelectOptionsByTotalItemsComponent from \"src/decidim/forms/admin/auto_select_options_by_total_items.component\"\nimport AutoSelectOptionsFromUrl from \"src/decidim/forms/admin/auto_select_options_from_url.component\"\nimport createLiveTextUpdateComponent from \"src/decidim/forms/admin/live_text_update.component\"\nimport AutoButtonsByPositionComponent from \"src/decidim/admin/auto_buttons_by_position.component\"\nimport AutoLabelByPositionComponent from \"src/decidim/admin/auto_label_by_position.component\"\nimport createSortList from \"src/decidim/admin/sort_list.component\"\nimport createDynamicFields from \"src/decidim/admin/dynamic_fields.component\"\nimport createFieldDependentInputs from \"src/decidim/admin/field_dependent_inputs.component\"\nimport createQuillEditor from \"src/decidim/editor\"\n\nexport default function createEditableForm() {\n  const wrapperSelector = \".questionnaire-questions\";\n  const fieldSelector = \".questionnaire-question\";\n  const questionTypeSelector = \"select[name$=\\\\[question_type\\\\]]\";\n  const answerOptionFieldSelector = \".questionnaire-question-answer-option\";\n  const answerOptionsWrapperSelector = \".questionnaire-question-answer-options\";\n  const answerOptionRemoveFieldButtonSelector = \".remove-answer-option\";\n  const matrixRowFieldSelector = \".questionnaire-question-matrix-row\";\n  const matrixRowsWrapperSelector = \".questionnaire-question-matrix-rows\";\n  const matrixRowRemoveFieldButtonSelector = \".remove-matrix-row\";\n  const addMatrixRowButtonSelector = \".add-matrix-row\";\n  const maxChoicesWrapperSelector = \".questionnaire-question-max-choices\";\n\n  const displayConditionFieldSelector = \".questionnaire-question-display-condition\";\n  const displayConditionsWrapperSelector = \".questionnaire-question-display-conditions\";\n  const displayConditionRemoveFieldButtonSelector = \".remove-display-condition\";\n\n  const displayConditionQuestionSelector = \"select[name$=\\\\[decidim_condition_question_id\\\\]]\";\n  const displayConditionAnswerOptionSelector = \"select[name$=\\\\[decidim_answer_option_id\\\\]]\";\n  const displayConditionTypeSelector = \"select[name$=\\\\[condition_type\\\\]]\";\n  const deletedInputSelector = \"input[name$=\\\\[deleted\\\\]]\";\n\n  const displayConditionValueWrapperSelector = \".questionnaire-question-display-condition-value\";\n  const displayconditionAnswerOptionWrapperSelector = \".questionnaire-question-display-condition-answer-option\";\n\n  const addDisplayConditionButtonSelector = \".add-display-condition\";\n\n  const removeDisplayConditionsForFirstQuestion = () => {\n    $(fieldSelector).each((idx, el) => {\n      const $question = $(el);\n      if (idx) {\n        $question.find(displayConditionsWrapperSelector).find(deletedInputSelector).val(\"false\");\n        $question.find(displayConditionsWrapperSelector).show();\n      }\n      else {\n        $question.find(displayConditionsWrapperSelector).find(deletedInputSelector).val(\"true\");\n        $question.find(displayConditionsWrapperSelector).hide();\n      }\n    });\n  };\n\n  const autoButtonsByPosition = new AutoButtonsByPositionComponent({\n    listSelector: \".questionnaire-question:not(.hidden)\",\n    hideOnFirstSelector: \".move-up-question\",\n    hideOnLastSelector: \".move-down-question\"\n  });\n\n  const autoLabelByPosition = new AutoLabelByPositionComponent({\n    listSelector: \".questionnaire-question:not(.hidden)\",\n    labelSelector: \".card-title span:first\",\n    onPositionComputed: (el, idx) => {\n      $(el).find(\"input[name$=\\\\[position\\\\]]:not([name*=\\\\[matrix_rows\\\\]])\").val(idx);\n\n      autoButtonsByPosition.run();\n\n      removeDisplayConditionsForFirstQuestion();\n    }\n  });\n\n  const MULTIPLE_CHOICE_VALUES = [\"single_option\", \"multiple_option\", \"sorting\", \"matrix_single\", \"matrix_multiple\"];\n  const MATRIX_VALUES = [\"matrix_single\", \"matrix_multiple\"];\n\n  const createAutoMaxChoicesByNumberOfAnswerOptions = (fieldId) => {\n    return new AutoSelectOptionsByTotalItemsComponent({\n      wrapperSelector: fieldSelector,\n      selectSelector: `${maxChoicesWrapperSelector} select`,\n      listSelector: `#${fieldId} ${answerOptionsWrapperSelector} .questionnaire-question-answer-option:not(.hidden)`\n    })\n  };\n\n  const createAutoButtonsByMinItemsForAnswerOptions = (fieldId) => {\n    return new AutoButtonsByMinItemsComponent({\n      wrapperSelector: fieldSelector,\n      listSelector: `#${fieldId} ${answerOptionsWrapperSelector} .questionnaire-question-answer-option:not(.hidden)`,\n      minItems: 2,\n      hideOnMinItemsOrLessSelector: answerOptionRemoveFieldButtonSelector\n    })\n  };\n\n  const createAutoSelectOptionsFromUrl = ($field) => {\n    return new AutoSelectOptionsFromUrl({\n      source: $field.find(displayConditionQuestionSelector),\n      select: $field.find(displayConditionAnswerOptionSelector),\n      sourceToParams: ($element) => { return { id: $element.val() } }\n    })\n  };\n\n  const createSortableList = () => {\n    createSortList(\".questionnaire-questions-list:not(.published)\", {\n      handle: \".question-divider\",\n      placeholder: '<div style=\"border-style: dashed; border-color: #000\"></div>',\n      forcePlaceholderSize: true,\n      onSortUpdate: () => {\n        autoLabelByPosition.run();\n        autoButtonsByPosition.run();\n      }\n    });\n  };\n\n  const createDynamicQuestionTitle = (fieldId) => {\n    const targetSelector = `#${fieldId} .question-title-statement`;\n    const locale = $(targetSelector).data(\"locale\");\n    const maxLength = $(targetSelector).data(\"max-length\");\n    const omission = $(targetSelector).data(\"omission\");\n    const placeholder = $(targetSelector).data(\"placeholder\");\n\n    return createLiveTextUpdateComponent({\n      inputSelector: `#${fieldId} input[name$=\\\\[body_${locale}\\\\]]`,\n      targetSelector: targetSelector,\n      maxLength: maxLength,\n      omission: omission,\n      placeholder: placeholder\n    });\n  }\n\n  const createCollapsibleQuestion = ($target) => {\n    const $collapsible = $target.find(\".collapsible\");\n    if ($collapsible.length > 0) {\n      const collapsibleId = $collapsible.attr(\"id\").replace(\"-question-card\", \"\");\n      const toggleAttr = `${collapsibleId}-question-card button--collapse-question-${collapsibleId} button--expand-question-${collapsibleId}`;\n      $target.find(\".question--collapse\").data(\"toggle\", toggleAttr);\n    }\n  };\n\n  const createDynamicFieldsForAnswerOptions = (fieldId) => {\n    const autoButtons = createAutoButtonsByMinItemsForAnswerOptions(fieldId);\n    const autoSelectOptions = createAutoMaxChoicesByNumberOfAnswerOptions(fieldId);\n\n    return createDynamicFields({\n      placeholderId: \"questionnaire-question-answer-option-id\",\n      wrapperSelector: `#${fieldId} ${answerOptionsWrapperSelector}`,\n      containerSelector: \".questionnaire-question-answer-options-list\",\n      fieldSelector: answerOptionFieldSelector,\n      addFieldButtonSelector: \".add-answer-option\",\n      fieldTemplateSelector: \".decidim-answer-option-template\",\n      removeFieldButtonSelector: answerOptionRemoveFieldButtonSelector,\n      onAddField: () => {\n        autoButtons.run();\n        autoSelectOptions.run();\n      },\n      onRemoveField: () => {\n        autoButtons.run();\n        autoSelectOptions.run();\n      }\n    });\n  };\n\n  const dynamicFieldsForAnswerOptions = {};\n\n  const createDynamicFieldsForMatrixRows = (fieldId) => {\n    return createDynamicFields({\n      placeholderId: \"questionnaire-question-matrix-row-id\",\n      wrapperSelector: `#${fieldId} ${matrixRowsWrapperSelector}`,\n      containerSelector: \".questionnaire-question-matrix-rows-list\",\n      fieldSelector: matrixRowFieldSelector,\n      addFieldButtonSelector: addMatrixRowButtonSelector,\n      fieldTemplateSelector: \".decidim-matrix-row-template\",\n      removeFieldButtonSelector: matrixRowRemoveFieldButtonSelector,\n      onAddField: () => {\n      },\n      onRemoveField: () => {\n      }\n    });\n  };\n\n  const dynamicFieldsForMatrixRows = {};\n\n  const isMultipleChoiceOption = (value) => {\n    return MULTIPLE_CHOICE_VALUES.indexOf(value) >= 0;\n  }\n\n  const isMatrix = (value) => {\n    return MATRIX_VALUES.indexOf(value) >= 0;\n  }\n\n  const getSelectedQuestionType = (select) => {\n    const selectedOption = select.options[select.selectedIndex];\n    return $(selectedOption).data(\"type\");\n  };\n\n  const onDisplayConditionQuestionChange = ($field) => {\n    const $questionSelector = $field.find(displayConditionQuestionSelector);\n    const selectedQuestionType = getSelectedQuestionType($questionSelector[0]);\n\n    const isMultiple = isMultipleChoiceOption(selectedQuestionType);\n\n    let conditionTypes = [\"answered\", \"not_answered\"];\n\n    if (isMultiple) {\n      conditionTypes.push(\"equal\");\n      conditionTypes.push(\"not_equal\");\n    }\n\n    conditionTypes.push(\"match\");\n\n    const $conditionTypeSelect = $field.find(displayConditionTypeSelector);\n\n    $conditionTypeSelect.find(\"option\").each((idx, option) => {\n      const $option = $(option);\n      const value = $option.val();\n\n      if (!value) {\n        return;\n      }\n\n      $option.show();\n\n      if (conditionTypes.indexOf(value) < 0) {\n        $option.hide();\n      }\n    });\n\n    if (conditionTypes.indexOf($conditionTypeSelect.val()) < 0) {\n      $conditionTypeSelect.val(conditionTypes[0]);\n    }\n\n    $conditionTypeSelect.trigger(\"change\");\n  };\n\n  const onDisplayConditionTypeChange = ($field) => {\n    const value = $field.find(displayConditionTypeSelector).val();\n    const $valueWrapper = $field.find(displayConditionValueWrapperSelector);\n    const $answerOptionWrapper = $field.find(displayconditionAnswerOptionWrapperSelector);\n\n    const $questionSelector = $field.find(displayConditionQuestionSelector);\n    const selectedQuestionType = getSelectedQuestionType($questionSelector[0]);\n\n    const isMultiple = isMultipleChoiceOption(selectedQuestionType);\n\n    if (value === \"match\") {\n      $valueWrapper.show();\n    }\n    else {\n      $valueWrapper.hide();\n    }\n\n    if (isMultiple && (value === \"not_equal\" || value === \"equal\")) {\n      $answerOptionWrapper.show();\n    }\n    else {\n      $answerOptionWrapper.hide();\n    }\n  };\n\n  const initializeDisplayConditionField = ($field) => {\n    const autoSelectByUrl = createAutoSelectOptionsFromUrl($field);\n    autoSelectByUrl.run();\n\n    $field.find(displayConditionQuestionSelector).on(\"change\", () => {\n      onDisplayConditionQuestionChange($field);\n    });\n\n    $field.find(displayConditionTypeSelector).on(\"change\", () => {\n      onDisplayConditionTypeChange($field);\n    });\n\n    onDisplayConditionTypeChange($field);\n    onDisplayConditionQuestionChange($field);\n  }\n\n  const createDynamicFieldsForDisplayConditions = (fieldId) => {\n    return createDynamicFields({\n      placeholderId: \"questionnaire-question-display-condition-id\",\n      wrapperSelector: `#${fieldId} ${displayConditionsWrapperSelector}`,\n      containerSelector: \".questionnaire-question-display-conditions-list\",\n      fieldSelector: displayConditionFieldSelector,\n      addFieldButtonSelector: addDisplayConditionButtonSelector,\n      removeFieldButtonSelector: displayConditionRemoveFieldButtonSelector,\n      onAddField: ($field) => {\n        initializeDisplayConditionField($field);\n      },\n      onRemoveField: () => {\n      }\n    });\n  };\n\n  const dynamicFieldsForDisplayConditions = {};\n\n  const setupInitialQuestionAttributes = ($target) => {\n    const fieldId = $target.attr(\"id\");\n    const $fieldQuestionTypeSelect = $target.find(questionTypeSelector);\n\n    createCollapsibleQuestion($target);\n    createDynamicQuestionTitle(fieldId);\n\n    createFieldDependentInputs({\n      controllerField: $fieldQuestionTypeSelect,\n      wrapperSelector: fieldSelector,\n      dependentFieldsSelector: answerOptionsWrapperSelector,\n      dependentInputSelector: `${answerOptionFieldSelector} input`,\n      enablingCondition: ($field) => {\n        return isMultipleChoiceOption($field.val());\n      }\n    });\n\n    createFieldDependentInputs({\n      controllerField: $fieldQuestionTypeSelect,\n      wrapperSelector: fieldSelector,\n      dependentFieldsSelector: maxChoicesWrapperSelector,\n      dependentInputSelector: \"select\",\n      enablingCondition: ($field) => {\n        return $field.val() === \"multiple_option\" || $field.val() === \"matrix_multiple\";\n      }\n    });\n\n    createFieldDependentInputs({\n      controllerField: $fieldQuestionTypeSelect,\n      wrapperSelector: fieldSelector,\n      dependentFieldsSelector: matrixRowsWrapperSelector,\n      dependentInputSelector: `${matrixRowFieldSelector} input`,\n      enablingCondition: ($field) => {\n        return isMatrix($field.val());\n      }\n    });\n\n    dynamicFieldsForAnswerOptions[fieldId] = createDynamicFieldsForAnswerOptions(fieldId);\n    dynamicFieldsForMatrixRows[fieldId] = createDynamicFieldsForMatrixRows(fieldId);\n    dynamicFieldsForDisplayConditions[fieldId] = createDynamicFieldsForDisplayConditions(fieldId);\n\n    const dynamicFieldsAnswerOptions = dynamicFieldsForAnswerOptions[fieldId];\n    const dynamicFieldsMatrixRows = dynamicFieldsForMatrixRows[fieldId];\n\n    const onQuestionTypeChange = () => {\n      if (isMultipleChoiceOption($fieldQuestionTypeSelect.val())) {\n        const nOptions = $fieldQuestionTypeSelect.parents(fieldSelector).find(answerOptionFieldSelector).length;\n\n        if (nOptions === 0) {\n          dynamicFieldsAnswerOptions._addField();\n          dynamicFieldsAnswerOptions._addField();\n        }\n      }\n\n      if (isMatrix($fieldQuestionTypeSelect.val())) {\n        const nRows = $fieldQuestionTypeSelect.parents(fieldSelector).find(matrixRowFieldSelector).length;\n\n        if (nRows === 0) {\n          dynamicFieldsMatrixRows._addField();\n          dynamicFieldsMatrixRows._addField();\n        }\n      }\n    };\n\n    $fieldQuestionTypeSelect.on(\"change\", onQuestionTypeChange);\n\n    onQuestionTypeChange();\n  }\n\n  const hideDeletedQuestion = ($target) => {\n    const inputDeleted = $target.find(\"input[name$=\\\\[deleted\\\\]]\").val();\n\n    if (inputDeleted === \"true\") {\n      $target.addClass(\"hidden\");\n      $target.hide();\n    }\n  }\n\n  createDynamicFields({\n    placeholderId: \"questionnaire-question-id\",\n    wrapperSelector: wrapperSelector,\n    containerSelector: \".questionnaire-questions-list\",\n    fieldSelector: fieldSelector,\n    addFieldButtonSelector: \".add-question\",\n    addSeparatorButtonSelector: \".add-separator\",\n    addTitleAndDescriptionButtonSelector: \".add-title-and-description\",\n    fieldTemplateSelector: \".decidim-question-template\",\n    separatorTemplateSelector: \".decidim-separator-template\",\n    TitleAndDescriptionTemplateSelector: \".decidim-title-and-description-template\",\n    removeFieldButtonSelector: \".remove-question\",\n    moveUpFieldButtonSelector: \".move-up-question\",\n    moveDownFieldButtonSelector: \".move-down-question\",\n    onAddField: ($field) => {\n      setupInitialQuestionAttributes($field);\n      createSortableList();\n\n      $field.find(\".editor-container\").each((idx, el) => {\n        createQuillEditor(el);\n      });\n\n      autoLabelByPosition.run();\n      autoButtonsByPosition.run();\n    },\n    onRemoveField: ($field) => {\n      autoLabelByPosition.run();\n      autoButtonsByPosition.run();\n\n      $field.find(answerOptionRemoveFieldButtonSelector).each((idx, el) => {\n        dynamicFieldsForAnswerOptions[$field.attr(\"id\")]._removeField(el);\n      });\n\n      $field.find(matrixRowRemoveFieldButtonSelector).each((idx, el) => {\n        dynamicFieldsForMatrixRows[$field.attr(\"id\")]._removeField(el);\n      });\n\n      $field.find(displayConditionRemoveFieldButtonSelector).each((idx, el) => {\n        dynamicFieldsForDisplayConditions[$field.attr(\"id\")]._removeField(el);\n      });\n    },\n    onMoveUpField: () => {\n      autoLabelByPosition.run();\n      autoButtonsByPosition.run();\n    },\n    onMoveDownField: () => {\n      autoLabelByPosition.run();\n      autoButtonsByPosition.run();\n    }\n  });\n\n  createSortableList();\n\n  $(fieldSelector).each((idx, el) => {\n    const $target = $(el);\n\n    hideDeletedQuestion($target);\n    setupInitialQuestionAttributes($target);\n  });\n\n  $(displayConditionFieldSelector).each((idx, el) => {\n    const $field = $(el);\n    initializeDisplayConditionField($field)\n  });\n\n  autoLabelByPosition.run();\n  autoButtonsByPosition.run();\n}\n"]},"metadata":{},"sourceType":"module"}