{"ast":null,"code":"/* eslint-disable */\n// üçÇclass TileLayer.HERE\n// Tile layer for HERE maps tiles.\nL.TileLayer.HERE = L.TileLayer.extend({\n  options: {\n    subdomains: '1234',\n    minZoom: 2,\n    maxZoom: 18,\n    // üçÇoption scheme: String = 'normal.day'\n    // The \"map scheme\", as documented in the HERE API.\n    scheme: 'normal.day',\n    // üçÇoption resource: String = 'maptile'\n    // The \"map resource\", as documented in the HERE API.\n    resource: 'maptile',\n    // üçÇoption mapId: String = 'newest'\n    // Version of the map tiles to be used, or a hash of an unique map\n    mapId: 'newest',\n    // üçÇoption format: String = 'png8'\n    // Image format to be used (`png8`, `png`, or `jpg`)\n    format: 'png8',\n    // üçÇoption appId: String = ''\n    // Required option. The `app_id` provided as part of the HERE credentials\n    appId: '',\n    // üçÇoption appCode: String = ''\n    // Required option. The `app_code` provided as part of the HERE credentials\n    appCode: '',\n    // üçÇoption useCIT: boolean = false\n    // Whether to use the CIT when loading the here-maptiles\n    useCIT: false,\n    // üçÇoption useHTTPS: boolean = true\n    // Whether to use HTTPS when loading the here-maptiles\n    useHTTPS: true,\n    // üçÇoption language: String = ''\n    // The language of the descriptions on the maps that are loaded\n    language: '',\n    // üçÇoption language: String = ''\n    // The second language of the descriptions on the maps that are loaded\n    language2: ''\n  },\n  initialize: function initialize(options) {\n    options = L.setOptions(this, options); // Decide if this scheme uses the aerial servers or the basemap servers\n\n    var schemeStart = options.scheme.split('.')[0];\n    options.tileResolution = 256; // {Base URL}{Path}/{resource (tile type)}/{map id}/{scheme}/{zoom}/{column}/{row}/{size}/{format}\n    // ?apiKey={YOUR_API_KEY}\n    // &{param}={value}\n\n    var params = ['apiKey=' + encodeURIComponent(options.apiKey)]; // Fallback to old app_id,app_code if no apiKey passed\n\n    if (!options.apiKey) {\n      params = ['app_id=' + encodeURIComponent(options.appId), 'app_code=' + encodeURIComponent(options.appCode)];\n    }\n\n    if (options.language) {\n      params.push('lg=' + encodeURIComponent(options.language));\n    }\n\n    if (options.language2) {\n      params.push('lg2=' + encodeURIComponent(options.language2));\n    }\n\n    var urlQuery = '?' + params.join('&');\n    var path = '/maptile/2.1/{resource}/{mapId}/{scheme}/{z}/{x}/{y}/{tileResolution}/{format}' + urlQuery;\n    var attributionPath = '/maptile/2.1/copyright/{mapId}?apiKey={apiKey}';\n    var baseUrl = 'maps.ls.hereapi.com'; // Old style with apiId/apiCode for compatibility\n\n    if (!options.apiKey) {\n      // make sure the CIT-url can be used\n      baseUrl = 'maps' + (options.useCIT ? '.cit' : '') + '.api.here.com';\n      attributionPath = '/maptile/2.1/copyright/{mapId}?app_id={appId}&app_code={appCode}';\n    }\n\n    var tileServer = 'base.' + baseUrl;\n\n    if (schemeStart == 'satellite' || schemeStart == 'terrain' || schemeStart == 'hybrid') {\n      tileServer = 'aerial.' + baseUrl;\n    }\n\n    if (options.scheme.indexOf('.traffic.') !== -1) {\n      tileServer = 'traffic' + baseUrl;\n    }\n\n    var protocol = 'http' + (options.useHTTPS ? 's' : '');\n    var tileUrl = protocol + '://{s}.' + tileServer + path;\n    this._attributionUrl = L.Util.template(protocol + '://1.' + tileServer + attributionPath, this.options);\n    L.TileLayer.prototype.initialize.call(this, tileUrl, options);\n    this._attributionText = '';\n  },\n  onAdd: function onAdd(map) {\n    L.TileLayer.prototype.onAdd.call(this, map);\n\n    if (!this._attributionBBoxes) {\n      this._fetchAttributionBBoxes();\n    }\n  },\n  onRemove: function onRemove(map) {\n    //\n    // Remove the attribution text, and clear the cached text so it will be recalculated\n    // if/when we are shown again.\n    //\n    this._map.attributionControl.removeAttribution(this._attributionText);\n\n    this._attributionText = '';\n\n    this._map.off('moveend zoomend resetview', this._findCopyrightBBox, this); //\n    // Call the prototype last, once we've tidied up our own changes\n    //\n\n\n    L.TileLayer.prototype.onRemove.call(this, map);\n  },\n  _fetchAttributionBBoxes: function _onMapMove() {\n    var xmlhttp = new XMLHttpRequest();\n    xmlhttp.onreadystatechange = L.bind(function () {\n      if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {\n        this._parseAttributionBBoxes(JSON.parse(xmlhttp.responseText));\n      }\n    }, this);\n    xmlhttp.open(\"GET\", this._attributionUrl, true);\n    xmlhttp.send();\n  },\n  _parseAttributionBBoxes: function _parseAttributionBBoxes(json) {\n    if (!this._map) {\n      return;\n    }\n\n    var providers = json[this.options.scheme.split('.')[0]] || json.normal;\n\n    for (var i = 0; i < providers.length; i++) {\n      if (providers[i].boxes) {\n        for (var j = 0; j < providers[i].boxes.length; j++) {\n          var box = providers[i].boxes[j];\n          providers[i].boxes[j] = L.latLngBounds([[box[0], box[1]], [box[2], box[3]]]);\n        }\n      }\n    }\n\n    this._map.on('moveend zoomend resetview', this._findCopyrightBBox, this);\n\n    this._attributionProviders = providers;\n\n    this._findCopyrightBBox();\n  },\n  _findCopyrightBBox: function _findCopyrightBBox() {\n    if (!this._map) {\n      return;\n    }\n\n    var providers = this._attributionProviders;\n    var visibleProviders = [];\n\n    var zoom = this._map.getZoom();\n\n    var visibleBounds = this._map.getBounds();\n\n    for (var i = 0; i < providers.length; i++) {\n      if (providers[i].minLevel <= zoom && providers[i].maxLevel >= zoom) {\n        if (!providers[i].boxes) {\n          // No boxes = attribution always visible\n          visibleProviders.push(providers[i]);\n        } else {\n          for (var j = 0; j < providers[i].boxes.length; j++) {\n            var box = providers[i].boxes[j];\n\n            if (visibleBounds.intersects(box)) {\n              visibleProviders.push(providers[i]);\n              break;\n            }\n          }\n        }\n      }\n    }\n\n    var attributions = ['<a href=\"https://legal.here.com/en-gb/terms\" target=\"_blank\" rel=\"noopener noreferrer\">HERE maps</a>'];\n\n    for (var i = 0; i < visibleProviders.length; i++) {\n      var provider = visibleProviders[i];\n      attributions.push('<abbr title=\"' + provider.alt + '\">' + provider.label + '</abbr>');\n    }\n\n    var attributionText = '¬© ' + attributions.join(', ') + '. ';\n\n    if (attributionText !== this._attributionText) {\n      this._map.attributionControl.removeAttribution(this._attributionText);\n\n      this._map.attributionControl.addAttribution(this._attributionText = attributionText);\n    }\n  }\n});\n\nL.tileLayer.here = function (opts) {\n  return new L.TileLayer.HERE(opts);\n};","map":{"version":3,"mappings":"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","names":["L","TileLayer","HERE","extend","options","subdomains","minZoom","maxZoom","scheme","resource","mapId","format","appId","appCode","useCIT","useHTTPS","language","language2","initialize","setOptions","schemeStart","split","tileResolution","params","encodeURIComponent","apiKey","push","urlQuery","join","path","attributionPath","baseUrl","tileServer","indexOf","protocol","tileUrl","_attributionUrl","Util","template","prototype","call","_attributionText","onAdd","map","_attributionBBoxes","_fetchAttributionBBoxes","onRemove","_map","attributionControl","removeAttribution","off","_findCopyrightBBox","_onMapMove","xmlhttp","XMLHttpRequest","onreadystatechange","bind","readyState","status","_parseAttributionBBoxes","JSON","parse","responseText","open","send","json","providers","normal","i","length","boxes","j","box","latLngBounds","on","_attributionProviders","visibleProviders","zoom","getZoom","visibleBounds","getBounds","minLevel","maxLevel","intersects","attributions","provider","alt","label","attributionText","addAttribution","tileLayer","here","opts"],"sources":["/var/lib/gems/2.7.0/gems/decidim-core-0.26.0/app/packs/src/decidim/vendor/leaflet-tilelayer-here.js"],"sourcesContent":["/* eslint-disable */\n\n// üçÇclass TileLayer.HERE\n// Tile layer for HERE maps tiles.\nL.TileLayer.HERE = L.TileLayer.extend({\n\n  options: {\n    subdomains: '1234',\n    minZoom: 2,\n    maxZoom: 18,\n\n    // üçÇoption scheme: String = 'normal.day'\n    // The \"map scheme\", as documented in the HERE API.\n    scheme: 'normal.day',\n\n    // üçÇoption resource: String = 'maptile'\n    // The \"map resource\", as documented in the HERE API.\n    resource: 'maptile',\n\n    // üçÇoption mapId: String = 'newest'\n    // Version of the map tiles to be used, or a hash of an unique map\n    mapId: 'newest',\n\n    // üçÇoption format: String = 'png8'\n    // Image format to be used (`png8`, `png`, or `jpg`)\n    format: 'png8',\n\n    // üçÇoption appId: String = ''\n    // Required option. The `app_id` provided as part of the HERE credentials\n    appId: '',\n\n    // üçÇoption appCode: String = ''\n    // Required option. The `app_code` provided as part of the HERE credentials\n    appCode: '',\n\n    // üçÇoption useCIT: boolean = false\n    // Whether to use the CIT when loading the here-maptiles\n    useCIT: false,\n\n    // üçÇoption useHTTPS: boolean = true\n    // Whether to use HTTPS when loading the here-maptiles\n    useHTTPS: true,\n\n    // üçÇoption language: String = ''\n    // The language of the descriptions on the maps that are loaded\n    language: '',\n\n    // üçÇoption language: String = ''\n    // The second language of the descriptions on the maps that are loaded\n    language2: '',\n  },\n\n\n  initialize: function initialize(options) {\n    options = L.setOptions(this, options);\n\n    // Decide if this scheme uses the aerial servers or the basemap servers\n    var schemeStart = options.scheme.split('.')[0];\n    options.tileResolution = 256;\n\n    // {Base URL}{Path}/{resource (tile type)}/{map id}/{scheme}/{zoom}/{column}/{row}/{size}/{format}\n    // ?apiKey={YOUR_API_KEY}\n    // &{param}={value}\n\n    var params = [\n      'apiKey=' + encodeURIComponent(options.apiKey)\n    ];\n    // Fallback to old app_id,app_code if no apiKey passed\n    if(!options.apiKey) {\n      params = [\n        'app_id=' + encodeURIComponent(options.appId),\n        'app_code=' + encodeURIComponent(options.appCode),\n      ];\n    }\n    if(options.language) {\n      params.push('lg=' + encodeURIComponent(options.language));\n    }\n    if(options.language2) {\n      params.push('lg2=' + encodeURIComponent(options.language2));\n    }\n    var urlQuery = '?' + params.join('&');\n\n    var path = '/maptile/2.1/{resource}/{mapId}/{scheme}/{z}/{x}/{y}/{tileResolution}/{format}' + urlQuery;\n    var attributionPath = '/maptile/2.1/copyright/{mapId}?apiKey={apiKey}';\n\n    var baseUrl = 'maps.ls.hereapi.com';\n\n    // Old style with apiId/apiCode for compatibility\n    if(!options.apiKey) {\n      // make sure the CIT-url can be used\n      baseUrl = 'maps' + (options.useCIT ? '.cit' : '') + '.api.here.com';\n      attributionPath = '/maptile/2.1/copyright/{mapId}?app_id={appId}&app_code={appCode}';\n    }\n\n    var tileServer = 'base.' + baseUrl;\n    if (schemeStart == 'satellite' || schemeStart == 'terrain' || schemeStart == 'hybrid') {\n      tileServer = 'aerial.' + baseUrl;\n    }\n    if (options.scheme.indexOf('.traffic.') !== -1) {\n      tileServer = 'traffic' + baseUrl;\n    }\n\n    var protocol = 'http' + (options.useHTTPS ? 's' : '');\n    var tileUrl = protocol + '://{s}.' + tileServer + path;\n\n    this._attributionUrl = L.Util.template(protocol + '://1.' + tileServer + attributionPath, this.options);\n\n    L.TileLayer.prototype.initialize.call(this, tileUrl, options);\n\n    this._attributionText = '';\n\n  },\n\n  onAdd: function onAdd(map) {\n    L.TileLayer.prototype.onAdd.call(this, map);\n\n    if (!this._attributionBBoxes) {\n      this._fetchAttributionBBoxes();\n    }\n  },\n\n  onRemove: function onRemove(map) {\n    //\n    // Remove the attribution text, and clear the cached text so it will be recalculated\n    // if/when we are shown again.\n    //\n    this._map.attributionControl.removeAttribution(this._attributionText);\n    this._attributionText = '';\n\n    this._map.off('moveend zoomend resetview', this._findCopyrightBBox, this);\n\n    //\n    // Call the prototype last, once we've tidied up our own changes\n    //\n    L.TileLayer.prototype.onRemove.call(this, map);\n  },\n\n  _fetchAttributionBBoxes: function _onMapMove() {\n    var xmlhttp = new XMLHttpRequest();\n    xmlhttp.onreadystatechange = L.bind(function(){\n      if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {\n        this._parseAttributionBBoxes(JSON.parse(xmlhttp.responseText));\n      }\n    }, this);\n    xmlhttp.open(\"GET\", this._attributionUrl, true);\n    xmlhttp.send();\n  },\n\n  _parseAttributionBBoxes: function _parseAttributionBBoxes(json) {\n    if (!this._map) { return; }\n    var providers = json[this.options.scheme.split('.')[0]] || json.normal;\n    for (var i=0; i<providers.length; i++) {\n      if (providers[i].boxes) {\n        for (var j=0; j<providers[i].boxes.length; j++) {\n          var box = providers[i].boxes[j];\n          providers[i].boxes[j] = L.latLngBounds( [ [box[0], box[1]], [box[2], box[3]] ]);\n        }\n      }\n    }\n\n    this._map.on('moveend zoomend resetview', this._findCopyrightBBox, this);\n\n    this._attributionProviders = providers;\n\n    this._findCopyrightBBox();\n  },\n\n  _findCopyrightBBox: function _findCopyrightBBox() {\n    if (!this._map) { return; }\n    var providers = this._attributionProviders;\n    var visibleProviders = [];\n    var zoom = this._map.getZoom();\n    var visibleBounds = this._map.getBounds();\n\n    for (var i=0; i<providers.length; i++) {\n      if (providers[i].minLevel <= zoom && providers[i].maxLevel >= zoom) {\n\n        if (!providers[i].boxes) {\n          // No boxes = attribution always visible\n          visibleProviders.push(providers[i]);\n        } else {\n          for (var j=0; j<providers[i].boxes.length; j++) {\n            var box = providers[i].boxes[j];\n            if (visibleBounds.intersects(box)) {\n              visibleProviders.push(providers[i]);\n              break;\n            }\n          }\n        }\n      }\n    }\n\n    var attributions = ['<a href=\"https://legal.here.com/en-gb/terms\" target=\"_blank\" rel=\"noopener noreferrer\">HERE maps</a>'];\n    for (var i=0; i<visibleProviders.length; i++) {\n      var provider = visibleProviders[i];\n      attributions.push('<abbr title=\"' + provider.alt + '\">' + provider.label + '</abbr>');\n    }\n\n    var attributionText = '¬© ' + attributions.join(', ') + '. ';\n\n    if (attributionText !== this._attributionText) {\n      this._map.attributionControl.removeAttribution(this._attributionText);\n      this._map.attributionControl.addAttribution(this._attributionText = attributionText);\n    }\n  },\n\n});\n\n\nL.tileLayer.here = function(opts){\n  return new L.TileLayer.HERE(opts);\n}\n"]},"metadata":{},"sourceType":"module"}