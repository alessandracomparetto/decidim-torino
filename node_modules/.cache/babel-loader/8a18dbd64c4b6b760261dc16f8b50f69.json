{"ast":null,"code":"/* eslint-disable no-invalid-this */\n\n/* eslint no-unused-vars: 0 */\n\n/* eslint id-length: [\"error\", { \"exceptions\": [\"e\"] }] */\n$(function () {\n  var selectedProposalsCount = function selectedProposalsCount() {\n    return $(\".table-list .js-check-all-proposal:checked\").length;\n  };\n\n  var selectedProposalsNotPublishedAnswerCount = function selectedProposalsNotPublishedAnswerCount() {\n    return $(\".table-list [data-published-state=false] .js-check-all-proposal:checked\").length;\n  };\n\n  var selectedProposalsCountUpdate = function selectedProposalsCountUpdate() {\n    var selectedProposals = selectedProposalsCount();\n    var selectedProposalsNotPublishedAnswer = selectedProposalsNotPublishedAnswerCount();\n\n    if (selectedProposals === 0) {\n      $(\"#js-selected-proposals-count\").text(\"\");\n    } else {\n      $(\"#js-selected-proposals-count\").text(selectedProposals);\n    }\n\n    if (selectedProposals >= 2) {\n      $('button[data-action=\"merge-proposals\"]').parent().show();\n    } else {\n      $('button[data-action=\"merge-proposals\"]').parent().hide();\n    }\n\n    if (selectedProposalsNotPublishedAnswer > 0) {\n      $('button[data-action=\"publish-answers\"]').parent().show();\n      $(\"#js-form-publish-answers-number\").text(selectedProposalsNotPublishedAnswer);\n    } else {\n      $('button[data-action=\"publish-answers\"]').parent().hide();\n    }\n  };\n\n  var showBulkActionsButton = function showBulkActionsButton() {\n    if (selectedProposalsCount() > 0) {\n      $(\"#js-bulk-actions-button\").removeClass(\"hide\");\n    }\n  };\n\n  var hideBulkActionsButton = function hideBulkActionsButton() {\n    var force = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n\n    if (selectedProposalsCount() === 0 || force === true) {\n      $(\"#js-bulk-actions-button\").addClass(\"hide\");\n      $(\"#js-bulk-actions-dropdown\").removeClass(\"is-open\");\n    }\n  };\n\n  var showOtherActionsButtons = function showOtherActionsButtons() {\n    $(\"#js-other-actions-wrapper\").removeClass(\"hide\");\n  };\n\n  var hideOtherActionsButtons = function hideOtherActionsButtons() {\n    $(\"#js-other-actions-wrapper\").addClass(\"hide\");\n  };\n\n  var hideBulkActionForms = function hideBulkActionForms() {\n    $(\".js-bulk-action-form\").addClass(\"hide\");\n  }; // Expose functions to make them avaialble in .js.erb templates\n\n\n  window.selectedProposalsCount = selectedProposalsCount;\n  window.selectedProposalsNotPublishedAnswerCount = selectedProposalsNotPublishedAnswerCount;\n  window.selectedProposalsCountUpdate = selectedProposalsCountUpdate;\n  window.showBulkActionsButton = showBulkActionsButton;\n  window.hideBulkActionsButton = hideBulkActionsButton;\n  window.showOtherActionsButtons = showOtherActionsButtons;\n  window.hideOtherActionsButtons = hideOtherActionsButtons;\n  window.hideBulkActionForms = hideBulkActionForms;\n\n  if ($(\".js-bulk-action-form\").length) {\n    hideBulkActionForms();\n    $(\"#js-bulk-actions-button\").addClass(\"hide\");\n    $(\"#js-bulk-actions-dropdown ul li button\").click(function (e) {\n      e.preventDefault();\n      var action = $(e.target).data(\"action\");\n\n      if (action) {\n        $(\"#js-form-\".concat(action)).submit(function () {\n          $(\".layout-content > .callout-wrapper\").html(\"\");\n        });\n        $(\"#js-\".concat(action, \"-actions\")).removeClass(\"hide\");\n        hideBulkActionsButton(true);\n        hideOtherActionsButtons();\n      }\n    }); // select all checkboxes\n\n    $(\".js-check-all\").change(function () {\n      $(\".js-check-all-proposal\").prop(\"checked\", $(this).prop(\"checked\"));\n\n      if ($(this).prop(\"checked\")) {\n        $(\".js-check-all-proposal\").closest(\"tr\").addClass(\"selected\");\n        showBulkActionsButton();\n      } else {\n        $(\".js-check-all-proposal\").closest(\"tr\").removeClass(\"selected\");\n        hideBulkActionsButton();\n      }\n\n      selectedProposalsCountUpdate();\n    }); // proposal checkbox change\n\n    $(\".table-list\").on(\"change\", \".js-check-all-proposal\", function (e) {\n      var proposalId = $(this).val();\n      var checked = $(this).prop(\"checked\"); // uncheck \"select all\", if one of the listed checkbox item is unchecked\n\n      if ($(this).prop(\"checked\") === false) {\n        $(\".js-check-all\").prop(\"checked\", false);\n      } // check \"select all\" if all checkbox proposals are checked\n\n\n      if ($(\".js-check-all-proposal:checked\").length === $(\".js-check-all-proposal\").length) {\n        $(\".js-check-all\").prop(\"checked\", true);\n        showBulkActionsButton();\n      }\n\n      if ($(this).prop(\"checked\")) {\n        showBulkActionsButton();\n        $(this).closest(\"tr\").addClass(\"selected\");\n      } else {\n        hideBulkActionsButton();\n        $(this).closest(\"tr\").removeClass(\"selected\");\n      }\n\n      if ($(\".js-check-all-proposal:checked\").length === 0) {\n        hideBulkActionsButton();\n      }\n\n      $(\".js-bulk-action-form\").find(\".js-proposal-id-\".concat(proposalId)).prop(\"checked\", checked);\n      selectedProposalsCountUpdate();\n    });\n    $(\".js-cancel-bulk-action\").on(\"click\", function (e) {\n      hideBulkActionForms();\n      showBulkActionsButton();\n      showOtherActionsButtons();\n    });\n  }\n});","map":{"version":3,"mappings":"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","names":["$","selectedProposalsCount","length","selectedProposalsNotPublishedAnswerCount","selectedProposalsCountUpdate","selectedProposals","selectedProposalsNotPublishedAnswer","text","parent","show","hide","showBulkActionsButton","removeClass","hideBulkActionsButton","force","addClass","showOtherActionsButtons","hideOtherActionsButtons","hideBulkActionForms","window","click","e","preventDefault","action","target","data","submit","html","change","prop","closest","on","proposalId","val","checked","find"],"sources":["/var/lib/gems/2.7.0/gems/decidim-proposals-0.26.0/app/packs/src/decidim/proposals/admin/proposals.js"],"sourcesContent":["/* eslint-disable no-invalid-this */\n/* eslint no-unused-vars: 0 */\n/* eslint id-length: [\"error\", { \"exceptions\": [\"e\"] }] */\n\n$(() => {\n  const selectedProposalsCount = function() {\n    return $(\".table-list .js-check-all-proposal:checked\").length\n  }\n\n  const selectedProposalsNotPublishedAnswerCount = function() {\n    return $(\".table-list [data-published-state=false] .js-check-all-proposal:checked\").length\n  }\n\n  const selectedProposalsCountUpdate = function() {\n    const selectedProposals = selectedProposalsCount();\n    const selectedProposalsNotPublishedAnswer = selectedProposalsNotPublishedAnswerCount();\n    if (selectedProposals === 0) {\n      $(\"#js-selected-proposals-count\").text(\"\")\n    } else {\n      $(\"#js-selected-proposals-count\").text(selectedProposals);\n    }\n\n    if (selectedProposals >= 2) {\n      $('button[data-action=\"merge-proposals\"]').parent().show();\n    } else {\n      $('button[data-action=\"merge-proposals\"]').parent().hide();\n    }\n\n    if (selectedProposalsNotPublishedAnswer > 0) {\n      $('button[data-action=\"publish-answers\"]').parent().show();\n      $(\"#js-form-publish-answers-number\").text(selectedProposalsNotPublishedAnswer);\n    } else {\n      $('button[data-action=\"publish-answers\"]').parent().hide();\n    }\n  }\n\n  const showBulkActionsButton = function() {\n    if (selectedProposalsCount() > 0) {\n      $(\"#js-bulk-actions-button\").removeClass(\"hide\");\n    }\n  }\n\n  const hideBulkActionsButton = function(force = false) {\n    if (selectedProposalsCount() === 0 || force === true) {\n      $(\"#js-bulk-actions-button\").addClass(\"hide\");\n      $(\"#js-bulk-actions-dropdown\").removeClass(\"is-open\");\n    }\n  }\n\n  const showOtherActionsButtons = function() {\n    $(\"#js-other-actions-wrapper\").removeClass(\"hide\");\n  }\n\n  const hideOtherActionsButtons = function() {\n    $(\"#js-other-actions-wrapper\").addClass(\"hide\");\n  }\n\n  const hideBulkActionForms = function() {\n    $(\".js-bulk-action-form\").addClass(\"hide\");\n  }\n\n  // Expose functions to make them avaialble in .js.erb templates\n  window.selectedProposalsCount = selectedProposalsCount;\n  window.selectedProposalsNotPublishedAnswerCount = selectedProposalsNotPublishedAnswerCount;\n  window.selectedProposalsCountUpdate = selectedProposalsCountUpdate;\n  window.showBulkActionsButton = showBulkActionsButton;\n  window.hideBulkActionsButton = hideBulkActionsButton;\n  window.showOtherActionsButtons = showOtherActionsButtons;\n  window.hideOtherActionsButtons = hideOtherActionsButtons;\n  window.hideBulkActionForms = hideBulkActionForms;\n\n  if ($(\".js-bulk-action-form\").length) {\n    hideBulkActionForms();\n    $(\"#js-bulk-actions-button\").addClass(\"hide\");\n\n    $(\"#js-bulk-actions-dropdown ul li button\").click(function(e) {\n      e.preventDefault();\n      let action = $(e.target).data(\"action\");\n\n      if (action) {\n        $(`#js-form-${action}`).submit(function() {\n          $(\".layout-content > .callout-wrapper\").html(\"\");\n        })\n\n        $(`#js-${action}-actions`).removeClass(\"hide\");\n        hideBulkActionsButton(true);\n        hideOtherActionsButtons();\n      }\n    })\n\n    // select all checkboxes\n    $(\".js-check-all\").change(function() {\n      $(\".js-check-all-proposal\").prop(\"checked\", $(this).prop(\"checked\"));\n\n      if ($(this).prop(\"checked\")) {\n        $(\".js-check-all-proposal\").closest(\"tr\").addClass(\"selected\");\n        showBulkActionsButton();\n      } else {\n        $(\".js-check-all-proposal\").closest(\"tr\").removeClass(\"selected\");\n        hideBulkActionsButton();\n      }\n\n      selectedProposalsCountUpdate();\n    });\n\n    // proposal checkbox change\n    $(\".table-list\").on(\"change\", \".js-check-all-proposal\", function (e) {\n      let proposalId = $(this).val()\n      let checked = $(this).prop(\"checked\")\n\n      // uncheck \"select all\", if one of the listed checkbox item is unchecked\n      if ($(this).prop(\"checked\") === false) {\n        $(\".js-check-all\").prop(\"checked\", false);\n      }\n      // check \"select all\" if all checkbox proposals are checked\n      if ($(\".js-check-all-proposal:checked\").length === $(\".js-check-all-proposal\").length) {\n        $(\".js-check-all\").prop(\"checked\", true);\n        showBulkActionsButton();\n      }\n\n      if ($(this).prop(\"checked\")) {\n        showBulkActionsButton();\n        $(this).closest(\"tr\").addClass(\"selected\");\n      } else {\n        hideBulkActionsButton();\n        $(this).closest(\"tr\").removeClass(\"selected\");\n      }\n\n      if ($(\".js-check-all-proposal:checked\").length === 0) {\n        hideBulkActionsButton();\n      }\n\n      $(\".js-bulk-action-form\").find(`.js-proposal-id-${proposalId}`).prop(\"checked\", checked);\n      selectedProposalsCountUpdate();\n    });\n\n    $(\".js-cancel-bulk-action\").on(\"click\", function (e) {\n      hideBulkActionForms()\n      showBulkActionsButton();\n      showOtherActionsButtons();\n    });\n  }\n});\n"]},"metadata":{},"sourceType":"module"}