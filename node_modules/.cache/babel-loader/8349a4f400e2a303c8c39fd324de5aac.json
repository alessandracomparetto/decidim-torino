{"ast":null,"code":"/* eslint-disable require-jsdoc */\nexport default function updateExternalDomainLinks($target) {\n  var whitelist = window.Decidim.config.get(\"external_domain_whitelist\");\n\n  if (window.location.pathname === \"/link\") {\n    return;\n  }\n\n  $(\"a\", $target).filter(function (_i, link) {\n    var $link = $(link);\n\n    if (!$link[0].hasAttribute(\"href\") || $link.parents(\".ql-editor\").length > 0) {\n      return false;\n    }\n\n    var parts = $link.attr(\"href\").match(/^(([a-z]+):)?\\/\\/([^/:]+)(:[0-9]*)?(\\/.*)?$/) || null;\n\n    if (!parts) {\n      return false;\n    }\n\n    var domain = parts[3].replace(/^www\\./, \"\");\n\n    if (whitelist.includes(domain)) {\n      return false;\n    }\n\n    return true;\n  }).each(function (_n, link) {\n    var $link = $(link);\n    var externalHref = \"/link?external_url=\".concat(encodeURIComponent($link.attr(\"href\")));\n    $link.attr(\"href\", externalHref);\n    $link.attr(\"data-remote\", true);\n  });\n}","map":{"version":3,"mappings":"AAAA;AAEA,eAAe,SAASA,yBAAT,CAAmCC,OAAnC,EAA4C;AACzD,MAAMC,SAAS,GAAGC,MAAM,CAACC,OAAPD,CAAeE,MAAfF,CAAsBG,GAAtBH,CAA0B,2BAA1BA,CAAlB;;AAEA,MAAIA,MAAM,CAACI,QAAPJ,CAAgBK,QAAhBL,KAA6B,OAAjC,EAA0C;AACxC;AACD;;AAEDM,GAAC,CAAC,GAAD,EAAMR,OAAN,CAADQ,CAAgBC,MAAhBD,CAAuB,UAACE,EAAD,EAAKC,IAAL,EAAc;AACnC,QAAMC,KAAK,GAAGJ,CAAC,CAACG,IAAD,CAAf;;AACA,QAAI,CAACC,KAAK,CAAC,CAAD,CAALA,CAASC,YAATD,CAAsB,MAAtBA,CAAD,IAAkCA,KAAK,CAACE,OAANF,CAAc,YAAdA,EAA4BG,MAA5BH,GAAqC,CAA3E,EAA8E;AAC5E,aAAO,KAAP;AACD;;AAED,QAAMI,KAAK,GAAGJ,KAAK,CAACK,IAANL,CAAW,MAAXA,EAAmBM,KAAnBN,CAAyB,6CAAzBA,KAA2E,IAAzF;;AACA,QAAI,CAACI,KAAL,EAAY;AACV,aAAO,KAAP;AACD;;AAED,QAAMG,MAAM,GAAGH,KAAK,CAAC,CAAD,CAALA,CAASI,OAATJ,CAAiB,QAAjBA,EAA2B,EAA3BA,CAAf;;AACA,QAAIf,SAAS,CAACoB,QAAVpB,CAAmBkB,MAAnBlB,CAAJ,EAAgC;AAC9B,aAAO,KAAP;AACD;;AAED,WAAO,IAAP;AAhBF,KAiBGqB,IAjBHd,CAiBQ,UAACe,EAAD,EAAKZ,IAAL,EAAc;AACpB,QAAMC,KAAK,GAAGJ,CAAC,CAACG,IAAD,CAAf;AACA,QAAMa,YAAY,gCAAyBC,kBAAkB,CAACb,KAAK,CAACK,IAANL,CAAW,MAAXA,CAAD,CAA3C,CAAlB;AACAA,SAAK,CAACK,IAANL,CAAW,MAAXA,EAAmBY,YAAnBZ;AACAA,SAAK,CAACK,IAANL,CAAW,aAAXA,EAA0B,IAA1BA;AArBF;AAuBD","names":["updateExternalDomainLinks","$target","whitelist","window","Decidim","config","get","location","pathname","$","filter","_i","link","$link","hasAttribute","parents","length","parts","attr","match","domain","replace","includes","each","_n","externalHref","encodeURIComponent"],"sources":["/var/lib/gems/2.7.0/gems/decidim-core-0.26.0/app/packs/src/decidim/external_domain_warning.js"],"sourcesContent":["/* eslint-disable require-jsdoc */\n\nexport default function updateExternalDomainLinks($target) {\n  const whitelist = window.Decidim.config.get(\"external_domain_whitelist\")\n\n  if (window.location.pathname === \"/link\") {\n    return;\n  }\n\n  $(\"a\", $target).filter((_i, link) => {\n    const $link = $(link);\n    if (!$link[0].hasAttribute(\"href\") || $link.parents(\".ql-editor\").length > 0) {\n      return false;\n    }\n\n    const parts = $link.attr(\"href\").match(/^(([a-z]+):)?\\/\\/([^/:]+)(:[0-9]*)?(\\/.*)?$/) || null;\n    if (!parts) {\n      return false;\n    }\n\n    const domain = parts[3].replace(/^www\\./, \"\")\n    if (whitelist.includes(domain)) {\n      return false;\n    }\n\n    return true;\n  }).each((_n, link) => {\n    const $link = $(link);\n    const externalHref = `/link?external_url=${encodeURIComponent($link.attr(\"href\"))}`;\n    $link.attr(\"href\", externalHref)\n    $link.attr(\"data-remote\", true)\n  });\n}\n"]},"metadata":{},"sourceType":"module"}