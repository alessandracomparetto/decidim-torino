{"ast":null,"code":"function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, _typeof(obj);\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  Object.defineProperty(subClass, \"prototype\", {\n    writable: false\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  } else if (call !== void 0) {\n    throw new TypeError(\"Derived constructors may only return object or undefined\");\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nimport * as L from \"leaflet\";\nimport MapController from \"src/decidim/map/controller\";\nimport \"src/decidim/vendor/leaflet-tilelayer-here\";\n\nvar MapDragMarkerController = /*#__PURE__*/function (_MapController) {\n  _inherits(MapDragMarkerController, _MapController);\n\n  var _super = _createSuper(MapDragMarkerController);\n\n  function MapDragMarkerController() {\n    _classCallCheck(this, MapDragMarkerController);\n\n    return _super.apply(this, arguments);\n  }\n\n  _createClass(MapDragMarkerController, [{\n    key: \"start\",\n    value: function start() {\n      if (this.config.marker) {\n        this.addMarker(this.config.marker);\n      } else {\n        this.map.fitWorld();\n      }\n    }\n  }, {\n    key: \"addMarker\",\n    value: function addMarker(markerData) {\n      var _this = this;\n\n      if (markerData.latitude === null || markerData.longitude === null) {\n        return;\n      }\n\n      var coordinates = {\n        lat: markerData.latitude,\n        lng: markerData.longitude\n      };\n      this.triggerEvent(\"coordinates\", [coordinates]);\n      this.marker = L.marker(coordinates, {\n        icon: this.createIcon(),\n        keyboard: true,\n        title: markerData.title,\n        draggable: true\n      });\n      this.marker.on(\"drag\", function (ev) {\n        _this.triggerEvent(\"coordinates\", [ev.target.getLatLng()]);\n      });\n      this.marker.addTo(this.map);\n      var zoom = parseInt(this.config.zoom, 10) || 14;\n      this.map.setView(coordinates, zoom);\n    }\n  }, {\n    key: \"getMarker\",\n    value: function getMarker() {\n      return this.marker;\n    }\n  }, {\n    key: \"removeMarker\",\n    value: function removeMarker() {\n      if (this.marker) {\n        this.marker.remove();\n        this.marker = null;\n      }\n    }\n  }]);\n\n  return MapDragMarkerController;\n}(MapController);\n\nexport { MapDragMarkerController as default };","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,OAAO,KAAKA,CAAZ,MAAmB,SAAnB;AACA,OAAOC,aAAP,MAA0B,4BAA1B;AACA,OAAO,2CAAP;;IAEqBC,uB;;;;;;;;;;;;;WACnB,iBAAQ;AACN,UAAI,KAAKC,MAAL,CAAYC,MAAhB,EAAwB;AACtB,aAAKC,SAAL,CAAe,KAAKF,MAAL,CAAYC,MAA3B;AADF,aAEO;AACL,aAAKE,GAAL,CAASC,QAAT;AACD;AACF;;;WAED,mBAAUC,UAAV,EAAsB;AAAA;;AACpB,UAAIA,UAAU,CAACC,QAAXD,KAAwB,IAAxBA,IAAgCA,UAAU,CAACE,SAAXF,KAAyB,IAA7D,EAAmE;AACjE;AACD;;AAED,UAAMG,WAAW,GAAG;AAClBC,WAAG,EAAEJ,UAAU,CAACC,QADE;AAElBI,WAAG,EAAEL,UAAU,CAACE;AAFE,OAApB;AAIA,WAAKI,YAAL,CAAkB,aAAlB,EAAiC,CAACH,WAAD,CAAjC;AAEA,WAAKP,MAAL,GAAcJ,CAAC,CAACI,MAAFJ,CAASW,WAATX,EAAsB;AAClCe,YAAI,EAAE,KAAKC,UAAL,EAD4B;AAElCC,gBAAQ,EAAE,IAFwB;AAGlCC,aAAK,EAAEV,UAAU,CAACU,KAHgB;AAIlCC,iBAAS,EAAE;AAJuB,OAAtBnB,CAAd;AAMA,WAAKI,MAAL,CAAYgB,EAAZ,CAAe,MAAf,EAAuB,UAACC,EAAD,EAAQ;AAC7BC,aAAI,CAACR,YAAL,CAAkB,aAAlB,EAAiC,CAACO,EAAE,CAACE,MAAHF,CAAUG,SAAVH,EAAD,CAAjC;AADF;AAGA,WAAKjB,MAAL,CAAYqB,KAAZ,CAAkB,KAAKnB,GAAvB;AAEA,UAAMoB,IAAI,GAAGC,QAAQ,CAAC,KAAKxB,MAAL,CAAYuB,IAAb,EAAmB,EAAnB,CAARC,IAAkC,EAA/C;AACA,WAAKrB,GAAL,CAASsB,OAAT,CAAiBjB,WAAjB,EAA8Be,IAA9B;AACD;;;WAED,qBAAY;AACV,aAAO,KAAKtB,MAAZ;AACD;;;WAED,wBAAe;AACb,UAAI,KAAKA,MAAT,EAAiB;AACf,aAAKA,MAAL,CAAYyB,MAAZ;AACA,aAAKzB,MAAL,GAAc,IAAd;AACD;AACF;;;;EA5CkDH,a;;SAAhCC,uB","names":["L","MapController","MapDragMarkerController","config","marker","addMarker","map","fitWorld","markerData","latitude","longitude","coordinates","lat","lng","triggerEvent","icon","createIcon","keyboard","title","draggable","on","ev","_this","target","getLatLng","addTo","zoom","parseInt","setView","remove"],"sources":["/var/lib/gems/2.7.0/gems/decidim-core-0.26.0/app/packs/src/decidim/map/controller/drag_marker.js"],"sourcesContent":["import * as L from \"leaflet\";\nimport MapController from \"src/decidim/map/controller\"\nimport \"src/decidim/vendor/leaflet-tilelayer-here\"\n\nexport default class MapDragMarkerController extends MapController {\n  start() {\n    if (this.config.marker) {\n      this.addMarker(this.config.marker);\n    } else {\n      this.map.fitWorld();\n    }\n  }\n\n  addMarker(markerData) {\n    if (markerData.latitude === null || markerData.longitude === null) {\n      return;\n    }\n\n    const coordinates = {\n      lat: markerData.latitude,\n      lng: markerData.longitude\n    };\n    this.triggerEvent(\"coordinates\", [coordinates]);\n\n    this.marker = L.marker(coordinates, {\n      icon: this.createIcon(),\n      keyboard: true,\n      title: markerData.title,\n      draggable: true\n    });\n    this.marker.on(\"drag\", (ev) => {\n      this.triggerEvent(\"coordinates\", [ev.target.getLatLng()]);\n    });\n    this.marker.addTo(this.map);\n\n    const zoom = parseInt(this.config.zoom, 10) || 14;\n    this.map.setView(coordinates, zoom);\n  }\n\n  getMarker() {\n    return this.marker;\n  }\n\n  removeMarker() {\n    if (this.marker) {\n      this.marker.remove();\n      this.marker = null;\n    }\n  }\n}\n"]},"metadata":{},"sourceType":"module"}