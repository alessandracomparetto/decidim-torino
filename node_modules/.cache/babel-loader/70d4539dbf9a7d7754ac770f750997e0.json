{"ast":null,"code":"function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, _typeof(obj);\n}\n/* eslint-disable */\n\n/*\n  Modified file from the original tribute.js\n  Adding inside click event the conditional if the li element has no disabled-tribute-element class name. if true, then it must continue with normal behaviour.\n*/\n\n\n(function (f) {\n  if ((typeof exports === \"undefined\" ? \"undefined\" : _typeof(exports)) === \"object\" && typeof module !== \"undefined\") {\n    module.exports = f();\n  } else if (typeof define === \"function\" && define.amd) {\n    define([], f);\n  } else {\n    var g;\n\n    if (typeof window !== \"undefined\") {\n      g = window;\n    } else if (typeof global !== \"undefined\") {\n      g = global;\n    } else if (typeof self !== \"undefined\") {\n      g = self;\n    } else {\n      g = this;\n    }\n\n    g.Tribute = f();\n  }\n})(function () {\n  var define, module, exports;\n  return function () {\n    function r(e, n, t) {\n      function o(i, f) {\n        if (!n[i]) {\n          if (!e[i]) {\n            var c = \"function\" == typeof require && require;\n            if (!f && c) return c(i, !0);\n            if (u) return u(i, !0);\n            var a = new Error(\"Cannot find module '\" + i + \"'\");\n            throw a.code = \"MODULE_NOT_FOUND\", a;\n          }\n\n          var p = n[i] = {\n            exports: {}\n          };\n          e[i][0].call(p.exports, function (r) {\n            var n = e[i][1][r];\n            return o(n || r);\n          }, p, p.exports, r, e, n, t);\n        }\n\n        return n[i].exports;\n      }\n\n      for (var u = \"function\" == typeof require && require, i = 0; i < t.length; i++) {\n        o(t[i]);\n      }\n\n      return o;\n    }\n\n    return r;\n  }()({\n    1: [function (require, module, exports) {\n      \"use strict\";\n\n      Object.defineProperty(exports, \"__esModule\", {\n        value: true\n      });\n      exports[\"default\"] = void 0;\n\n      require(\"./utils\");\n\n      var _TributeEvents = _interopRequireDefault(require(\"./TributeEvents\"));\n\n      var _TributeMenuEvents = _interopRequireDefault(require(\"./TributeMenuEvents\"));\n\n      var _TributeRange = _interopRequireDefault(require(\"./TributeRange\"));\n\n      var _TributeSearch = _interopRequireDefault(require(\"./TributeSearch\"));\n\n      function _interopRequireDefault(obj) {\n        return obj && obj.__esModule ? obj : {\n          \"default\": obj\n        };\n      }\n\n      function _slicedToArray(arr, i) {\n        return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest();\n      }\n\n      function _nonIterableRest() {\n        throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n      }\n\n      function _iterableToArrayLimit(arr, i) {\n        var _arr = [];\n        var _n = true;\n        var _d = false;\n        var _e = undefined;\n\n        try {\n          for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n            _arr.push(_s.value);\n\n            if (i && _arr.length === i) break;\n          }\n        } catch (err) {\n          _d = true;\n          _e = err;\n        } finally {\n          try {\n            if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n          } finally {\n            if (_d) throw _e;\n          }\n        }\n\n        return _arr;\n      }\n\n      function _arrayWithHoles(arr) {\n        if (Array.isArray(arr)) return arr;\n      }\n\n      function _classCallCheck(instance, Constructor) {\n        if (!(instance instanceof Constructor)) {\n          throw new TypeError(\"Cannot call a class as a function\");\n        }\n      }\n\n      function _defineProperties(target, props) {\n        for (var i = 0; i < props.length; i++) {\n          var descriptor = props[i];\n          descriptor.enumerable = descriptor.enumerable || false;\n          descriptor.configurable = true;\n          if (\"value\" in descriptor) descriptor.writable = true;\n          Object.defineProperty(target, descriptor.key, descriptor);\n        }\n      }\n\n      function _createClass(Constructor, protoProps, staticProps) {\n        if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n        if (staticProps) _defineProperties(Constructor, staticProps);\n        return Constructor;\n      }\n\n      var Tribute = /*#__PURE__*/function () {\n        function Tribute(_ref) {\n          var _this = this;\n\n          var _ref$values = _ref.values,\n              values = _ref$values === void 0 ? null : _ref$values,\n              _ref$iframe = _ref.iframe,\n              iframe = _ref$iframe === void 0 ? null : _ref$iframe,\n              _ref$selectClass = _ref.selectClass,\n              selectClass = _ref$selectClass === void 0 ? 'highlight' : _ref$selectClass,\n              _ref$trigger = _ref.trigger,\n              trigger = _ref$trigger === void 0 ? '@' : _ref$trigger,\n              _ref$autocompleteMode = _ref.autocompleteMode,\n              autocompleteMode = _ref$autocompleteMode === void 0 ? false : _ref$autocompleteMode,\n              _ref$selectTemplate = _ref.selectTemplate,\n              selectTemplate = _ref$selectTemplate === void 0 ? null : _ref$selectTemplate,\n              _ref$menuItemTemplate = _ref.menuItemTemplate,\n              menuItemTemplate = _ref$menuItemTemplate === void 0 ? null : _ref$menuItemTemplate,\n              _ref$lookup = _ref.lookup,\n              lookup = _ref$lookup === void 0 ? 'key' : _ref$lookup,\n              _ref$fillAttr = _ref.fillAttr,\n              fillAttr = _ref$fillAttr === void 0 ? 'value' : _ref$fillAttr,\n              _ref$collection = _ref.collection,\n              collection = _ref$collection === void 0 ? null : _ref$collection,\n              _ref$menuContainer = _ref.menuContainer,\n              menuContainer = _ref$menuContainer === void 0 ? null : _ref$menuContainer,\n              _ref$noMatchTemplate = _ref.noMatchTemplate,\n              noMatchTemplate = _ref$noMatchTemplate === void 0 ? null : _ref$noMatchTemplate,\n              _ref$requireLeadingSp = _ref.requireLeadingSpace,\n              requireLeadingSpace = _ref$requireLeadingSp === void 0 ? true : _ref$requireLeadingSp,\n              _ref$allowSpaces = _ref.allowSpaces,\n              allowSpaces = _ref$allowSpaces === void 0 ? false : _ref$allowSpaces,\n              _ref$replaceTextSuffi = _ref.replaceTextSuffix,\n              replaceTextSuffix = _ref$replaceTextSuffi === void 0 ? null : _ref$replaceTextSuffi,\n              _ref$positionMenu = _ref.positionMenu,\n              positionMenu = _ref$positionMenu === void 0 ? true : _ref$positionMenu,\n              _ref$spaceSelectsMatc = _ref.spaceSelectsMatch,\n              spaceSelectsMatch = _ref$spaceSelectsMatc === void 0 ? false : _ref$spaceSelectsMatc,\n              _ref$searchOpts = _ref.searchOpts,\n              searchOpts = _ref$searchOpts === void 0 ? {} : _ref$searchOpts,\n              _ref$menuItemLimit = _ref.menuItemLimit,\n              menuItemLimit = _ref$menuItemLimit === void 0 ? null : _ref$menuItemLimit;\n\n          _classCallCheck(this, Tribute);\n\n          this.autocompleteMode = autocompleteMode;\n          this.menuSelected = 0;\n          this.current = {};\n          this.inputEvent = false;\n          this.isActive = false;\n          this.menuContainer = menuContainer;\n          this.allowSpaces = allowSpaces;\n          this.replaceTextSuffix = replaceTextSuffix;\n          this.positionMenu = positionMenu;\n          this.hasTrailingSpace = false;\n          this.spaceSelectsMatch = spaceSelectsMatch;\n\n          if (this.autocompleteMode) {\n            trigger = '';\n            allowSpaces = false;\n          }\n\n          if (values) {\n            this.collection = [{\n              // symbol that starts the lookup\n              trigger: trigger,\n              // is it wrapped in an iframe\n              iframe: iframe,\n              // class applied to selected item\n              selectClass: selectClass,\n              // function called on select that retuns the content to insert\n              selectTemplate: (selectTemplate || Tribute.defaultSelectTemplate).bind(this),\n              // function called that returns content for an item\n              menuItemTemplate: (menuItemTemplate || Tribute.defaultMenuItemTemplate).bind(this),\n              // function called when menu is empty, disables hiding of menu.\n              noMatchTemplate: function (t) {\n                if (typeof t === 'function') {\n                  return t.bind(_this);\n                }\n\n                return noMatchTemplate || function () {\n                  return '';\n                }.bind(_this);\n              }(noMatchTemplate),\n              // column to search against in the object\n              lookup: lookup,\n              // column that contains the content to insert by default\n              fillAttr: fillAttr,\n              // array of objects or a function returning an array of objects\n              values: values,\n              requireLeadingSpace: requireLeadingSpace,\n              searchOpts: searchOpts,\n              menuItemLimit: menuItemLimit\n            }];\n          } else if (collection) {\n            if (this.autocompleteMode) console.warn('Tribute in autocomplete mode does not work for collections');\n            this.collection = collection.map(function (item) {\n              return {\n                trigger: item.trigger || trigger,\n                iframe: item.iframe || iframe,\n                selectClass: item.selectClass || selectClass,\n                selectTemplate: (item.selectTemplate || Tribute.defaultSelectTemplate).bind(_this),\n                menuItemTemplate: (item.menuItemTemplate || Tribute.defaultMenuItemTemplate).bind(_this),\n                // function called when menu is empty, disables hiding of menu.\n                noMatchTemplate: function (t) {\n                  if (typeof t === 'function') {\n                    return t.bind(_this);\n                  }\n\n                  return null;\n                }(noMatchTemplate),\n                lookup: item.lookup || lookup,\n                fillAttr: item.fillAttr || fillAttr,\n                values: item.values,\n                requireLeadingSpace: item.requireLeadingSpace,\n                searchOpts: item.searchOpts || searchOpts,\n                menuItemLimit: item.menuItemLimit || menuItemLimit\n              };\n            });\n          } else {\n            throw new Error('[Tribute] No collection specified.');\n          }\n\n          new _TributeRange[\"default\"](this);\n          new _TributeEvents[\"default\"](this);\n          new _TributeMenuEvents[\"default\"](this);\n          new _TributeSearch[\"default\"](this);\n        }\n\n        _createClass(Tribute, [{\n          key: \"triggers\",\n          value: function triggers() {\n            return this.collection.map(function (config) {\n              return config.trigger;\n            });\n          }\n        }, {\n          key: \"attach\",\n          value: function attach(el) {\n            if (!el) {\n              throw new Error('[Tribute] Must pass in a DOM node or NodeList.');\n            } // Check if it is a jQuery collection\n\n\n            if (typeof jQuery !== 'undefined' && el instanceof jQuery) {\n              el = el.get();\n            } // Is el an Array/Array-like object?\n\n\n            if (el.constructor === NodeList || el.constructor === HTMLCollection || el.constructor === Array) {\n              var length = el.length;\n\n              for (var i = 0; i < length; ++i) {\n                this._attach(el[i]);\n              }\n            } else {\n              this._attach(el);\n            }\n          }\n        }, {\n          key: \"_attach\",\n          value: function _attach(el) {\n            if (el.hasAttribute('data-tribute')) {\n              console.warn('Tribute was already bound to ' + el.nodeName);\n            }\n\n            this.ensureEditable(el);\n            this.events.bind(el);\n            el.setAttribute('data-tribute', true);\n          }\n        }, {\n          key: \"ensureEditable\",\n          value: function ensureEditable(element) {\n            if (Tribute.inputTypes().indexOf(element.nodeName) === -1) {\n              if (element.contentEditable) {\n                element.contentEditable = true;\n              } else {\n                throw new Error('[Tribute] Cannot bind to ' + element.nodeName);\n              }\n            }\n          }\n        }, {\n          key: \"createMenu\",\n          value: function createMenu() {\n            var wrapper = this.range.getDocument().createElement('div'),\n                ul = this.range.getDocument().createElement('ul');\n            wrapper.className = 'tribute-container';\n            wrapper.setAttribute('aria-expanded', 'true');\n            ul.setAttribute('id', 'results');\n            wrapper.appendChild(ul);\n\n            if (this.menuContainer) {\n              return this.menuContainer.appendChild(wrapper);\n            }\n\n            return this.range.getDocument().body.appendChild(wrapper);\n          }\n        }, {\n          key: \"showMenuFor\",\n          value: function showMenuFor(element, scrollTo) {\n            var _this2 = this; // Only proceed if menu isn't already shown for the current element & mentionText\n\n\n            if (this.isActive && this.current.element === element && this.current.mentionText === this.currentMentionTextSnapshot) {\n              return;\n            }\n\n            this.currentMentionTextSnapshot = this.current.mentionText; // create the menu if it doesn't exist.\n\n            if (!this.menu) {\n              this.menu = this.createMenu();\n              element.tributeMenu = this.menu;\n              this.menuEvents.bind(this.menu);\n            }\n\n            this.isActive = true;\n            this.menuSelected = 0;\n\n            if (!this.current.mentionText) {\n              this.current.mentionText = '';\n            }\n\n            var processValues = function processValues(values) {\n              // Tribute may not be active any more by the time the value callback returns\n              if (!_this2.isActive) {\n                return;\n              }\n\n              var items = _this2.search.filter(_this2.current.mentionText, values, {\n                pre: _this2.current.collection.searchOpts.pre || '<span>',\n                post: _this2.current.collection.searchOpts.post || '</span>',\n                skip: _this2.current.collection.searchOpts.skip,\n                extract: function extract(el) {\n                  if (typeof _this2.current.collection.lookup === 'string') {\n                    return el[_this2.current.collection.lookup];\n                  } else if (typeof _this2.current.collection.lookup === 'function') {\n                    return _this2.current.collection.lookup(el, _this2.current.mentionText);\n                  } else {\n                    throw new Error('Invalid lookup attribute, lookup must be string or function.');\n                  }\n                }\n              });\n\n              if (_this2.current.collection.menuItemLimit) {\n                items = items.slice(0, _this2.current.collection.menuItemLimit);\n              }\n\n              _this2.current.filteredItems = items;\n\n              var ul = _this2.menu.querySelector('ul');\n\n              _this2.range.positionMenuAtCaret(scrollTo);\n\n              if (!items.length) {\n                var noMatchEvent = new CustomEvent('tribute-no-match', {\n                  detail: _this2.menu\n                });\n\n                _this2.current.element.dispatchEvent(noMatchEvent);\n\n                if (typeof _this2.current.collection.noMatchTemplate === 'function' && !_this2.current.collection.noMatchTemplate() || !_this2.current.collection.noMatchTemplate) {\n                  _this2.hideMenu();\n                } else {\n                  typeof _this2.current.collection.noMatchTemplate === 'function' ? ul.innerHTML = _this2.current.collection.noMatchTemplate() : ul.innerHTML = _this2.current.collection.noMatchTemplate;\n                }\n\n                return;\n              }\n\n              ul.innerHTML = '';\n\n              var fragment = _this2.range.getDocument().createDocumentFragment();\n\n              items.forEach(function (item, index) {\n                var li = _this2.range.getDocument().createElement('li');\n\n                li.setAttribute('role', 'option');\n                li.setAttribute('data-index', index);\n                li.addEventListener('mousemove', function (e) {\n                  var _this2$_findLiTarget = _this2._findLiTarget(e.target),\n                      _this2$_findLiTarget2 = _slicedToArray(_this2$_findLiTarget, 2),\n                      li = _this2$_findLiTarget2[0],\n                      index = _this2$_findLiTarget2[1];\n\n                  if (e.movementY !== 0) {\n                    _this2.events.setActiveLi(index);\n                  }\n                });\n\n                if (_this2.menuSelected === index) {\n                  li.className = _this2.current.collection.selectClass;\n                }\n\n                li.innerHTML = _this2.current.collection.menuItemTemplate(item);\n                fragment.appendChild(li);\n              });\n              ul.appendChild(fragment);\n            };\n\n            if (typeof this.current.collection.values === 'function') {\n              this.current.collection.values(this.current.mentionText, processValues);\n            } else {\n              processValues(this.current.collection.values);\n            }\n          }\n        }, {\n          key: \"_findLiTarget\",\n          value: function _findLiTarget(el) {\n            if (!el) return [];\n            var index = el.getAttribute('data-index');\n            return !index ? this._findLiTarget(el.parentNode) : [el, index];\n          }\n        }, {\n          key: \"showMenuForCollection\",\n          value: function showMenuForCollection(element, collectionIndex) {\n            if (element !== document.activeElement) {\n              this.placeCaretAtEnd(element);\n            }\n\n            this.current.collection = this.collection[collectionIndex || 0];\n            this.current.externalTrigger = true;\n            this.current.element = element;\n            if (element.isContentEditable) this.insertTextAtCursor(this.current.collection.trigger);else this.insertAtCaret(element, this.current.collection.trigger);\n            this.showMenuFor(element);\n          } // TODO: make sure this works for inputs/textareas\n\n        }, {\n          key: \"placeCaretAtEnd\",\n          value: function placeCaretAtEnd(el) {\n            el.focus();\n\n            if (typeof window.getSelection != \"undefined\" && typeof document.createRange != \"undefined\") {\n              var range = document.createRange();\n              range.selectNodeContents(el);\n              range.collapse(false);\n              var sel = window.getSelection();\n              sel.removeAllRanges();\n              sel.addRange(range);\n            } else if (typeof document.body.createTextRange != \"undefined\") {\n              var textRange = document.body.createTextRange();\n              textRange.moveToElementText(el);\n              textRange.collapse(false);\n              textRange.select();\n            }\n          } // for contenteditable\n\n        }, {\n          key: \"insertTextAtCursor\",\n          value: function insertTextAtCursor(text) {\n            var sel, range, html;\n            sel = window.getSelection();\n            range = sel.getRangeAt(0);\n            range.deleteContents();\n            var textNode = document.createTextNode(text);\n            range.insertNode(textNode);\n            range.selectNodeContents(textNode);\n            range.collapse(false);\n            sel.removeAllRanges();\n            sel.addRange(range);\n          } // for regular inputs\n\n        }, {\n          key: \"insertAtCaret\",\n          value: function insertAtCaret(textarea, text) {\n            var scrollPos = textarea.scrollTop;\n            var caretPos = textarea.selectionStart;\n            var front = textarea.value.substring(0, caretPos);\n            var back = textarea.value.substring(textarea.selectionEnd, textarea.value.length);\n            textarea.value = front + text + back;\n            caretPos = caretPos + text.length;\n            textarea.selectionStart = caretPos;\n            textarea.selectionEnd = caretPos;\n            textarea.focus();\n            textarea.scrollTop = scrollPos;\n          }\n        }, {\n          key: \"hideMenu\",\n          value: function hideMenu() {\n            if (this.menu) {\n              this.menu.style.cssText = 'display: none;';\n              this.isActive = false;\n              this.menuSelected = 0;\n              this.current = {};\n            }\n          }\n        }, {\n          key: \"selectItemAtIndex\",\n          value: function selectItemAtIndex(index, originalEvent) {\n            index = parseInt(index);\n            if (typeof index !== 'number' || isNaN(index)) return;\n            var item = this.current.filteredItems[index];\n            var content = this.current.collection.selectTemplate(item);\n            if (content !== null) this.replaceText(content, originalEvent, item);\n          }\n        }, {\n          key: \"replaceText\",\n          value: function replaceText(content, originalEvent, item) {\n            this.range.replaceTriggerText(content, true, true, originalEvent, item);\n          }\n        }, {\n          key: \"_append\",\n          value: function _append(collection, newValues, replace) {\n            if (typeof collection.values === 'function') {\n              throw new Error('Unable to append to values, as it is a function.');\n            } else if (!replace) {\n              collection.values = collection.values.concat(newValues);\n            } else {\n              collection.values = newValues;\n            }\n          }\n        }, {\n          key: \"append\",\n          value: function append(collectionIndex, newValues, replace) {\n            var index = parseInt(collectionIndex);\n            if (typeof index !== 'number') throw new Error('please provide an index for the collection to update.');\n            var collection = this.collection[index];\n\n            this._append(collection, newValues, replace);\n          }\n        }, {\n          key: \"appendCurrent\",\n          value: function appendCurrent(newValues, replace) {\n            if (this.isActive) {\n              this._append(this.current.collection, newValues, replace);\n            } else {\n              throw new Error('No active state. Please use append instead and pass an index.');\n            }\n          }\n        }, {\n          key: \"detach\",\n          value: function detach(el) {\n            if (!el) {\n              throw new Error('[Tribute] Must pass in a DOM node or NodeList.');\n            } // Check if it is a jQuery collection\n\n\n            if (typeof jQuery !== 'undefined' && el instanceof jQuery) {\n              el = el.get();\n            } // Is el an Array/Array-like object?\n\n\n            if (el.constructor === NodeList || el.constructor === HTMLCollection || el.constructor === Array) {\n              var length = el.length;\n\n              for (var i = 0; i < length; ++i) {\n                this._detach(el[i]);\n              }\n            } else {\n              this._detach(el);\n            }\n          }\n        }, {\n          key: \"_detach\",\n          value: function _detach(el) {\n            var _this3 = this;\n\n            this.events.unbind(el);\n\n            if (el.tributeMenu) {\n              this.menuEvents.unbind(el.tributeMenu);\n            }\n\n            setTimeout(function () {\n              el.removeAttribute('data-tribute');\n              _this3.isActive = false;\n\n              if (el.tributeMenu) {\n                el.tributeMenu.remove();\n              }\n            });\n          }\n        }], [{\n          key: \"defaultSelectTemplate\",\n          value: function defaultSelectTemplate(item) {\n            if (typeof item === 'undefined') return null;\n\n            if (this.range.isContentEditable(this.current.element)) {\n              return '<span class=\"tribute-mention\">' + (this.current.collection.trigger + item.original[this.current.collection.fillAttr]) + '</span>';\n            }\n\n            return this.current.collection.trigger + item.original[this.current.collection.fillAttr];\n          }\n        }, {\n          key: \"defaultMenuItemTemplate\",\n          value: function defaultMenuItemTemplate(matchItem) {\n            return matchItem.string;\n          }\n        }, {\n          key: \"inputTypes\",\n          value: function inputTypes() {\n            return ['TEXTAREA', 'INPUT'];\n          }\n        }]);\n\n        return Tribute;\n      }();\n\n      var _default = Tribute;\n      exports[\"default\"] = _default;\n      module.exports = exports[\"default\"];\n    }, {\n      \"./TributeEvents\": 2,\n      \"./TributeMenuEvents\": 3,\n      \"./TributeRange\": 4,\n      \"./TributeSearch\": 5,\n      \"./utils\": 7\n    }],\n    2: [function (require, module, exports) {\n      \"use strict\";\n\n      Object.defineProperty(exports, \"__esModule\", {\n        value: true\n      });\n      exports[\"default\"] = void 0;\n\n      function _classCallCheck(instance, Constructor) {\n        if (!(instance instanceof Constructor)) {\n          throw new TypeError(\"Cannot call a class as a function\");\n        }\n      }\n\n      function _defineProperties(target, props) {\n        for (var i = 0; i < props.length; i++) {\n          var descriptor = props[i];\n          descriptor.enumerable = descriptor.enumerable || false;\n          descriptor.configurable = true;\n          if (\"value\" in descriptor) descriptor.writable = true;\n          Object.defineProperty(target, descriptor.key, descriptor);\n        }\n      }\n\n      function _createClass(Constructor, protoProps, staticProps) {\n        if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n        if (staticProps) _defineProperties(Constructor, staticProps);\n        return Constructor;\n      }\n\n      var TributeEvents = /*#__PURE__*/function () {\n        function TributeEvents(tribute) {\n          _classCallCheck(this, TributeEvents);\n\n          this.tribute = tribute;\n          this.tribute.events = this;\n        }\n\n        _createClass(TributeEvents, [{\n          key: \"bind\",\n          value: function bind(element) {\n            element.boundKeydown = this.keydown.bind(element, this);\n            element.boundKeyup = this.keyup.bind(element, this);\n            element.boundInput = this.input.bind(element, this);\n            element.addEventListener('keydown', element.boundKeydown, false);\n            element.addEventListener('keyup', element.boundKeyup, false);\n            element.addEventListener('input', element.boundInput, false);\n          }\n        }, {\n          key: \"unbind\",\n          value: function unbind(element) {\n            element.removeEventListener('keydown', element.boundKeydown, false);\n            element.removeEventListener('keyup', element.boundKeyup, false);\n            element.removeEventListener('input', element.boundInput, false);\n            delete element.boundKeydown;\n            delete element.boundKeyup;\n            delete element.boundInput;\n          }\n        }, {\n          key: \"keydown\",\n          value: function keydown(instance, event) {\n            if (instance.shouldDeactivate(event)) {\n              instance.tribute.isActive = false;\n              instance.tribute.hideMenu();\n            }\n\n            var element = this;\n            instance.commandEvent = false;\n            TributeEvents.keys().forEach(function (o) {\n              if (o.key === event.keyCode) {\n                instance.commandEvent = true;\n                instance.callbacks()[o.value.toLowerCase()](event, element);\n              }\n            });\n          }\n        }, {\n          key: \"input\",\n          value: function input(instance, event) {\n            instance.inputEvent = true;\n            instance.keyup.call(this, instance, event);\n          }\n        }, {\n          key: \"click\",\n          value: function click(instance, event) {\n            var tribute = instance.tribute;\n\n            if (tribute.menu && tribute.menu.contains(event.target)) {\n              var li = event.target;\n              event.preventDefault();\n              event.stopPropagation();\n\n              while (li.nodeName.toLowerCase() !== 'li') {\n                li = li.parentNode;\n\n                if (!li || li === tribute.menu) {\n                  throw new Error('cannot find the <li> container for the click');\n                }\n              }\n\n              if (li.getElementsByClassName(\"disabled-tribute-element\")[0] == undefined) {\n                tribute.selectItemAtIndex(li.getAttribute('data-index'), event);\n                tribute.hideMenu(); // TODO: should fire with externalTrigger and target is outside of menu\n              }\n            } else if (tribute.current.element && !tribute.current.externalTrigger) {\n              tribute.current.externalTrigger = false;\n              setTimeout(function () {\n                return tribute.hideMenu();\n              });\n            }\n          }\n        }, {\n          key: \"keyup\",\n          value: function keyup(instance, event) {\n            if (instance.inputEvent) {\n              instance.inputEvent = false;\n            }\n\n            instance.updateSelection(this);\n            if (event.keyCode === 27) return;\n\n            if (!instance.tribute.allowSpaces && instance.tribute.hasTrailingSpace) {\n              instance.tribute.hasTrailingSpace = false;\n              instance.commandEvent = true;\n              instance.callbacks()[\"space\"](event, this);\n              return;\n            }\n\n            if (!instance.tribute.isActive) {\n              if (instance.tribute.autocompleteMode) {\n                instance.callbacks().triggerChar(event, this, '');\n              } else {\n                var keyCode = instance.getKeyCode(instance, this, event);\n                if (isNaN(keyCode) || !keyCode) return;\n                var trigger = instance.tribute.triggers().find(function (trigger) {\n                  return trigger.charCodeAt(0) === keyCode;\n                });\n\n                if (typeof trigger !== 'undefined') {\n                  instance.callbacks().triggerChar(event, this, trigger);\n                }\n              }\n            }\n\n            if ((instance.tribute.current.trigger || instance.tribute.autocompleteMode) && instance.commandEvent === false || instance.tribute.isActive && event.keyCode === 8) {\n              instance.tribute.showMenuFor(this, true);\n            }\n          }\n        }, {\n          key: \"shouldDeactivate\",\n          value: function shouldDeactivate(event) {\n            if (!this.tribute.isActive) return false;\n\n            if (this.tribute.current.mentionText.length === 0) {\n              var eventKeyPressed = false;\n              TributeEvents.keys().forEach(function (o) {\n                if (event.keyCode === o.key) eventKeyPressed = true;\n              });\n              return !eventKeyPressed;\n            }\n\n            return false;\n          }\n        }, {\n          key: \"getKeyCode\",\n          value: function getKeyCode(instance, el, event) {\n            var _char;\n\n            var tribute = instance.tribute;\n            var info = tribute.range.getTriggerInfo(false, tribute.hasTrailingSpace, true, tribute.allowSpaces, tribute.autocompleteMode);\n\n            if (info) {\n              return info.mentionTriggerChar.charCodeAt(0);\n            } else {\n              return false;\n            }\n          }\n        }, {\n          key: \"updateSelection\",\n          value: function updateSelection(el) {\n            this.tribute.current.element = el;\n            var info = this.tribute.range.getTriggerInfo(false, this.tribute.hasTrailingSpace, true, this.tribute.allowSpaces, this.tribute.autocompleteMode);\n\n            if (info) {\n              this.tribute.current.selectedPath = info.mentionSelectedPath;\n              this.tribute.current.mentionText = info.mentionText;\n              this.tribute.current.selectedOffset = info.mentionSelectedOffset;\n            }\n          }\n        }, {\n          key: \"callbacks\",\n          value: function callbacks() {\n            var _this = this;\n\n            return {\n              triggerChar: function triggerChar(e, el, trigger) {\n                var tribute = _this.tribute;\n                tribute.current.trigger = trigger;\n                var collectionItem = tribute.collection.find(function (item) {\n                  return item.trigger === trigger;\n                });\n                tribute.current.collection = collectionItem;\n                if (tribute.inputEvent) tribute.showMenuFor(el, true);\n              },\n              enter: function enter(e, el) {\n                // choose selection\n                if (_this.tribute.isActive && _this.tribute.current.filteredItems) {\n                  e.preventDefault();\n                  e.stopPropagation();\n                  setTimeout(function () {\n                    _this.tribute.selectItemAtIndex(_this.tribute.menuSelected, e);\n\n                    _this.tribute.hideMenu();\n                  }, 0);\n                }\n              },\n              escape: function escape(e, el) {\n                if (_this.tribute.isActive) {\n                  e.preventDefault();\n                  e.stopPropagation();\n                  _this.tribute.isActive = false;\n\n                  _this.tribute.hideMenu();\n                }\n              },\n              tab: function tab(e, el) {\n                // choose first match\n                _this.callbacks().enter(e, el);\n              },\n              space: function space(e, el) {\n                if (_this.tribute.isActive) {\n                  if (_this.tribute.spaceSelectsMatch) {\n                    _this.callbacks().enter(e, el);\n                  } else if (!_this.tribute.allowSpaces) {\n                    e.stopPropagation();\n                    setTimeout(function () {\n                      _this.tribute.hideMenu();\n\n                      _this.tribute.isActive = false;\n                    }, 0);\n                  }\n                }\n              },\n              up: function up(e, el) {\n                // navigate up ul\n                if (_this.tribute.isActive && _this.tribute.current.filteredItems) {\n                  e.preventDefault();\n                  e.stopPropagation();\n                  var count = _this.tribute.current.filteredItems.length,\n                      selected = _this.tribute.menuSelected;\n\n                  if (count > selected && selected > 0) {\n                    _this.tribute.menuSelected--;\n\n                    _this.setActiveLi();\n                  } else if (selected === 0) {\n                    _this.tribute.menuSelected = count - 1;\n\n                    _this.setActiveLi();\n\n                    _this.tribute.menu.scrollTop = _this.tribute.menu.scrollHeight;\n                  }\n                }\n              },\n              down: function down(e, el) {\n                // navigate down ul\n                if (_this.tribute.isActive && _this.tribute.current.filteredItems) {\n                  e.preventDefault();\n                  e.stopPropagation();\n                  var count = _this.tribute.current.filteredItems.length - 1,\n                      selected = _this.tribute.menuSelected;\n\n                  if (count > selected) {\n                    _this.tribute.menuSelected++;\n\n                    _this.setActiveLi();\n                  } else if (count === selected) {\n                    _this.tribute.menuSelected = 0;\n\n                    _this.setActiveLi();\n\n                    _this.tribute.menu.scrollTop = 0;\n                  }\n                }\n              },\n              \"delete\": function _delete(e, el) {\n                if (_this.tribute.isActive && _this.tribute.current.mentionText.length < 1) {\n                  _this.tribute.hideMenu();\n                } else if (_this.tribute.isActive) {\n                  _this.tribute.showMenuFor(el);\n                }\n              }\n            };\n          }\n        }, {\n          key: \"setActiveLi\",\n          value: function setActiveLi(index) {\n            var lis = this.tribute.menu.querySelectorAll('li'),\n                length = lis.length >>> 0;\n            if (index) this.tribute.menuSelected = parseInt(index);\n\n            for (var i = 0; i < length; i++) {\n              var li = lis[i];\n\n              if (i === this.tribute.menuSelected) {\n                li.classList.add(this.tribute.current.collection.selectClass);\n                var liClientRect = li.getBoundingClientRect();\n                var menuClientRect = this.tribute.menu.getBoundingClientRect();\n\n                if (liClientRect.bottom > menuClientRect.bottom) {\n                  var scrollDistance = liClientRect.bottom - menuClientRect.bottom;\n                  this.tribute.menu.scrollTop += scrollDistance;\n                } else if (liClientRect.top < menuClientRect.top) {\n                  var _scrollDistance = menuClientRect.top - liClientRect.top;\n\n                  this.tribute.menu.scrollTop -= _scrollDistance;\n                }\n              } else {\n                li.classList.remove(this.tribute.current.collection.selectClass);\n              }\n            }\n          }\n        }, {\n          key: \"getFullHeight\",\n          value: function getFullHeight(elem, includeMargin) {\n            var height = elem.getBoundingClientRect().height;\n\n            if (includeMargin) {\n              var style = elem.currentStyle || window.getComputedStyle(elem);\n              return height + parseFloat(style.marginTop) + parseFloat(style.marginBottom);\n            }\n\n            return height;\n          }\n        }], [{\n          key: \"keys\",\n          value: function keys() {\n            return [{\n              key: 9,\n              value: 'TAB'\n            }, {\n              key: 8,\n              value: 'DELETE'\n            }, {\n              key: 13,\n              value: 'ENTER'\n            }, {\n              key: 27,\n              value: 'ESCAPE'\n            }, {\n              key: 32,\n              value: 'SPACE'\n            }, {\n              key: 38,\n              value: 'UP'\n            }, {\n              key: 40,\n              value: 'DOWN'\n            }];\n          }\n        }]);\n\n        return TributeEvents;\n      }();\n\n      var _default = TributeEvents;\n      exports[\"default\"] = _default;\n      module.exports = exports[\"default\"];\n    }, {}],\n    3: [function (require, module, exports) {\n      \"use strict\";\n\n      Object.defineProperty(exports, \"__esModule\", {\n        value: true\n      });\n      exports[\"default\"] = void 0;\n\n      function _classCallCheck(instance, Constructor) {\n        if (!(instance instanceof Constructor)) {\n          throw new TypeError(\"Cannot call a class as a function\");\n        }\n      }\n\n      function _defineProperties(target, props) {\n        for (var i = 0; i < props.length; i++) {\n          var descriptor = props[i];\n          descriptor.enumerable = descriptor.enumerable || false;\n          descriptor.configurable = true;\n          if (\"value\" in descriptor) descriptor.writable = true;\n          Object.defineProperty(target, descriptor.key, descriptor);\n        }\n      }\n\n      function _createClass(Constructor, protoProps, staticProps) {\n        if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n        if (staticProps) _defineProperties(Constructor, staticProps);\n        return Constructor;\n      }\n\n      var TributeMenuEvents = /*#__PURE__*/function () {\n        function TributeMenuEvents(tribute) {\n          _classCallCheck(this, TributeMenuEvents);\n\n          this.tribute = tribute;\n          this.tribute.menuEvents = this;\n          this.menu = this.tribute.menu;\n        }\n\n        _createClass(TributeMenuEvents, [{\n          key: \"bind\",\n          value: function bind(menu) {\n            var _this = this;\n\n            this.menuClickEvent = this.tribute.events.click.bind(null, this);\n            this.menuContainerScrollEvent = this.debounce(function () {\n              if (_this.tribute.isActive) {\n                _this.tribute.showMenuFor(_this.tribute.current.element, false);\n              }\n            }, 300, false);\n            this.windowResizeEvent = this.debounce(function () {\n              if (_this.tribute.isActive) {\n                _this.tribute.range.positionMenuAtCaret(true);\n              }\n            }, 300, false); // fixes IE11 issues with mousedown\n\n            this.tribute.range.getDocument().addEventListener('MSPointerDown', this.menuClickEvent, false);\n            this.tribute.range.getDocument().addEventListener('mousedown', this.menuClickEvent, false);\n            window.addEventListener('resize', this.windowResizeEvent);\n\n            if (this.menuContainer) {\n              this.menuContainer.addEventListener('scroll', this.menuContainerScrollEvent, false);\n            } else {\n              window.addEventListener('scroll', this.menuContainerScrollEvent);\n            }\n          }\n        }, {\n          key: \"unbind\",\n          value: function unbind(menu) {\n            this.tribute.range.getDocument().removeEventListener('mousedown', this.menuClickEvent, false);\n            this.tribute.range.getDocument().removeEventListener('MSPointerDown', this.menuClickEvent, false);\n            window.removeEventListener('resize', this.windowResizeEvent);\n\n            if (this.menuContainer) {\n              this.menuContainer.removeEventListener('scroll', this.menuContainerScrollEvent, false);\n            } else {\n              window.removeEventListener('scroll', this.menuContainerScrollEvent);\n            }\n          }\n        }, {\n          key: \"debounce\",\n          value: function debounce(func, wait, immediate) {\n            var _this2 = this,\n                _arguments = arguments;\n\n            var timeout;\n            return function () {\n              var context = _this2,\n                  args = _arguments;\n\n              var later = function later() {\n                timeout = null;\n                if (!immediate) func.apply(context, args);\n              };\n\n              var callNow = immediate && !timeout;\n              clearTimeout(timeout);\n              timeout = setTimeout(later, wait);\n              if (callNow) func.apply(context, args);\n            };\n          }\n        }]);\n\n        return TributeMenuEvents;\n      }();\n\n      var _default = TributeMenuEvents;\n      exports[\"default\"] = _default;\n      module.exports = exports[\"default\"];\n    }, {}],\n    4: [function (require, module, exports) {\n      \"use strict\";\n\n      Object.defineProperty(exports, \"__esModule\", {\n        value: true\n      });\n      exports[\"default\"] = void 0;\n\n      function _classCallCheck(instance, Constructor) {\n        if (!(instance instanceof Constructor)) {\n          throw new TypeError(\"Cannot call a class as a function\");\n        }\n      }\n\n      function _defineProperties(target, props) {\n        for (var i = 0; i < props.length; i++) {\n          var descriptor = props[i];\n          descriptor.enumerable = descriptor.enumerable || false;\n          descriptor.configurable = true;\n          if (\"value\" in descriptor) descriptor.writable = true;\n          Object.defineProperty(target, descriptor.key, descriptor);\n        }\n      }\n\n      function _createClass(Constructor, protoProps, staticProps) {\n        if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n        if (staticProps) _defineProperties(Constructor, staticProps);\n        return Constructor;\n      } // Thanks to https://github.com/jeff-collins/ment.io\n\n\n      var TributeRange = /*#__PURE__*/function () {\n        function TributeRange(tribute) {\n          _classCallCheck(this, TributeRange);\n\n          this.tribute = tribute;\n          this.tribute.range = this;\n        }\n\n        _createClass(TributeRange, [{\n          key: \"getDocument\",\n          value: function getDocument() {\n            var iframe;\n\n            if (this.tribute.current.collection) {\n              iframe = this.tribute.current.collection.iframe;\n            }\n\n            if (!iframe) {\n              return document;\n            }\n\n            return iframe.contentWindow.document;\n          }\n        }, {\n          key: \"positionMenuAtCaret\",\n          value: function positionMenuAtCaret(scrollTo) {\n            var _this = this;\n\n            var context = this.tribute.current,\n                coordinates;\n            var info = this.getTriggerInfo(false, this.tribute.hasTrailingSpace, true, this.tribute.allowSpaces, this.tribute.autocompleteMode);\n\n            if (typeof info !== 'undefined') {\n              if (!this.tribute.positionMenu) {\n                this.tribute.menu.style.cssText = \"display: block;\";\n                return;\n              }\n\n              if (!this.isContentEditable(context.element)) {\n                coordinates = this.getTextAreaOrInputUnderlinePosition(this.tribute.current.element, info.mentionPosition);\n              } else {\n                coordinates = this.getContentEditableCaretPosition(info.mentionPosition);\n              }\n\n              this.tribute.menu.style.cssText = \"top: \".concat(coordinates.top, \"px;\\n                                     left: \").concat(coordinates.left, \"px;\\n                                     right: \").concat(coordinates.right, \"px;\\n                                     bottom: \").concat(coordinates.bottom, \"px;\\n                                     position: absolute;\\n                                     display: block;\");\n\n              if (coordinates.left === 'auto') {\n                this.tribute.menu.style.left = 'auto';\n              }\n\n              if (coordinates.top === 'auto') {\n                this.tribute.menu.style.top = 'auto';\n              }\n\n              if (scrollTo) this.scrollIntoView();\n              window.setTimeout(function () {\n                var menuDimensions = {\n                  width: _this.tribute.menu.offsetWidth,\n                  height: _this.tribute.menu.offsetHeight\n                };\n\n                var menuIsOffScreen = _this.isMenuOffScreen(coordinates, menuDimensions);\n\n                var menuIsOffScreenHorizontally = window.innerWidth > menuDimensions.width && (menuIsOffScreen.left || menuIsOffScreen.right);\n                var menuIsOffScreenVertically = window.innerHeight > menuDimensions.height && (menuIsOffScreen.top || menuIsOffScreen.bottom);\n\n                if (menuIsOffScreenHorizontally || menuIsOffScreenVertically) {\n                  _this.tribute.menu.style.cssText = 'display: none';\n\n                  _this.positionMenuAtCaret(scrollTo);\n                }\n              }, 0);\n            } else {\n              this.tribute.menu.style.cssText = 'display: none';\n            }\n          }\n        }, {\n          key: \"selectElement\",\n          value: function selectElement(targetElement, path, offset) {\n            var range;\n            var elem = targetElement;\n\n            if (path) {\n              for (var i = 0; i < path.length; i++) {\n                elem = elem.childNodes[path[i]];\n\n                if (elem === undefined) {\n                  return;\n                }\n\n                while (elem.length < offset) {\n                  offset -= elem.length;\n                  elem = elem.nextSibling;\n                }\n\n                if (elem.childNodes.length === 0 && !elem.length) {\n                  elem = elem.previousSibling;\n                }\n              }\n            }\n\n            var sel = this.getWindowSelection();\n            range = this.getDocument().createRange();\n            range.setStart(elem, offset);\n            range.setEnd(elem, offset);\n            range.collapse(true);\n\n            try {\n              sel.removeAllRanges();\n            } catch (error) {}\n\n            sel.addRange(range);\n            targetElement.focus();\n          }\n        }, {\n          key: \"replaceTriggerText\",\n          value: function replaceTriggerText(text, requireLeadingSpace, hasTrailingSpace, originalEvent, item) {\n            var info = this.getTriggerInfo(true, hasTrailingSpace, requireLeadingSpace, this.tribute.allowSpaces, this.tribute.autocompleteMode);\n\n            if (info !== undefined) {\n              var context = this.tribute.current;\n              var replaceEvent = new CustomEvent('tribute-replaced', {\n                detail: {\n                  item: item,\n                  instance: context,\n                  context: info,\n                  event: originalEvent\n                }\n              });\n\n              if (!this.isContentEditable(context.element)) {\n                var myField = this.tribute.current.element;\n                var textSuffix = typeof this.tribute.replaceTextSuffix == 'string' ? this.tribute.replaceTextSuffix : ' ';\n                text += textSuffix;\n                var startPos = info.mentionPosition;\n                var endPos = info.mentionPosition + info.mentionText.length + textSuffix.length;\n                myField.value = myField.value.substring(0, startPos) + text + myField.value.substring(endPos, myField.value.length);\n                myField.selectionStart = startPos + text.length;\n                myField.selectionEnd = startPos + text.length;\n              } else {\n                // add a space to the end of the pasted text\n                var _textSuffix = typeof this.tribute.replaceTextSuffix == 'string' ? this.tribute.replaceTextSuffix : '\\xA0';\n\n                text += _textSuffix;\n                this.pasteHtml(text, info.mentionPosition, info.mentionPosition + info.mentionText.length + !this.tribute.autocompleteMode);\n              }\n\n              context.element.dispatchEvent(replaceEvent);\n            }\n          }\n        }, {\n          key: \"pasteHtml\",\n          value: function pasteHtml(html, startPos, endPos) {\n            var range, sel;\n            sel = this.getWindowSelection();\n            range = this.getDocument().createRange();\n            range.setStart(sel.anchorNode, startPos);\n            range.setEnd(sel.anchorNode, endPos);\n            range.deleteContents();\n            var el = this.getDocument().createElement('div');\n            el.innerHTML = html;\n            var frag = this.getDocument().createDocumentFragment(),\n                node,\n                lastNode;\n\n            while (node = el.firstChild) {\n              lastNode = frag.appendChild(node);\n            }\n\n            range.insertNode(frag); // Preserve the selection\n\n            if (lastNode) {\n              range = range.cloneRange();\n              range.setStartAfter(lastNode);\n              range.collapse(true);\n              sel.removeAllRanges();\n              sel.addRange(range);\n            }\n          }\n        }, {\n          key: \"getWindowSelection\",\n          value: function getWindowSelection() {\n            if (this.tribute.collection.iframe) {\n              return this.tribute.collection.iframe.contentWindow.getSelection();\n            }\n\n            return window.getSelection();\n          }\n        }, {\n          key: \"getNodePositionInParent\",\n          value: function getNodePositionInParent(element) {\n            if (element.parentNode === null) {\n              return 0;\n            }\n\n            for (var i = 0; i < element.parentNode.childNodes.length; i++) {\n              var node = element.parentNode.childNodes[i];\n\n              if (node === element) {\n                return i;\n              }\n            }\n          }\n        }, {\n          key: \"getContentEditableSelectedPath\",\n          value: function getContentEditableSelectedPath(ctx) {\n            var sel = this.getWindowSelection();\n            var selected = sel.anchorNode;\n            var path = [];\n            var offset;\n\n            if (selected != null) {\n              var i;\n              var ce = selected.contentEditable;\n\n              while (selected !== null && ce !== 'true') {\n                i = this.getNodePositionInParent(selected);\n                path.push(i);\n                selected = selected.parentNode;\n\n                if (selected !== null) {\n                  ce = selected.contentEditable;\n                }\n              }\n\n              path.reverse(); // getRangeAt may not exist, need alternative\n\n              offset = sel.getRangeAt(0).startOffset;\n              return {\n                selected: selected,\n                path: path,\n                offset: offset\n              };\n            }\n          }\n        }, {\n          key: \"getTextPrecedingCurrentSelection\",\n          value: function getTextPrecedingCurrentSelection() {\n            var context = this.tribute.current,\n                text = '';\n\n            if (!this.isContentEditable(context.element)) {\n              var textComponent = this.tribute.current.element;\n\n              if (textComponent) {\n                var startPos = textComponent.selectionStart;\n\n                if (textComponent.value && startPos >= 0) {\n                  text = textComponent.value.substring(0, startPos);\n                }\n              }\n            } else {\n              var selectedElem = this.getWindowSelection().anchorNode;\n\n              if (selectedElem != null) {\n                var workingNodeContent = selectedElem.textContent;\n                var selectStartOffset = this.getWindowSelection().getRangeAt(0).startOffset;\n\n                if (workingNodeContent && selectStartOffset >= 0) {\n                  text = workingNodeContent.substring(0, selectStartOffset);\n                }\n              }\n            }\n\n            return text;\n          }\n        }, {\n          key: \"getLastWordInText\",\n          value: function getLastWordInText(text) {\n            text = text.replace(/\\u00A0/g, ' '); // https://stackoverflow.com/questions/29850407/how-do-i-replace-unicode-character-u00a0-with-a-space-in-javascript\n\n            var wordsArray = text.split(/\\s+/);\n            var worldsCount = wordsArray.length - 1;\n            return wordsArray[worldsCount].trim();\n          }\n        }, {\n          key: \"getTriggerInfo\",\n          value: function getTriggerInfo(menuAlreadyActive, hasTrailingSpace, requireLeadingSpace, allowSpaces, isAutocomplete) {\n            var _this2 = this;\n\n            var ctx = this.tribute.current;\n            var selected, path, offset;\n\n            if (!this.isContentEditable(ctx.element)) {\n              selected = this.tribute.current.element;\n            } else {\n              var selectionInfo = this.getContentEditableSelectedPath(ctx);\n\n              if (selectionInfo) {\n                selected = selectionInfo.selected;\n                path = selectionInfo.path;\n                offset = selectionInfo.offset;\n              }\n            }\n\n            var effectiveRange = this.getTextPrecedingCurrentSelection();\n            var lastWordOfEffectiveRange = this.getLastWordInText(effectiveRange);\n\n            if (isAutocomplete) {\n              return {\n                mentionPosition: effectiveRange.length - lastWordOfEffectiveRange.length,\n                mentionText: lastWordOfEffectiveRange,\n                mentionSelectedElement: selected,\n                mentionSelectedPath: path,\n                mentionSelectedOffset: offset\n              };\n            }\n\n            if (effectiveRange !== undefined && effectiveRange !== null) {\n              var mostRecentTriggerCharPos = -1;\n              var triggerChar;\n              this.tribute.collection.forEach(function (config) {\n                var c = config.trigger;\n                var idx = config.requireLeadingSpace ? _this2.lastIndexWithLeadingSpace(effectiveRange, c) : effectiveRange.lastIndexOf(c);\n\n                if (idx > mostRecentTriggerCharPos) {\n                  mostRecentTriggerCharPos = idx;\n                  triggerChar = c;\n                  requireLeadingSpace = config.requireLeadingSpace;\n                }\n              });\n\n              if (mostRecentTriggerCharPos >= 0 && (mostRecentTriggerCharPos === 0 || !requireLeadingSpace || /[\\xA0\\s]/g.test(effectiveRange.substring(mostRecentTriggerCharPos - 1, mostRecentTriggerCharPos)))) {\n                var currentTriggerSnippet = effectiveRange.substring(mostRecentTriggerCharPos + 1, effectiveRange.length);\n                triggerChar = effectiveRange.substring(mostRecentTriggerCharPos, mostRecentTriggerCharPos + 1);\n                var firstSnippetChar = currentTriggerSnippet.substring(0, 1);\n                var leadingSpace = currentTriggerSnippet.length > 0 && (firstSnippetChar === ' ' || firstSnippetChar === '\\xA0');\n\n                if (hasTrailingSpace) {\n                  currentTriggerSnippet = currentTriggerSnippet.trim();\n                }\n\n                var regex = allowSpaces ? /[^\\S ]/g : /[\\xA0\\s]/g;\n                this.tribute.hasTrailingSpace = regex.test(currentTriggerSnippet);\n\n                if (!leadingSpace && (menuAlreadyActive || !regex.test(currentTriggerSnippet))) {\n                  return {\n                    mentionPosition: mostRecentTriggerCharPos,\n                    mentionText: currentTriggerSnippet,\n                    mentionSelectedElement: selected,\n                    mentionSelectedPath: path,\n                    mentionSelectedOffset: offset,\n                    mentionTriggerChar: triggerChar\n                  };\n                }\n              }\n            }\n          }\n        }, {\n          key: \"lastIndexWithLeadingSpace\",\n          value: function lastIndexWithLeadingSpace(str, _char) {\n            var reversedStr = str.split('').reverse().join('');\n            var index = -1;\n\n            for (var cidx = 0, len = str.length; cidx < len; cidx++) {\n              var firstChar = cidx === str.length - 1;\n              var leadingSpace = /\\s/.test(reversedStr[cidx + 1]);\n              var match = _char === reversedStr[cidx];\n\n              if (match && (firstChar || leadingSpace)) {\n                index = str.length - 1 - cidx;\n                break;\n              }\n            }\n\n            return index;\n          }\n        }, {\n          key: \"isContentEditable\",\n          value: function isContentEditable(element) {\n            return element.nodeName !== 'INPUT' && element.nodeName !== 'TEXTAREA';\n          }\n        }, {\n          key: \"isMenuOffScreen\",\n          value: function isMenuOffScreen(coordinates, menuDimensions) {\n            var windowWidth = window.innerWidth;\n            var windowHeight = window.innerHeight;\n            var doc = document.documentElement;\n            var windowLeft = (window.pageXOffset || doc.scrollLeft) - (doc.clientLeft || 0);\n            var windowTop = (window.pageYOffset || doc.scrollTop) - (doc.clientTop || 0);\n            var menuTop = typeof coordinates.top === 'number' ? coordinates.top : windowTop + windowHeight - coordinates.bottom - menuDimensions.height;\n            var menuRight = typeof coordinates.right === 'number' ? coordinates.right : coordinates.left + menuDimensions.width;\n            var menuBottom = typeof coordinates.bottom === 'number' ? coordinates.bottom : coordinates.top + menuDimensions.height;\n            var menuLeft = typeof coordinates.left === 'number' ? coordinates.left : windowLeft + windowWidth - coordinates.right - menuDimensions.width;\n            return {\n              top: menuTop < Math.floor(windowTop),\n              right: menuRight > Math.ceil(windowLeft + windowWidth),\n              bottom: menuBottom > Math.ceil(windowTop + windowHeight),\n              left: menuLeft < Math.floor(windowLeft)\n            };\n          }\n        }, {\n          key: \"getMenuDimensions\",\n          value: function getMenuDimensions() {\n            // Width of the menu depends of its contents and position\n            // We must check what its width would be without any obstruction\n            // This way, we can achieve good positioning for flipping the menu\n            var dimensions = {\n              width: null,\n              height: null\n            };\n            this.tribute.menu.style.cssText = \"top: 0px;\\n                                 left: 0px;\\n                                 position: fixed;\\n                                 display: block;\\n                                 visibility; hidden;\";\n            dimensions.width = this.tribute.menu.offsetWidth;\n            dimensions.height = this.tribute.menu.offsetHeight;\n            this.tribute.menu.style.cssText = \"display: none;\";\n            return dimensions;\n          }\n        }, {\n          key: \"getTextAreaOrInputUnderlinePosition\",\n          value: function getTextAreaOrInputUnderlinePosition(element, position, flipped) {\n            var properties = ['direction', 'boxSizing', 'width', 'height', 'overflowX', 'overflowY', 'borderTopWidth', 'borderRightWidth', 'borderBottomWidth', 'borderLeftWidth', 'paddingTop', 'paddingRight', 'paddingBottom', 'paddingLeft', 'fontStyle', 'fontVariant', 'fontWeight', 'fontStretch', 'fontSize', 'fontSizeAdjust', 'lineHeight', 'fontFamily', 'textAlign', 'textTransform', 'textIndent', 'textDecoration', 'letterSpacing', 'wordSpacing'];\n            var isFirefox = window.mozInnerScreenX !== null;\n            var div = this.getDocument().createElement('div');\n            div.id = 'input-textarea-caret-position-mirror-div';\n            this.getDocument().body.appendChild(div);\n            var style = div.style;\n            var computed = window.getComputedStyle ? getComputedStyle(element) : element.currentStyle;\n            style.whiteSpace = 'pre-wrap';\n\n            if (element.nodeName !== 'INPUT') {\n              style.wordWrap = 'break-word';\n            } // position off-screen\n\n\n            style.position = 'absolute';\n            style.visibility = 'hidden'; // transfer the element's properties to the div\n\n            properties.forEach(function (prop) {\n              style[prop] = computed[prop];\n            });\n\n            if (isFirefox) {\n              style.width = \"\".concat(parseInt(computed.width) - 2, \"px\");\n              if (element.scrollHeight > parseInt(computed.height)) style.overflowY = 'scroll';\n            } else {\n              style.overflow = 'hidden';\n            }\n\n            div.textContent = element.value.substring(0, position);\n\n            if (element.nodeName === 'INPUT') {\n              div.textContent = div.textContent.replace(/\\s/g, ' ');\n            }\n\n            var span = this.getDocument().createElement('span');\n            span.textContent = element.value.substring(position) || '.';\n            div.appendChild(span);\n            var rect = element.getBoundingClientRect();\n            var doc = document.documentElement;\n            var windowLeft = (window.pageXOffset || doc.scrollLeft) - (doc.clientLeft || 0);\n            var windowTop = (window.pageYOffset || doc.scrollTop) - (doc.clientTop || 0);\n            var top = 0;\n            var left = 0;\n\n            if (this.menuContainerIsBody) {\n              top = rect.top;\n              left = rect.left;\n            }\n\n            var coordinates = {\n              top: top + windowTop + span.offsetTop + parseInt(computed.borderTopWidth) + parseInt(computed.fontSize) - element.scrollTop,\n              left: left + windowLeft + span.offsetLeft + parseInt(computed.borderLeftWidth)\n            };\n            var windowWidth = window.innerWidth;\n            var windowHeight = window.innerHeight;\n            var menuDimensions = this.getMenuDimensions();\n            var menuIsOffScreen = this.isMenuOffScreen(coordinates, menuDimensions);\n\n            if (menuIsOffScreen.right) {\n              coordinates.right = windowWidth - coordinates.left;\n              coordinates.left = 'auto';\n            }\n\n            var parentHeight = this.tribute.menuContainer ? this.tribute.menuContainer.offsetHeight : this.getDocument().body.offsetHeight;\n\n            if (menuIsOffScreen.bottom) {\n              var parentRect = this.tribute.menuContainer ? this.tribute.menuContainer.getBoundingClientRect() : this.getDocument().body.getBoundingClientRect();\n              var scrollStillAvailable = parentHeight - (windowHeight - parentRect.top);\n              coordinates.bottom = scrollStillAvailable + (windowHeight - rect.top - span.offsetTop);\n              coordinates.top = 'auto';\n            }\n\n            menuIsOffScreen = this.isMenuOffScreen(coordinates, menuDimensions);\n\n            if (menuIsOffScreen.left) {\n              coordinates.left = windowWidth > menuDimensions.width ? windowLeft + windowWidth - menuDimensions.width : windowLeft;\n              delete coordinates.right;\n            }\n\n            if (menuIsOffScreen.top) {\n              coordinates.top = windowHeight > menuDimensions.height ? windowTop + windowHeight - menuDimensions.height : windowTop;\n              delete coordinates.bottom;\n            }\n\n            this.getDocument().body.removeChild(div);\n            return coordinates;\n          }\n        }, {\n          key: \"getContentEditableCaretPosition\",\n          value: function getContentEditableCaretPosition(selectedNodePosition) {\n            var markerTextChar = '';\n            var markerEl,\n                markerId = \"sel_\".concat(new Date().getTime(), \"_\").concat(Math.random().toString().substr(2));\n            var range;\n            var sel = this.getWindowSelection();\n            var prevRange = sel.getRangeAt(0);\n            range = this.getDocument().createRange();\n            range.setStart(sel.anchorNode, selectedNodePosition);\n            range.setEnd(sel.anchorNode, selectedNodePosition);\n            range.collapse(false); // Create the marker element containing a single invisible character using DOM methods and insert it\n\n            markerEl = this.getDocument().createElement('span');\n            markerEl.id = markerId;\n            markerEl.appendChild(this.getDocument().createTextNode(markerTextChar));\n            range.insertNode(markerEl);\n            sel.removeAllRanges();\n            sel.addRange(prevRange);\n            var rect = markerEl.getBoundingClientRect();\n            var doc = document.documentElement;\n            var windowLeft = (window.pageXOffset || doc.scrollLeft) - (doc.clientLeft || 0);\n            var windowTop = (window.pageYOffset || doc.scrollTop) - (doc.clientTop || 0);\n            var left = 0;\n            var top = 0;\n\n            if (this.menuContainerIsBody) {\n              left = rect.left;\n              top = rect.top;\n            } else {\n              left = markerEl.offsetLeft;\n              top = markerEl.offsetTop;\n            }\n\n            var coordinates = {\n              left: left + windowLeft,\n              top: top + markerEl.offsetHeight + windowTop\n            };\n            var windowWidth = window.innerWidth;\n            var windowHeight = window.innerHeight;\n            var menuDimensions = this.getMenuDimensions();\n            var menuIsOffScreen = this.isMenuOffScreen(coordinates, menuDimensions);\n\n            if (menuIsOffScreen.right) {\n              coordinates.left = 'auto';\n              coordinates.right = windowWidth - rect.left - windowLeft;\n            }\n\n            var parentHeight = this.tribute.menuContainer ? this.tribute.menuContainer.offsetHeight : this.getDocument().body.offsetHeight;\n\n            if (menuIsOffScreen.bottom) {\n              var parentRect = this.tribute.menuContainer ? this.tribute.menuContainer.getBoundingClientRect() : this.getDocument().body.getBoundingClientRect();\n              var scrollStillAvailable = parentHeight - (windowHeight - parentRect.top);\n              coordinates.top = 'auto';\n              coordinates.bottom = scrollStillAvailable + (windowHeight - rect.top);\n            }\n\n            menuIsOffScreen = this.isMenuOffScreen(coordinates, menuDimensions);\n\n            if (menuIsOffScreen.left) {\n              coordinates.left = windowWidth > menuDimensions.width ? windowLeft + windowWidth - menuDimensions.width : windowLeft;\n              delete coordinates.right;\n            }\n\n            if (menuIsOffScreen.top) {\n              coordinates.top = windowHeight > menuDimensions.height ? windowTop + windowHeight - menuDimensions.height : windowTop;\n              delete coordinates.bottom;\n            }\n\n            markerEl.parentNode.removeChild(markerEl);\n            return coordinates;\n          }\n        }, {\n          key: \"scrollIntoView\",\n          value: function scrollIntoView(elem) {\n            var reasonableBuffer = 20,\n                clientRect;\n            var maxScrollDisplacement = 100;\n            var e = this.menu;\n            if (typeof e === 'undefined') return;\n\n            while (clientRect === undefined || clientRect.height === 0) {\n              clientRect = e.getBoundingClientRect();\n\n              if (clientRect.height === 0) {\n                e = e.childNodes[0];\n\n                if (e === undefined || !e.getBoundingClientRect) {\n                  return;\n                }\n              }\n            }\n\n            var elemTop = clientRect.top;\n            var elemBottom = elemTop + clientRect.height;\n\n            if (elemTop < 0) {\n              window.scrollTo(0, window.pageYOffset + clientRect.top - reasonableBuffer);\n            } else if (elemBottom > window.innerHeight) {\n              var maxY = window.pageYOffset + clientRect.top - reasonableBuffer;\n\n              if (maxY - window.pageYOffset > maxScrollDisplacement) {\n                maxY = window.pageYOffset + maxScrollDisplacement;\n              }\n\n              var targetY = window.pageYOffset - (window.innerHeight - elemBottom);\n\n              if (targetY > maxY) {\n                targetY = maxY;\n              }\n\n              window.scrollTo(0, targetY);\n            }\n          }\n        }, {\n          key: \"menuContainerIsBody\",\n          get: function get() {\n            return this.tribute.menuContainer === document.body || !this.tribute.menuContainer;\n          }\n        }]);\n\n        return TributeRange;\n      }();\n\n      var _default = TributeRange;\n      exports[\"default\"] = _default;\n      module.exports = exports[\"default\"];\n    }, {}],\n    5: [function (require, module, exports) {\n      \"use strict\";\n\n      Object.defineProperty(exports, \"__esModule\", {\n        value: true\n      });\n      exports[\"default\"] = void 0;\n\n      function _classCallCheck(instance, Constructor) {\n        if (!(instance instanceof Constructor)) {\n          throw new TypeError(\"Cannot call a class as a function\");\n        }\n      }\n\n      function _defineProperties(target, props) {\n        for (var i = 0; i < props.length; i++) {\n          var descriptor = props[i];\n          descriptor.enumerable = descriptor.enumerable || false;\n          descriptor.configurable = true;\n          if (\"value\" in descriptor) descriptor.writable = true;\n          Object.defineProperty(target, descriptor.key, descriptor);\n        }\n      }\n\n      function _createClass(Constructor, protoProps, staticProps) {\n        if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n        if (staticProps) _defineProperties(Constructor, staticProps);\n        return Constructor;\n      } // Thanks to https://github.com/mattyork/fuzzy\n\n\n      var TributeSearch = /*#__PURE__*/function () {\n        function TributeSearch(tribute) {\n          _classCallCheck(this, TributeSearch);\n\n          this.tribute = tribute;\n          this.tribute.search = this;\n        }\n\n        _createClass(TributeSearch, [{\n          key: \"simpleFilter\",\n          value: function simpleFilter(pattern, array) {\n            var _this = this;\n\n            return array.filter(function (string) {\n              return _this.test(pattern, string);\n            });\n          }\n        }, {\n          key: \"test\",\n          value: function test(pattern, string) {\n            return this.match(pattern, string) !== null;\n          }\n        }, {\n          key: \"match\",\n          value: function match(pattern, string, opts) {\n            opts = opts || {};\n            var patternIdx = 0,\n                result = [],\n                len = string.length,\n                totalScore = 0,\n                currScore = 0,\n                pre = opts.pre || '',\n                post = opts.post || '',\n                compareString = opts.caseSensitive && string || string.toLowerCase(),\n                ch,\n                compareChar;\n\n            if (opts.skip) {\n              return {\n                rendered: string,\n                score: 0\n              };\n            }\n\n            pattern = opts.caseSensitive && pattern || pattern.toLowerCase();\n            var patternCache = this.traverse(compareString, pattern, 0, 0, []);\n\n            if (!patternCache) {\n              return null;\n            }\n\n            return {\n              rendered: this.render(string, patternCache.cache, pre, post),\n              score: patternCache.score\n            };\n          }\n        }, {\n          key: \"traverse\",\n          value: function traverse(string, pattern, stringIndex, patternIndex, patternCache) {\n            // if the pattern search at end\n            if (pattern.length === patternIndex) {\n              // calculate score and copy the cache containing the indices where it's found\n              return {\n                score: this.calculateScore(patternCache),\n                cache: patternCache.slice()\n              };\n            } // if string at end or remaining pattern > remaining string\n\n\n            if (string.length === stringIndex || pattern.length - patternIndex > string.length - stringIndex) {\n              return undefined;\n            }\n\n            var c = pattern[patternIndex];\n            var index = string.indexOf(c, stringIndex);\n            var best, temp;\n\n            while (index > -1) {\n              patternCache.push(index);\n              temp = this.traverse(string, pattern, index + 1, patternIndex + 1, patternCache);\n              patternCache.pop(); // if downstream traversal failed, return best answer so far\n\n              if (!temp) {\n                return best;\n              }\n\n              if (!best || best.score < temp.score) {\n                best = temp;\n              }\n\n              index = string.indexOf(c, index + 1);\n            }\n\n            return best;\n          }\n        }, {\n          key: \"calculateScore\",\n          value: function calculateScore(patternCache) {\n            var score = 0;\n            var temp = 1;\n            patternCache.forEach(function (index, i) {\n              if (i > 0) {\n                if (patternCache[i - 1] + 1 === index) {\n                  temp += temp + 1;\n                } else {\n                  temp = 1;\n                }\n              }\n\n              score += temp;\n            });\n            return score;\n          }\n        }, {\n          key: \"render\",\n          value: function render(string, indices, pre, post) {\n            var rendered = string.substring(0, indices[0]);\n            indices.forEach(function (index, i) {\n              rendered += pre + string[index] + post + string.substring(index + 1, indices[i + 1] ? indices[i + 1] : string.length);\n            });\n            return rendered;\n          }\n        }, {\n          key: \"filter\",\n          value: function filter(pattern, arr, opts) {\n            var _this2 = this;\n\n            opts = opts || {};\n            return arr.reduce(function (prev, element, idx, arr) {\n              var str = element;\n\n              if (opts.extract) {\n                str = opts.extract(element);\n\n                if (!str) {\n                  // take care of undefineds / nulls / etc.\n                  str = '';\n                }\n              }\n\n              var rendered = _this2.match(pattern, str, opts);\n\n              if (rendered != null) {\n                prev[prev.length] = {\n                  string: rendered.rendered,\n                  score: rendered.score,\n                  index: idx,\n                  original: element\n                };\n              }\n\n              return prev;\n            }, []).sort(function (a, b) {\n              var compare = b.score - a.score;\n              if (compare) return compare;\n              return a.index - b.index;\n            });\n          }\n        }]);\n\n        return TributeSearch;\n      }();\n\n      var _default = TributeSearch;\n      exports[\"default\"] = _default;\n      module.exports = exports[\"default\"];\n    }, {}],\n    6: [function (require, module, exports) {\n      \"use strict\";\n\n      Object.defineProperty(exports, \"__esModule\", {\n        value: true\n      });\n      exports[\"default\"] = void 0;\n\n      var _Tribute = _interopRequireDefault(require(\"./Tribute\"));\n\n      function _interopRequireDefault(obj) {\n        return obj && obj.__esModule ? obj : {\n          \"default\": obj\n        };\n      }\n      /**\n      * Tribute.js\n      * Native ES6 JavaScript @mention Plugin\n      **/\n\n\n      var _default = _Tribute[\"default\"];\n      exports[\"default\"] = _default;\n      module.exports = exports[\"default\"];\n    }, {\n      \"./Tribute\": 1\n    }],\n    7: [function (require, module, exports) {\n      \"use strict\";\n\n      if (!Array.prototype.find) {\n        Array.prototype.find = function (predicate) {\n          if (this === null) {\n            throw new TypeError('Array.prototype.find called on null or undefined');\n          }\n\n          if (typeof predicate !== 'function') {\n            throw new TypeError('predicate must be a function');\n          }\n\n          var list = Object(this);\n          var length = list.length >>> 0;\n          var thisArg = arguments[1];\n          var value;\n\n          for (var i = 0; i < length; i++) {\n            value = list[i];\n\n            if (predicate.call(thisArg, value, i, list)) {\n              return value;\n            }\n          }\n\n          return undefined;\n        };\n      }\n\n      if (window && typeof window.CustomEvent !== \"function\") {\n        var CustomEvent = function CustomEvent(event, params) {\n          params = params || {\n            bubbles: false,\n            cancelable: false,\n            detail: undefined\n          };\n          var evt = document.createEvent('CustomEvent');\n          evt.initCustomEvent(event, params.bubbles, params.cancelable, params.detail);\n          return evt;\n        };\n\n        if (typeof window.Event !== 'undefined') {\n          CustomEvent.prototype = window.Event.prototype;\n        }\n\n        window.CustomEvent = CustomEvent;\n      }\n    }, {}]\n  }, {}, [6])(6);\n});","map":{"version":3,"mappings":"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","names":["f","exports","module","define","amd","g","window","global","self","Tribute","r","e","n","t","o","i","c","require","u","a","Error","code","p","call","length","Object","defineProperty","value","_TributeEvents","_interopRequireDefault","_TributeMenuEvents","_TributeRange","_TributeSearch","obj","__esModule","_slicedToArray","arr","_arrayWithHoles","_iterableToArrayLimit","_nonIterableRest","TypeError","_arr","_n","_d","_e","undefined","_i","Symbol","iterator","_s","next","done","push","err","Array","isArray","_classCallCheck","instance","Constructor","_defineProperties","target","props","descriptor","enumerable","configurable","writable","key","_createClass","protoProps","staticProps","prototype","_ref","_this","_ref$values","values","_ref$iframe","iframe","_ref$selectClass","selectClass","_ref$trigger","trigger","_ref$autocompleteMode","autocompleteMode","_ref$selectTemplate","selectTemplate","_ref$menuItemTemplate","menuItemTemplate","_ref$lookup","lookup","_ref$fillAttr","fillAttr","_ref$collection","collection","_ref$menuContainer","menuContainer","_ref$noMatchTemplate","noMatchTemplate","_ref$requireLeadingSp","requireLeadingSpace","_ref$allowSpaces","allowSpaces","_ref$replaceTextSuffi","replaceTextSuffix","_ref$positionMenu","positionMenu","_ref$spaceSelectsMatc","spaceSelectsMatch","_ref$searchOpts","searchOpts","_ref$menuItemLimit","menuItemLimit","menuSelected","current","inputEvent","isActive","hasTrailingSpace","defaultSelectTemplate","bind","defaultMenuItemTemplate","console","warn","map","item","triggers","config","attach","el","jQuery","get","constructor","NodeList","HTMLCollection","_attach","hasAttribute","nodeName","ensureEditable","events","setAttribute","element","inputTypes","indexOf","contentEditable","createMenu","wrapper","range","getDocument","createElement","ul","className","appendChild","body","showMenuFor","scrollTo","_this2","mentionText","currentMentionTextSnapshot","menu","tributeMenu","menuEvents","processValues","items","search","filter","pre","post","skip","extract","slice","filteredItems","querySelector","positionMenuAtCaret","noMatchEvent","CustomEvent","detail","dispatchEvent","hideMenu","innerHTML","fragment","createDocumentFragment","forEach","index","li","addEventListener","_this2$_findLiTarget","_findLiTarget","_this2$_findLiTarget2","movementY","setActiveLi","getAttribute","parentNode","showMenuForCollection","collectionIndex","document","activeElement","placeCaretAtEnd","externalTrigger","isContentEditable","insertTextAtCursor","insertAtCaret","focus","getSelection","createRange","selectNodeContents","collapse","sel","removeAllRanges","addRange","createTextRange","textRange","moveToElementText","select","text","html","getRangeAt","deleteContents","textNode","createTextNode","insertNode","textarea","scrollPos","scrollTop","caretPos","selectionStart","front","substring","back","selectionEnd","style","cssText","selectItemAtIndex","originalEvent","parseInt","isNaN","content","replaceText","replaceTriggerText","_append","newValues","replace","concat","append","appendCurrent","detach","_detach","_this3","unbind","setTimeout","removeAttribute","remove","original","matchItem","string","_default","TributeEvents","tribute","boundKeydown","keydown","boundKeyup","keyup","boundInput","input","removeEventListener","event","shouldDeactivate","commandEvent","keys","keyCode","callbacks","toLowerCase","click","contains","preventDefault","stopPropagation","getElementsByClassName","updateSelection","triggerChar","getKeyCode","find","charCodeAt","eventKeyPressed","_char","info","getTriggerInfo","mentionTriggerChar","selectedPath","mentionSelectedPath","selectedOffset","mentionSelectedOffset","collectionItem","enter","escape","tab","space","up","count","selected","scrollHeight","down","_delete","lis","querySelectorAll","classList","add","liClientRect","getBoundingClientRect","menuClientRect","bottom","scrollDistance","top","_scrollDistance","getFullHeight","elem","includeMargin","height","currentStyle","getComputedStyle","parseFloat","marginTop","marginBottom","TributeMenuEvents","menuClickEvent","menuContainerScrollEvent","debounce","windowResizeEvent","func","wait","immediate","_arguments","arguments","timeout","context","args","later","apply","callNow","clearTimeout","TributeRange","contentWindow","coordinates","getTextAreaOrInputUnderlinePosition","mentionPosition","getContentEditableCaretPosition","left","right","scrollIntoView","menuDimensions","width","offsetWidth","offsetHeight","menuIsOffScreen","isMenuOffScreen","menuIsOffScreenHorizontally","innerWidth","menuIsOffScreenVertically","innerHeight","selectElement","targetElement","path","offset","childNodes","nextSibling","previousSibling","getWindowSelection","setStart","setEnd","error","replaceEvent","myField","textSuffix","startPos","endPos","_textSuffix","pasteHtml","anchorNode","frag","node","lastNode","firstChild","cloneRange","setStartAfter","getNodePositionInParent","getContentEditableSelectedPath","ctx","ce","reverse","startOffset","getTextPrecedingCurrentSelection","textComponent","selectedElem","workingNodeContent","textContent","selectStartOffset","getLastWordInText","wordsArray","split","worldsCount","trim","menuAlreadyActive","isAutocomplete","selectionInfo","effectiveRange","lastWordOfEffectiveRange","mentionSelectedElement","mostRecentTriggerCharPos","idx","lastIndexWithLeadingSpace","lastIndexOf","test","currentTriggerSnippet","firstSnippetChar","leadingSpace","regex","str","reversedStr","join","cidx","len","firstChar","match","windowWidth","windowHeight","doc","documentElement","windowLeft","pageXOffset","scrollLeft","clientLeft","windowTop","pageYOffset","clientTop","menuTop","menuRight","menuBottom","menuLeft","Math","floor","ceil","getMenuDimensions","dimensions","position","flipped","properties","isFirefox","mozInnerScreenX","div","id","computed","whiteSpace","wordWrap","visibility","prop","overflowY","overflow","span","rect","menuContainerIsBody","offsetTop","borderTopWidth","fontSize","offsetLeft","borderLeftWidth","parentHeight","parentRect","scrollStillAvailable","removeChild","selectedNodePosition","markerTextChar","markerEl","markerId","Date","getTime","random","toString","substr","prevRange","reasonableBuffer","clientRect","maxScrollDisplacement","elemTop","elemBottom","maxY","targetY","TributeSearch","simpleFilter","pattern","array","opts","patternIdx","result","totalScore","currScore","compareString","caseSensitive","ch","compareChar","rendered","score","patternCache","traverse","render","cache","stringIndex","patternIndex","calculateScore","best","temp","pop","indices","reduce","prev","sort","b","compare","_Tribute","predicate","list","thisArg","params","bubbles","cancelable","evt","createEvent","initCustomEvent","Event"],"sources":["/var/lib/gems/2.7.0/gems/decidim-core-0.26.0/app/packs/src/decidim/vendor/tribute.js"],"sourcesContent":["/* eslint-disable */\n\n/*\n  Modified file from the original tribute.js\n  Adding inside click event the conditional if the li element has no disabled-tribute-element class name. if true, then it must continue with normal behaviour.\n*/\n(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.Tribute = f()}})(function(){var define,module,exports;return (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nrequire(\"./utils\");\n\nvar _TributeEvents = _interopRequireDefault(require(\"./TributeEvents\"));\n\nvar _TributeMenuEvents = _interopRequireDefault(require(\"./TributeMenuEvents\"));\n\nvar _TributeRange = _interopRequireDefault(require(\"./TributeRange\"));\n\nvar _TributeSearch = _interopRequireDefault(require(\"./TributeSearch\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); }\n\nfunction _iterableToArrayLimit(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nvar Tribute =\n/*#__PURE__*/\nfunction () {\n  function Tribute(_ref) {\n    var _this = this;\n\n    var _ref$values = _ref.values,\n        values = _ref$values === void 0 ? null : _ref$values,\n        _ref$iframe = _ref.iframe,\n        iframe = _ref$iframe === void 0 ? null : _ref$iframe,\n        _ref$selectClass = _ref.selectClass,\n        selectClass = _ref$selectClass === void 0 ? 'highlight' : _ref$selectClass,\n        _ref$trigger = _ref.trigger,\n        trigger = _ref$trigger === void 0 ? '@' : _ref$trigger,\n        _ref$autocompleteMode = _ref.autocompleteMode,\n        autocompleteMode = _ref$autocompleteMode === void 0 ? false : _ref$autocompleteMode,\n        _ref$selectTemplate = _ref.selectTemplate,\n        selectTemplate = _ref$selectTemplate === void 0 ? null : _ref$selectTemplate,\n        _ref$menuItemTemplate = _ref.menuItemTemplate,\n        menuItemTemplate = _ref$menuItemTemplate === void 0 ? null : _ref$menuItemTemplate,\n        _ref$lookup = _ref.lookup,\n        lookup = _ref$lookup === void 0 ? 'key' : _ref$lookup,\n        _ref$fillAttr = _ref.fillAttr,\n        fillAttr = _ref$fillAttr === void 0 ? 'value' : _ref$fillAttr,\n        _ref$collection = _ref.collection,\n        collection = _ref$collection === void 0 ? null : _ref$collection,\n        _ref$menuContainer = _ref.menuContainer,\n        menuContainer = _ref$menuContainer === void 0 ? null : _ref$menuContainer,\n        _ref$noMatchTemplate = _ref.noMatchTemplate,\n        noMatchTemplate = _ref$noMatchTemplate === void 0 ? null : _ref$noMatchTemplate,\n        _ref$requireLeadingSp = _ref.requireLeadingSpace,\n        requireLeadingSpace = _ref$requireLeadingSp === void 0 ? true : _ref$requireLeadingSp,\n        _ref$allowSpaces = _ref.allowSpaces,\n        allowSpaces = _ref$allowSpaces === void 0 ? false : _ref$allowSpaces,\n        _ref$replaceTextSuffi = _ref.replaceTextSuffix,\n        replaceTextSuffix = _ref$replaceTextSuffi === void 0 ? null : _ref$replaceTextSuffi,\n        _ref$positionMenu = _ref.positionMenu,\n        positionMenu = _ref$positionMenu === void 0 ? true : _ref$positionMenu,\n        _ref$spaceSelectsMatc = _ref.spaceSelectsMatch,\n        spaceSelectsMatch = _ref$spaceSelectsMatc === void 0 ? false : _ref$spaceSelectsMatc,\n        _ref$searchOpts = _ref.searchOpts,\n        searchOpts = _ref$searchOpts === void 0 ? {} : _ref$searchOpts,\n        _ref$menuItemLimit = _ref.menuItemLimit,\n        menuItemLimit = _ref$menuItemLimit === void 0 ? null : _ref$menuItemLimit;\n\n    _classCallCheck(this, Tribute);\n\n    this.autocompleteMode = autocompleteMode;\n    this.menuSelected = 0;\n    this.current = {};\n    this.inputEvent = false;\n    this.isActive = false;\n    this.menuContainer = menuContainer;\n    this.allowSpaces = allowSpaces;\n    this.replaceTextSuffix = replaceTextSuffix;\n    this.positionMenu = positionMenu;\n    this.hasTrailingSpace = false;\n    this.spaceSelectsMatch = spaceSelectsMatch;\n\n    if (this.autocompleteMode) {\n      trigger = '';\n      allowSpaces = false;\n    }\n\n    if (values) {\n      this.collection = [{\n        // symbol that starts the lookup\n        trigger: trigger,\n        // is it wrapped in an iframe\n        iframe: iframe,\n        // class applied to selected item\n        selectClass: selectClass,\n        // function called on select that retuns the content to insert\n        selectTemplate: (selectTemplate || Tribute.defaultSelectTemplate).bind(this),\n        // function called that returns content for an item\n        menuItemTemplate: (menuItemTemplate || Tribute.defaultMenuItemTemplate).bind(this),\n        // function called when menu is empty, disables hiding of menu.\n        noMatchTemplate: function (t) {\n          if (typeof t === 'function') {\n            return t.bind(_this);\n          }\n\n          return noMatchTemplate || function () {\n            return '';\n          }.bind(_this);\n        }(noMatchTemplate),\n        // column to search against in the object\n        lookup: lookup,\n        // column that contains the content to insert by default\n        fillAttr: fillAttr,\n        // array of objects or a function returning an array of objects\n        values: values,\n        requireLeadingSpace: requireLeadingSpace,\n        searchOpts: searchOpts,\n        menuItemLimit: menuItemLimit\n      }];\n    } else if (collection) {\n      if (this.autocompleteMode) console.warn('Tribute in autocomplete mode does not work for collections');\n      this.collection = collection.map(function (item) {\n        return {\n          trigger: item.trigger || trigger,\n          iframe: item.iframe || iframe,\n          selectClass: item.selectClass || selectClass,\n          selectTemplate: (item.selectTemplate || Tribute.defaultSelectTemplate).bind(_this),\n          menuItemTemplate: (item.menuItemTemplate || Tribute.defaultMenuItemTemplate).bind(_this),\n          // function called when menu is empty, disables hiding of menu.\n          noMatchTemplate: function (t) {\n            if (typeof t === 'function') {\n              return t.bind(_this);\n            }\n\n            return null;\n          }(noMatchTemplate),\n          lookup: item.lookup || lookup,\n          fillAttr: item.fillAttr || fillAttr,\n          values: item.values,\n          requireLeadingSpace: item.requireLeadingSpace,\n          searchOpts: item.searchOpts || searchOpts,\n          menuItemLimit: item.menuItemLimit || menuItemLimit\n        };\n      });\n    } else {\n      throw new Error('[Tribute] No collection specified.');\n    }\n\n    new _TributeRange[\"default\"](this);\n    new _TributeEvents[\"default\"](this);\n    new _TributeMenuEvents[\"default\"](this);\n    new _TributeSearch[\"default\"](this);\n  }\n\n  _createClass(Tribute, [{\n    key: \"triggers\",\n    value: function triggers() {\n      return this.collection.map(function (config) {\n        return config.trigger;\n      });\n    }\n  }, {\n    key: \"attach\",\n    value: function attach(el) {\n      if (!el) {\n        throw new Error('[Tribute] Must pass in a DOM node or NodeList.');\n      } // Check if it is a jQuery collection\n\n\n      if (typeof jQuery !== 'undefined' && el instanceof jQuery) {\n        el = el.get();\n      } // Is el an Array/Array-like object?\n\n\n      if (el.constructor === NodeList || el.constructor === HTMLCollection || el.constructor === Array) {\n        var length = el.length;\n\n        for (var i = 0; i < length; ++i) {\n          this._attach(el[i]);\n        }\n      } else {\n        this._attach(el);\n      }\n    }\n  }, {\n    key: \"_attach\",\n    value: function _attach(el) {\n      if (el.hasAttribute('data-tribute')) {\n        console.warn('Tribute was already bound to ' + el.nodeName);\n      }\n\n      this.ensureEditable(el);\n      this.events.bind(el);\n      el.setAttribute('data-tribute', true);\n    }\n  }, {\n    key: \"ensureEditable\",\n    value: function ensureEditable(element) {\n      if (Tribute.inputTypes().indexOf(element.nodeName) === -1) {\n        if (element.contentEditable) {\n          element.contentEditable = true;\n        } else {\n          throw new Error('[Tribute] Cannot bind to ' + element.nodeName);\n        }\n      }\n    }\n  }, {\n    key: \"createMenu\",\n    value: function createMenu() {\n      var wrapper = this.range.getDocument().createElement('div'),\n          ul = this.range.getDocument().createElement('ul');\n      wrapper.className = 'tribute-container';\n      wrapper.setAttribute('aria-expanded','true');\n      ul.setAttribute('id','results');\n      wrapper.appendChild(ul);\n\n      if (this.menuContainer) {\n        return this.menuContainer.appendChild(wrapper);\n      }\n\n      return this.range.getDocument().body.appendChild(wrapper);\n    }\n  }, {\n    key: \"showMenuFor\",\n    value: function showMenuFor(element, scrollTo) {\n      var _this2 = this;\n\n      // Only proceed if menu isn't already shown for the current element & mentionText\n      if (this.isActive && this.current.element === element && this.current.mentionText === this.currentMentionTextSnapshot) {\n        return;\n      }\n\n      this.currentMentionTextSnapshot = this.current.mentionText; // create the menu if it doesn't exist.\n\n      if (!this.menu) {\n        this.menu = this.createMenu();\n        element.tributeMenu = this.menu;\n        this.menuEvents.bind(this.menu);\n      }\n\n      this.isActive = true;\n      this.menuSelected = 0;\n\n      if (!this.current.mentionText) {\n        this.current.mentionText = '';\n      }\n\n      var processValues = function processValues(values) {\n        // Tribute may not be active any more by the time the value callback returns\n        if (!_this2.isActive) {\n          return;\n        }\n\n        var items = _this2.search.filter(_this2.current.mentionText, values, {\n          pre: _this2.current.collection.searchOpts.pre || '<span>',\n          post: _this2.current.collection.searchOpts.post || '</span>',\n          skip: _this2.current.collection.searchOpts.skip,\n          extract: function extract(el) {\n            if (typeof _this2.current.collection.lookup === 'string') {\n              return el[_this2.current.collection.lookup];\n            } else if (typeof _this2.current.collection.lookup === 'function') {\n              return _this2.current.collection.lookup(el, _this2.current.mentionText);\n            } else {\n              throw new Error('Invalid lookup attribute, lookup must be string or function.');\n            }\n          }\n        });\n\n        if (_this2.current.collection.menuItemLimit) {\n          items = items.slice(0, _this2.current.collection.menuItemLimit);\n        }\n\n        _this2.current.filteredItems = items;\n\n        var ul = _this2.menu.querySelector('ul');\n\n        _this2.range.positionMenuAtCaret(scrollTo);\n\n        if (!items.length) {\n          var noMatchEvent = new CustomEvent('tribute-no-match', {\n            detail: _this2.menu\n          });\n\n          _this2.current.element.dispatchEvent(noMatchEvent);\n\n          if (typeof _this2.current.collection.noMatchTemplate === 'function' && !_this2.current.collection.noMatchTemplate() || !_this2.current.collection.noMatchTemplate) {\n            _this2.hideMenu();\n          } else {\n            typeof _this2.current.collection.noMatchTemplate === 'function' ? ul.innerHTML = _this2.current.collection.noMatchTemplate() : ul.innerHTML = _this2.current.collection.noMatchTemplate;\n          }\n\n          return;\n        }\n\n        ul.innerHTML = '';\n\n        var fragment = _this2.range.getDocument().createDocumentFragment();\n\n        items.forEach(function (item, index) {\n          var li = _this2.range.getDocument().createElement('li');\n          li.setAttribute('role', 'option');\n          li.setAttribute('data-index', index);\n          li.addEventListener('mousemove', function (e) {\n            var _this2$_findLiTarget = _this2._findLiTarget(e.target),\n                _this2$_findLiTarget2 = _slicedToArray(_this2$_findLiTarget, 2),\n                li = _this2$_findLiTarget2[0],\n                index = _this2$_findLiTarget2[1];\n\n            if (e.movementY !== 0) {\n              _this2.events.setActiveLi(index);\n            }\n          });\n\n          if (_this2.menuSelected === index) {\n            li.className = _this2.current.collection.selectClass;\n          }\n\n          li.innerHTML = _this2.current.collection.menuItemTemplate(item);\n          fragment.appendChild(li);\n        });\n        ul.appendChild(fragment);\n      };\n\n      if (typeof this.current.collection.values === 'function') {\n        this.current.collection.values(this.current.mentionText, processValues);\n      } else {\n        processValues(this.current.collection.values);\n      }\n    }\n  }, {\n    key: \"_findLiTarget\",\n    value: function _findLiTarget(el) {\n      if (!el) return [];\n      var index = el.getAttribute('data-index');\n      return !index ? this._findLiTarget(el.parentNode) : [el, index];\n    }\n  }, {\n    key: \"showMenuForCollection\",\n    value: function showMenuForCollection(element, collectionIndex) {\n      if (element !== document.activeElement) {\n        this.placeCaretAtEnd(element);\n      }\n\n      this.current.collection = this.collection[collectionIndex || 0];\n      this.current.externalTrigger = true;\n      this.current.element = element;\n      if (element.isContentEditable) this.insertTextAtCursor(this.current.collection.trigger);else this.insertAtCaret(element, this.current.collection.trigger);\n      this.showMenuFor(element);\n    } // TODO: make sure this works for inputs/textareas\n\n  }, {\n    key: \"placeCaretAtEnd\",\n    value: function placeCaretAtEnd(el) {\n      el.focus();\n\n      if (typeof window.getSelection != \"undefined\" && typeof document.createRange != \"undefined\") {\n        var range = document.createRange();\n        range.selectNodeContents(el);\n        range.collapse(false);\n        var sel = window.getSelection();\n        sel.removeAllRanges();\n        sel.addRange(range);\n      } else if (typeof document.body.createTextRange != \"undefined\") {\n        var textRange = document.body.createTextRange();\n        textRange.moveToElementText(el);\n        textRange.collapse(false);\n        textRange.select();\n      }\n    } // for contenteditable\n\n  }, {\n    key: \"insertTextAtCursor\",\n    value: function insertTextAtCursor(text) {\n      var sel, range, html;\n      sel = window.getSelection();\n      range = sel.getRangeAt(0);\n      range.deleteContents();\n      var textNode = document.createTextNode(text);\n      range.insertNode(textNode);\n      range.selectNodeContents(textNode);\n      range.collapse(false);\n      sel.removeAllRanges();\n      sel.addRange(range);\n    } // for regular inputs\n\n  }, {\n    key: \"insertAtCaret\",\n    value: function insertAtCaret(textarea, text) {\n      var scrollPos = textarea.scrollTop;\n      var caretPos = textarea.selectionStart;\n      var front = textarea.value.substring(0, caretPos);\n      var back = textarea.value.substring(textarea.selectionEnd, textarea.value.length);\n      textarea.value = front + text + back;\n      caretPos = caretPos + text.length;\n      textarea.selectionStart = caretPos;\n      textarea.selectionEnd = caretPos;\n      textarea.focus();\n      textarea.scrollTop = scrollPos;\n    }\n  }, {\n    key: \"hideMenu\",\n    value: function hideMenu() {\n      if (this.menu) {\n        this.menu.style.cssText = 'display: none;';\n        this.isActive = false;\n        this.menuSelected = 0;\n        this.current = {};\n      }\n    }\n  }, {\n    key: \"selectItemAtIndex\",\n    value: function selectItemAtIndex(index, originalEvent) {\n      index = parseInt(index);\n      if (typeof index !== 'number' || isNaN(index)) return;\n      var item = this.current.filteredItems[index];\n      var content = this.current.collection.selectTemplate(item);\n      if (content !== null) this.replaceText(content, originalEvent, item);\n    }\n  }, {\n    key: \"replaceText\",\n    value: function replaceText(content, originalEvent, item) {\n      this.range.replaceTriggerText(content, true, true, originalEvent, item);\n    }\n  }, {\n    key: \"_append\",\n    value: function _append(collection, newValues, replace) {\n      if (typeof collection.values === 'function') {\n        throw new Error('Unable to append to values, as it is a function.');\n      } else if (!replace) {\n        collection.values = collection.values.concat(newValues);\n      } else {\n        collection.values = newValues;\n      }\n    }\n  }, {\n    key: \"append\",\n    value: function append(collectionIndex, newValues, replace) {\n      var index = parseInt(collectionIndex);\n      if (typeof index !== 'number') throw new Error('please provide an index for the collection to update.');\n      var collection = this.collection[index];\n\n      this._append(collection, newValues, replace);\n    }\n  }, {\n    key: \"appendCurrent\",\n    value: function appendCurrent(newValues, replace) {\n      if (this.isActive) {\n        this._append(this.current.collection, newValues, replace);\n      } else {\n        throw new Error('No active state. Please use append instead and pass an index.');\n      }\n    }\n  }, {\n    key: \"detach\",\n    value: function detach(el) {\n      if (!el) {\n        throw new Error('[Tribute] Must pass in a DOM node or NodeList.');\n      } // Check if it is a jQuery collection\n\n\n      if (typeof jQuery !== 'undefined' && el instanceof jQuery) {\n        el = el.get();\n      } // Is el an Array/Array-like object?\n\n\n      if (el.constructor === NodeList || el.constructor === HTMLCollection || el.constructor === Array) {\n        var length = el.length;\n\n        for (var i = 0; i < length; ++i) {\n          this._detach(el[i]);\n        }\n      } else {\n        this._detach(el);\n      }\n    }\n  }, {\n    key: \"_detach\",\n    value: function _detach(el) {\n      var _this3 = this;\n\n      this.events.unbind(el);\n\n      if (el.tributeMenu) {\n        this.menuEvents.unbind(el.tributeMenu);\n      }\n\n      setTimeout(function () {\n        el.removeAttribute('data-tribute');\n        _this3.isActive = false;\n\n        if (el.tributeMenu) {\n          el.tributeMenu.remove();\n        }\n      });\n    }\n  }], [{\n    key: \"defaultSelectTemplate\",\n    value: function defaultSelectTemplate(item) {\n      if (typeof item === 'undefined') return null;\n\n      if (this.range.isContentEditable(this.current.element)) {\n        return '<span class=\"tribute-mention\">' + (this.current.collection.trigger + item.original[this.current.collection.fillAttr]) + '</span>';\n      }\n\n      return this.current.collection.trigger + item.original[this.current.collection.fillAttr];\n    }\n  }, {\n    key: \"defaultMenuItemTemplate\",\n    value: function defaultMenuItemTemplate(matchItem) {\n      return matchItem.string;\n    }\n  }, {\n    key: \"inputTypes\",\n    value: function inputTypes() {\n      return ['TEXTAREA', 'INPUT'];\n    }\n  }]);\n\n  return Tribute;\n}();\n\nvar _default = Tribute;\nexports[\"default\"] = _default;\nmodule.exports = exports.default;\n\n},{\"./TributeEvents\":2,\"./TributeMenuEvents\":3,\"./TributeRange\":4,\"./TributeSearch\":5,\"./utils\":7}],2:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nvar TributeEvents =\n/*#__PURE__*/\nfunction () {\n  function TributeEvents(tribute) {\n    _classCallCheck(this, TributeEvents);\n\n    this.tribute = tribute;\n    this.tribute.events = this;\n  }\n\n  _createClass(TributeEvents, [{\n    key: \"bind\",\n    value: function bind(element) {\n      element.boundKeydown = this.keydown.bind(element, this);\n      element.boundKeyup = this.keyup.bind(element, this);\n      element.boundInput = this.input.bind(element, this);\n      element.addEventListener('keydown', element.boundKeydown, false);\n      element.addEventListener('keyup', element.boundKeyup, false);\n      element.addEventListener('input', element.boundInput, false);\n    }\n  }, {\n    key: \"unbind\",\n    value: function unbind(element) {\n      element.removeEventListener('keydown', element.boundKeydown, false);\n      element.removeEventListener('keyup', element.boundKeyup, false);\n      element.removeEventListener('input', element.boundInput, false);\n      delete element.boundKeydown;\n      delete element.boundKeyup;\n      delete element.boundInput;\n    }\n  }, {\n    key: \"keydown\",\n    value: function keydown(instance, event) {\n      if (instance.shouldDeactivate(event)) {\n        instance.tribute.isActive = false;\n        instance.tribute.hideMenu();\n      }\n\n      var element = this;\n      instance.commandEvent = false;\n      TributeEvents.keys().forEach(function (o) {\n        if (o.key === event.keyCode) {\n          instance.commandEvent = true;\n          instance.callbacks()[o.value.toLowerCase()](event, element);\n        }\n      });\n    }\n  }, {\n    key: \"input\",\n    value: function input(instance, event) {\n      instance.inputEvent = true;\n      instance.keyup.call(this, instance, event);\n    }\n  }, {\n    key: \"click\",\n    value: function click(instance, event) {\n      var tribute = instance.tribute;\n\n      if (tribute.menu && tribute.menu.contains(event.target)) {\n        var li = event.target;\n        event.preventDefault();\n        event.stopPropagation();\n\n        while (li.nodeName.toLowerCase() !== 'li') {\n          li = li.parentNode;\n\n          if (!li || li === tribute.menu) {\n            throw new Error('cannot find the <li> container for the click');\n          }\n        }\n\n        if (li.getElementsByClassName(\"disabled-tribute-element\")[0]==undefined){\n          tribute.selectItemAtIndex(li.getAttribute('data-index'), event);\n          tribute.hideMenu(); // TODO: should fire with externalTrigger and target is outside of menu\n        }\n      } else if (tribute.current.element && !tribute.current.externalTrigger) {\n        tribute.current.externalTrigger = false;\n        setTimeout(function () {\n          return tribute.hideMenu();\n        });\n      }\n    }\n  }, {\n    key: \"keyup\",\n    value: function keyup(instance, event) {\n      if (instance.inputEvent) {\n        instance.inputEvent = false;\n      }\n\n      instance.updateSelection(this);\n      if (event.keyCode === 27) return;\n\n      if (!instance.tribute.allowSpaces && instance.tribute.hasTrailingSpace) {\n        instance.tribute.hasTrailingSpace = false;\n        instance.commandEvent = true;\n        instance.callbacks()[\"space\"](event, this);\n        return;\n      }\n\n      if (!instance.tribute.isActive) {\n        if (instance.tribute.autocompleteMode) {\n          instance.callbacks().triggerChar(event, this, '');\n        } else {\n          var keyCode = instance.getKeyCode(instance, this, event);\n          if (isNaN(keyCode) || !keyCode) return;\n          var trigger = instance.tribute.triggers().find(function (trigger) {\n            return trigger.charCodeAt(0) === keyCode;\n          });\n\n          if (typeof trigger !== 'undefined') {\n            instance.callbacks().triggerChar(event, this, trigger);\n          }\n        }\n      }\n\n      if ((instance.tribute.current.trigger || instance.tribute.autocompleteMode) && instance.commandEvent === false || instance.tribute.isActive && event.keyCode === 8) {\n        instance.tribute.showMenuFor(this, true);\n      }\n    }\n  }, {\n    key: \"shouldDeactivate\",\n    value: function shouldDeactivate(event) {\n      if (!this.tribute.isActive) return false;\n\n      if (this.tribute.current.mentionText.length === 0) {\n        var eventKeyPressed = false;\n        TributeEvents.keys().forEach(function (o) {\n          if (event.keyCode === o.key) eventKeyPressed = true;\n        });\n        return !eventKeyPressed;\n      }\n\n      return false;\n    }\n  }, {\n    key: \"getKeyCode\",\n    value: function getKeyCode(instance, el, event) {\n      var _char;\n\n      var tribute = instance.tribute;\n      var info = tribute.range.getTriggerInfo(false, tribute.hasTrailingSpace, true, tribute.allowSpaces, tribute.autocompleteMode);\n\n      if (info) {\n        return info.mentionTriggerChar.charCodeAt(0);\n      } else {\n        return false;\n      }\n    }\n  }, {\n    key: \"updateSelection\",\n    value: function updateSelection(el) {\n      this.tribute.current.element = el;\n      var info = this.tribute.range.getTriggerInfo(false, this.tribute.hasTrailingSpace, true, this.tribute.allowSpaces, this.tribute.autocompleteMode);\n\n      if (info) {\n        this.tribute.current.selectedPath = info.mentionSelectedPath;\n        this.tribute.current.mentionText = info.mentionText;\n        this.tribute.current.selectedOffset = info.mentionSelectedOffset;\n      }\n    }\n  }, {\n    key: \"callbacks\",\n    value: function callbacks() {\n      var _this = this;\n\n      return {\n        triggerChar: function triggerChar(e, el, trigger) {\n          var tribute = _this.tribute;\n          tribute.current.trigger = trigger;\n          var collectionItem = tribute.collection.find(function (item) {\n            return item.trigger === trigger;\n          });\n          tribute.current.collection = collectionItem;\n          if (tribute.inputEvent) tribute.showMenuFor(el, true);\n        },\n        enter: function enter(e, el) {\n          // choose selection\n          if (_this.tribute.isActive && _this.tribute.current.filteredItems) {\n            e.preventDefault();\n            e.stopPropagation();\n            setTimeout(function () {\n              _this.tribute.selectItemAtIndex(_this.tribute.menuSelected, e);\n\n              _this.tribute.hideMenu();\n            }, 0);\n          }\n        },\n        escape: function escape(e, el) {\n          if (_this.tribute.isActive) {\n            e.preventDefault();\n            e.stopPropagation();\n            _this.tribute.isActive = false;\n\n            _this.tribute.hideMenu();\n          }\n        },\n        tab: function tab(e, el) {\n          // choose first match\n          _this.callbacks().enter(e, el);\n        },\n        space: function space(e, el) {\n          if (_this.tribute.isActive) {\n            if (_this.tribute.spaceSelectsMatch) {\n              _this.callbacks().enter(e, el);\n            } else if (!_this.tribute.allowSpaces) {\n              e.stopPropagation();\n              setTimeout(function () {\n                _this.tribute.hideMenu();\n\n                _this.tribute.isActive = false;\n              }, 0);\n            }\n          }\n        },\n        up: function up(e, el) {\n          // navigate up ul\n          if (_this.tribute.isActive && _this.tribute.current.filteredItems) {\n            e.preventDefault();\n            e.stopPropagation();\n            var count = _this.tribute.current.filteredItems.length,\n                selected = _this.tribute.menuSelected;\n\n            if (count > selected && selected > 0) {\n              _this.tribute.menuSelected--;\n\n              _this.setActiveLi();\n            } else if (selected === 0) {\n              _this.tribute.menuSelected = count - 1;\n\n              _this.setActiveLi();\n\n              _this.tribute.menu.scrollTop = _this.tribute.menu.scrollHeight;\n            }\n          }\n        },\n        down: function down(e, el) {\n          // navigate down ul\n          if (_this.tribute.isActive && _this.tribute.current.filteredItems) {\n            e.preventDefault();\n            e.stopPropagation();\n            var count = _this.tribute.current.filteredItems.length - 1,\n                selected = _this.tribute.menuSelected;\n\n            if (count > selected) {\n              _this.tribute.menuSelected++;\n\n              _this.setActiveLi();\n            } else if (count === selected) {\n              _this.tribute.menuSelected = 0;\n\n              _this.setActiveLi();\n\n              _this.tribute.menu.scrollTop = 0;\n            }\n          }\n        },\n        \"delete\": function _delete(e, el) {\n          if (_this.tribute.isActive && _this.tribute.current.mentionText.length < 1) {\n            _this.tribute.hideMenu();\n          } else if (_this.tribute.isActive) {\n            _this.tribute.showMenuFor(el);\n          }\n        }\n      };\n    }\n  }, {\n    key: \"setActiveLi\",\n    value: function setActiveLi(index) {\n      var lis = this.tribute.menu.querySelectorAll('li'),\n          length = lis.length >>> 0;\n      if (index) this.tribute.menuSelected = parseInt(index);\n\n      for (var i = 0; i < length; i++) {\n        var li = lis[i];\n\n        if (i === this.tribute.menuSelected) {\n          li.classList.add(this.tribute.current.collection.selectClass);\n          var liClientRect = li.getBoundingClientRect();\n          var menuClientRect = this.tribute.menu.getBoundingClientRect();\n\n          if (liClientRect.bottom > menuClientRect.bottom) {\n            var scrollDistance = liClientRect.bottom - menuClientRect.bottom;\n            this.tribute.menu.scrollTop += scrollDistance;\n          } else if (liClientRect.top < menuClientRect.top) {\n            var _scrollDistance = menuClientRect.top - liClientRect.top;\n\n            this.tribute.menu.scrollTop -= _scrollDistance;\n          }\n        } else {\n          li.classList.remove(this.tribute.current.collection.selectClass);\n        }\n      }\n    }\n  }, {\n    key: \"getFullHeight\",\n    value: function getFullHeight(elem, includeMargin) {\n      var height = elem.getBoundingClientRect().height;\n\n      if (includeMargin) {\n        var style = elem.currentStyle || window.getComputedStyle(elem);\n        return height + parseFloat(style.marginTop) + parseFloat(style.marginBottom);\n      }\n\n      return height;\n    }\n  }], [{\n    key: \"keys\",\n    value: function keys() {\n      return [{\n        key: 9,\n        value: 'TAB'\n      }, {\n        key: 8,\n        value: 'DELETE'\n      }, {\n        key: 13,\n        value: 'ENTER'\n      }, {\n        key: 27,\n        value: 'ESCAPE'\n      }, {\n        key: 32,\n        value: 'SPACE'\n      }, {\n        key: 38,\n        value: 'UP'\n      }, {\n        key: 40,\n        value: 'DOWN'\n      }];\n    }\n  }]);\n\n  return TributeEvents;\n}();\n\nvar _default = TributeEvents;\nexports[\"default\"] = _default;\nmodule.exports = exports.default;\n\n},{}],3:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nvar TributeMenuEvents =\n/*#__PURE__*/\nfunction () {\n  function TributeMenuEvents(tribute) {\n    _classCallCheck(this, TributeMenuEvents);\n\n    this.tribute = tribute;\n    this.tribute.menuEvents = this;\n    this.menu = this.tribute.menu;\n  }\n\n  _createClass(TributeMenuEvents, [{\n    key: \"bind\",\n    value: function bind(menu) {\n      var _this = this;\n\n      this.menuClickEvent = this.tribute.events.click.bind(null, this);\n      this.menuContainerScrollEvent = this.debounce(function () {\n        if (_this.tribute.isActive) {\n          _this.tribute.showMenuFor(_this.tribute.current.element, false);\n        }\n      }, 300, false);\n      this.windowResizeEvent = this.debounce(function () {\n        if (_this.tribute.isActive) {\n          _this.tribute.range.positionMenuAtCaret(true);\n        }\n      }, 300, false); // fixes IE11 issues with mousedown\n\n      this.tribute.range.getDocument().addEventListener('MSPointerDown', this.menuClickEvent, false);\n      this.tribute.range.getDocument().addEventListener('mousedown', this.menuClickEvent, false);\n      window.addEventListener('resize', this.windowResizeEvent);\n\n      if (this.menuContainer) {\n        this.menuContainer.addEventListener('scroll', this.menuContainerScrollEvent, false);\n      } else {\n        window.addEventListener('scroll', this.menuContainerScrollEvent);\n      }\n    }\n  }, {\n    key: \"unbind\",\n    value: function unbind(menu) {\n      this.tribute.range.getDocument().removeEventListener('mousedown', this.menuClickEvent, false);\n      this.tribute.range.getDocument().removeEventListener('MSPointerDown', this.menuClickEvent, false);\n      window.removeEventListener('resize', this.windowResizeEvent);\n\n      if (this.menuContainer) {\n        this.menuContainer.removeEventListener('scroll', this.menuContainerScrollEvent, false);\n      } else {\n        window.removeEventListener('scroll', this.menuContainerScrollEvent);\n      }\n    }\n  }, {\n    key: \"debounce\",\n    value: function debounce(func, wait, immediate) {\n      var _this2 = this,\n          _arguments = arguments;\n\n      var timeout;\n      return function () {\n        var context = _this2,\n            args = _arguments;\n\n        var later = function later() {\n          timeout = null;\n          if (!immediate) func.apply(context, args);\n        };\n\n        var callNow = immediate && !timeout;\n        clearTimeout(timeout);\n        timeout = setTimeout(later, wait);\n        if (callNow) func.apply(context, args);\n      };\n    }\n  }]);\n\n  return TributeMenuEvents;\n}();\n\nvar _default = TributeMenuEvents;\nexports[\"default\"] = _default;\nmodule.exports = exports.default;\n\n},{}],4:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\n// Thanks to https://github.com/jeff-collins/ment.io\nvar TributeRange =\n/*#__PURE__*/\nfunction () {\n  function TributeRange(tribute) {\n    _classCallCheck(this, TributeRange);\n\n    this.tribute = tribute;\n    this.tribute.range = this;\n  }\n\n  _createClass(TributeRange, [{\n    key: \"getDocument\",\n    value: function getDocument() {\n      var iframe;\n\n      if (this.tribute.current.collection) {\n        iframe = this.tribute.current.collection.iframe;\n      }\n\n      if (!iframe) {\n        return document;\n      }\n\n      return iframe.contentWindow.document;\n    }\n  }, {\n    key: \"positionMenuAtCaret\",\n    value: function positionMenuAtCaret(scrollTo) {\n      var _this = this;\n\n      var context = this.tribute.current,\n          coordinates;\n      var info = this.getTriggerInfo(false, this.tribute.hasTrailingSpace, true, this.tribute.allowSpaces, this.tribute.autocompleteMode);\n\n      if (typeof info !== 'undefined') {\n        if (!this.tribute.positionMenu) {\n          this.tribute.menu.style.cssText = \"display: block;\";\n          return;\n        }\n\n        if (!this.isContentEditable(context.element)) {\n          coordinates = this.getTextAreaOrInputUnderlinePosition(this.tribute.current.element, info.mentionPosition);\n        } else {\n          coordinates = this.getContentEditableCaretPosition(info.mentionPosition);\n        }\n\n        this.tribute.menu.style.cssText = \"top: \".concat(coordinates.top, \"px;\\n                                     left: \").concat(coordinates.left, \"px;\\n                                     right: \").concat(coordinates.right, \"px;\\n                                     bottom: \").concat(coordinates.bottom, \"px;\\n                                     position: absolute;\\n                                     display: block;\");\n\n        if (coordinates.left === 'auto') {\n          this.tribute.menu.style.left = 'auto';\n        }\n\n        if (coordinates.top === 'auto') {\n          this.tribute.menu.style.top = 'auto';\n        }\n\n        if (scrollTo) this.scrollIntoView();\n        window.setTimeout(function () {\n          var menuDimensions = {\n            width: _this.tribute.menu.offsetWidth,\n            height: _this.tribute.menu.offsetHeight\n          };\n\n          var menuIsOffScreen = _this.isMenuOffScreen(coordinates, menuDimensions);\n\n          var menuIsOffScreenHorizontally = window.innerWidth > menuDimensions.width && (menuIsOffScreen.left || menuIsOffScreen.right);\n          var menuIsOffScreenVertically = window.innerHeight > menuDimensions.height && (menuIsOffScreen.top || menuIsOffScreen.bottom);\n\n          if (menuIsOffScreenHorizontally || menuIsOffScreenVertically) {\n            _this.tribute.menu.style.cssText = 'display: none';\n\n            _this.positionMenuAtCaret(scrollTo);\n          }\n        }, 0);\n      } else {\n        this.tribute.menu.style.cssText = 'display: none';\n      }\n    }\n  }, {\n    key: \"selectElement\",\n    value: function selectElement(targetElement, path, offset) {\n      var range;\n      var elem = targetElement;\n\n      if (path) {\n        for (var i = 0; i < path.length; i++) {\n          elem = elem.childNodes[path[i]];\n\n          if (elem === undefined) {\n            return;\n          }\n\n          while (elem.length < offset) {\n            offset -= elem.length;\n            elem = elem.nextSibling;\n          }\n\n          if (elem.childNodes.length === 0 && !elem.length) {\n            elem = elem.previousSibling;\n          }\n        }\n      }\n\n      var sel = this.getWindowSelection();\n      range = this.getDocument().createRange();\n      range.setStart(elem, offset);\n      range.setEnd(elem, offset);\n      range.collapse(true);\n\n      try {\n        sel.removeAllRanges();\n      } catch (error) {}\n\n      sel.addRange(range);\n      targetElement.focus();\n    }\n  }, {\n    key: \"replaceTriggerText\",\n    value: function replaceTriggerText(text, requireLeadingSpace, hasTrailingSpace, originalEvent, item) {\n      var info = this.getTriggerInfo(true, hasTrailingSpace, requireLeadingSpace, this.tribute.allowSpaces, this.tribute.autocompleteMode);\n\n      if (info !== undefined) {\n        var context = this.tribute.current;\n        var replaceEvent = new CustomEvent('tribute-replaced', {\n          detail: {\n            item: item,\n            instance: context,\n            context: info,\n            event: originalEvent\n          }\n        });\n\n        if (!this.isContentEditable(context.element)) {\n          var myField = this.tribute.current.element;\n          var textSuffix = typeof this.tribute.replaceTextSuffix == 'string' ? this.tribute.replaceTextSuffix : ' ';\n          text += textSuffix;\n          var startPos = info.mentionPosition;\n          var endPos = info.mentionPosition + info.mentionText.length + textSuffix.length;\n          myField.value = myField.value.substring(0, startPos) + text + myField.value.substring(endPos, myField.value.length);\n          myField.selectionStart = startPos + text.length;\n          myField.selectionEnd = startPos + text.length;\n        } else {\n          // add a space to the end of the pasted text\n          var _textSuffix = typeof this.tribute.replaceTextSuffix == 'string' ? this.tribute.replaceTextSuffix : '\\xA0';\n\n          text += _textSuffix;\n          this.pasteHtml(text, info.mentionPosition, info.mentionPosition + info.mentionText.length + !this.tribute.autocompleteMode);\n        }\n\n        context.element.dispatchEvent(replaceEvent);\n      }\n    }\n  }, {\n    key: \"pasteHtml\",\n    value: function pasteHtml(html, startPos, endPos) {\n      var range, sel;\n      sel = this.getWindowSelection();\n      range = this.getDocument().createRange();\n      range.setStart(sel.anchorNode, startPos);\n      range.setEnd(sel.anchorNode, endPos);\n      range.deleteContents();\n      var el = this.getDocument().createElement('div');\n      el.innerHTML = html;\n      var frag = this.getDocument().createDocumentFragment(),\n          node,\n          lastNode;\n\n      while (node = el.firstChild) {\n        lastNode = frag.appendChild(node);\n      }\n\n      range.insertNode(frag); // Preserve the selection\n\n      if (lastNode) {\n        range = range.cloneRange();\n        range.setStartAfter(lastNode);\n        range.collapse(true);\n        sel.removeAllRanges();\n        sel.addRange(range);\n      }\n    }\n  }, {\n    key: \"getWindowSelection\",\n    value: function getWindowSelection() {\n      if (this.tribute.collection.iframe) {\n        return this.tribute.collection.iframe.contentWindow.getSelection();\n      }\n\n      return window.getSelection();\n    }\n  }, {\n    key: \"getNodePositionInParent\",\n    value: function getNodePositionInParent(element) {\n      if (element.parentNode === null) {\n        return 0;\n      }\n\n      for (var i = 0; i < element.parentNode.childNodes.length; i++) {\n        var node = element.parentNode.childNodes[i];\n\n        if (node === element) {\n          return i;\n        }\n      }\n    }\n  }, {\n    key: \"getContentEditableSelectedPath\",\n    value: function getContentEditableSelectedPath(ctx) {\n      var sel = this.getWindowSelection();\n      var selected = sel.anchorNode;\n      var path = [];\n      var offset;\n\n      if (selected != null) {\n        var i;\n        var ce = selected.contentEditable;\n\n        while (selected !== null && ce !== 'true') {\n          i = this.getNodePositionInParent(selected);\n          path.push(i);\n          selected = selected.parentNode;\n\n          if (selected !== null) {\n            ce = selected.contentEditable;\n          }\n        }\n\n        path.reverse(); // getRangeAt may not exist, need alternative\n\n        offset = sel.getRangeAt(0).startOffset;\n        return {\n          selected: selected,\n          path: path,\n          offset: offset\n        };\n      }\n    }\n  }, {\n    key: \"getTextPrecedingCurrentSelection\",\n    value: function getTextPrecedingCurrentSelection() {\n      var context = this.tribute.current,\n          text = '';\n\n      if (!this.isContentEditable(context.element)) {\n        var textComponent = this.tribute.current.element;\n\n        if (textComponent) {\n          var startPos = textComponent.selectionStart;\n\n          if (textComponent.value && startPos >= 0) {\n            text = textComponent.value.substring(0, startPos);\n          }\n        }\n      } else {\n        var selectedElem = this.getWindowSelection().anchorNode;\n\n        if (selectedElem != null) {\n          var workingNodeContent = selectedElem.textContent;\n          var selectStartOffset = this.getWindowSelection().getRangeAt(0).startOffset;\n\n          if (workingNodeContent && selectStartOffset >= 0) {\n            text = workingNodeContent.substring(0, selectStartOffset);\n          }\n        }\n      }\n\n      return text;\n    }\n  }, {\n    key: \"getLastWordInText\",\n    value: function getLastWordInText(text) {\n      text = text.replace(/\\u00A0/g, ' '); // https://stackoverflow.com/questions/29850407/how-do-i-replace-unicode-character-u00a0-with-a-space-in-javascript\n\n      var wordsArray = text.split(/\\s+/);\n      var worldsCount = wordsArray.length - 1;\n      return wordsArray[worldsCount].trim();\n    }\n  }, {\n    key: \"getTriggerInfo\",\n    value: function getTriggerInfo(menuAlreadyActive, hasTrailingSpace, requireLeadingSpace, allowSpaces, isAutocomplete) {\n      var _this2 = this;\n\n      var ctx = this.tribute.current;\n      var selected, path, offset;\n\n      if (!this.isContentEditable(ctx.element)) {\n        selected = this.tribute.current.element;\n      } else {\n        var selectionInfo = this.getContentEditableSelectedPath(ctx);\n\n        if (selectionInfo) {\n          selected = selectionInfo.selected;\n          path = selectionInfo.path;\n          offset = selectionInfo.offset;\n        }\n      }\n\n      var effectiveRange = this.getTextPrecedingCurrentSelection();\n      var lastWordOfEffectiveRange = this.getLastWordInText(effectiveRange);\n\n      if (isAutocomplete) {\n        return {\n          mentionPosition: effectiveRange.length - lastWordOfEffectiveRange.length,\n          mentionText: lastWordOfEffectiveRange,\n          mentionSelectedElement: selected,\n          mentionSelectedPath: path,\n          mentionSelectedOffset: offset\n        };\n      }\n\n      if (effectiveRange !== undefined && effectiveRange !== null) {\n        var mostRecentTriggerCharPos = -1;\n        var triggerChar;\n        this.tribute.collection.forEach(function (config) {\n          var c = config.trigger;\n          var idx = config.requireLeadingSpace ? _this2.lastIndexWithLeadingSpace(effectiveRange, c) : effectiveRange.lastIndexOf(c);\n\n          if (idx > mostRecentTriggerCharPos) {\n            mostRecentTriggerCharPos = idx;\n            triggerChar = c;\n            requireLeadingSpace = config.requireLeadingSpace;\n          }\n        });\n\n        if (mostRecentTriggerCharPos >= 0 && (mostRecentTriggerCharPos === 0 || !requireLeadingSpace || /[\\xA0\\s]/g.test(effectiveRange.substring(mostRecentTriggerCharPos - 1, mostRecentTriggerCharPos)))) {\n          var currentTriggerSnippet = effectiveRange.substring(mostRecentTriggerCharPos + 1, effectiveRange.length);\n          triggerChar = effectiveRange.substring(mostRecentTriggerCharPos, mostRecentTriggerCharPos + 1);\n          var firstSnippetChar = currentTriggerSnippet.substring(0, 1);\n          var leadingSpace = currentTriggerSnippet.length > 0 && (firstSnippetChar === ' ' || firstSnippetChar === '\\xA0');\n\n          if (hasTrailingSpace) {\n            currentTriggerSnippet = currentTriggerSnippet.trim();\n          }\n\n          var regex = allowSpaces ? /[^\\S ]/g : /[\\xA0\\s]/g;\n          this.tribute.hasTrailingSpace = regex.test(currentTriggerSnippet);\n\n          if (!leadingSpace && (menuAlreadyActive || !regex.test(currentTriggerSnippet))) {\n            return {\n              mentionPosition: mostRecentTriggerCharPos,\n              mentionText: currentTriggerSnippet,\n              mentionSelectedElement: selected,\n              mentionSelectedPath: path,\n              mentionSelectedOffset: offset,\n              mentionTriggerChar: triggerChar\n            };\n          }\n        }\n      }\n    }\n  }, {\n    key: \"lastIndexWithLeadingSpace\",\n    value: function lastIndexWithLeadingSpace(str, _char) {\n      var reversedStr = str.split('').reverse().join('');\n      var index = -1;\n\n      for (var cidx = 0, len = str.length; cidx < len; cidx++) {\n        var firstChar = cidx === str.length - 1;\n        var leadingSpace = /\\s/.test(reversedStr[cidx + 1]);\n        var match = _char === reversedStr[cidx];\n\n        if (match && (firstChar || leadingSpace)) {\n          index = str.length - 1 - cidx;\n          break;\n        }\n      }\n\n      return index;\n    }\n  }, {\n    key: \"isContentEditable\",\n    value: function isContentEditable(element) {\n      return element.nodeName !== 'INPUT' && element.nodeName !== 'TEXTAREA';\n    }\n  }, {\n    key: \"isMenuOffScreen\",\n    value: function isMenuOffScreen(coordinates, menuDimensions) {\n      var windowWidth = window.innerWidth;\n      var windowHeight = window.innerHeight;\n      var doc = document.documentElement;\n      var windowLeft = (window.pageXOffset || doc.scrollLeft) - (doc.clientLeft || 0);\n      var windowTop = (window.pageYOffset || doc.scrollTop) - (doc.clientTop || 0);\n      var menuTop = typeof coordinates.top === 'number' ? coordinates.top : windowTop + windowHeight - coordinates.bottom - menuDimensions.height;\n      var menuRight = typeof coordinates.right === 'number' ? coordinates.right : coordinates.left + menuDimensions.width;\n      var menuBottom = typeof coordinates.bottom === 'number' ? coordinates.bottom : coordinates.top + menuDimensions.height;\n      var menuLeft = typeof coordinates.left === 'number' ? coordinates.left : windowLeft + windowWidth - coordinates.right - menuDimensions.width;\n      return {\n        top: menuTop < Math.floor(windowTop),\n        right: menuRight > Math.ceil(windowLeft + windowWidth),\n        bottom: menuBottom > Math.ceil(windowTop + windowHeight),\n        left: menuLeft < Math.floor(windowLeft)\n      };\n    }\n  }, {\n    key: \"getMenuDimensions\",\n    value: function getMenuDimensions() {\n      // Width of the menu depends of its contents and position\n      // We must check what its width would be without any obstruction\n      // This way, we can achieve good positioning for flipping the menu\n      var dimensions = {\n        width: null,\n        height: null\n      };\n      this.tribute.menu.style.cssText = \"top: 0px;\\n                                 left: 0px;\\n                                 position: fixed;\\n                                 display: block;\\n                                 visibility; hidden;\";\n      dimensions.width = this.tribute.menu.offsetWidth;\n      dimensions.height = this.tribute.menu.offsetHeight;\n      this.tribute.menu.style.cssText = \"display: none;\";\n      return dimensions;\n    }\n  }, {\n    key: \"getTextAreaOrInputUnderlinePosition\",\n    value: function getTextAreaOrInputUnderlinePosition(element, position, flipped) {\n      var properties = ['direction', 'boxSizing', 'width', 'height', 'overflowX', 'overflowY', 'borderTopWidth', 'borderRightWidth', 'borderBottomWidth', 'borderLeftWidth', 'paddingTop', 'paddingRight', 'paddingBottom', 'paddingLeft', 'fontStyle', 'fontVariant', 'fontWeight', 'fontStretch', 'fontSize', 'fontSizeAdjust', 'lineHeight', 'fontFamily', 'textAlign', 'textTransform', 'textIndent', 'textDecoration', 'letterSpacing', 'wordSpacing'];\n      var isFirefox = window.mozInnerScreenX !== null;\n      var div = this.getDocument().createElement('div');\n      div.id = 'input-textarea-caret-position-mirror-div';\n      this.getDocument().body.appendChild(div);\n      var style = div.style;\n      var computed = window.getComputedStyle ? getComputedStyle(element) : element.currentStyle;\n      style.whiteSpace = 'pre-wrap';\n\n      if (element.nodeName !== 'INPUT') {\n        style.wordWrap = 'break-word';\n      } // position off-screen\n\n\n      style.position = 'absolute';\n      style.visibility = 'hidden'; // transfer the element's properties to the div\n\n      properties.forEach(function (prop) {\n        style[prop] = computed[prop];\n      });\n\n      if (isFirefox) {\n        style.width = \"\".concat(parseInt(computed.width) - 2, \"px\");\n        if (element.scrollHeight > parseInt(computed.height)) style.overflowY = 'scroll';\n      } else {\n        style.overflow = 'hidden';\n      }\n\n      div.textContent = element.value.substring(0, position);\n\n      if (element.nodeName === 'INPUT') {\n        div.textContent = div.textContent.replace(/\\s/g, ' ');\n      }\n\n      var span = this.getDocument().createElement('span');\n      span.textContent = element.value.substring(position) || '.';\n      div.appendChild(span);\n      var rect = element.getBoundingClientRect();\n      var doc = document.documentElement;\n      var windowLeft = (window.pageXOffset || doc.scrollLeft) - (doc.clientLeft || 0);\n      var windowTop = (window.pageYOffset || doc.scrollTop) - (doc.clientTop || 0);\n      var top = 0;\n      var left = 0;\n\n      if (this.menuContainerIsBody) {\n        top = rect.top;\n        left = rect.left;\n      }\n\n      var coordinates = {\n        top: top + windowTop + span.offsetTop + parseInt(computed.borderTopWidth) + parseInt(computed.fontSize) - element.scrollTop,\n        left: left + windowLeft + span.offsetLeft + parseInt(computed.borderLeftWidth)\n      };\n      var windowWidth = window.innerWidth;\n      var windowHeight = window.innerHeight;\n      var menuDimensions = this.getMenuDimensions();\n      var menuIsOffScreen = this.isMenuOffScreen(coordinates, menuDimensions);\n\n      if (menuIsOffScreen.right) {\n        coordinates.right = windowWidth - coordinates.left;\n        coordinates.left = 'auto';\n      }\n\n      var parentHeight = this.tribute.menuContainer ? this.tribute.menuContainer.offsetHeight : this.getDocument().body.offsetHeight;\n\n      if (menuIsOffScreen.bottom) {\n        var parentRect = this.tribute.menuContainer ? this.tribute.menuContainer.getBoundingClientRect() : this.getDocument().body.getBoundingClientRect();\n        var scrollStillAvailable = parentHeight - (windowHeight - parentRect.top);\n        coordinates.bottom = scrollStillAvailable + (windowHeight - rect.top - span.offsetTop);\n        coordinates.top = 'auto';\n      }\n\n      menuIsOffScreen = this.isMenuOffScreen(coordinates, menuDimensions);\n\n      if (menuIsOffScreen.left) {\n        coordinates.left = windowWidth > menuDimensions.width ? windowLeft + windowWidth - menuDimensions.width : windowLeft;\n        delete coordinates.right;\n      }\n\n      if (menuIsOffScreen.top) {\n        coordinates.top = windowHeight > menuDimensions.height ? windowTop + windowHeight - menuDimensions.height : windowTop;\n        delete coordinates.bottom;\n      }\n\n      this.getDocument().body.removeChild(div);\n      return coordinates;\n    }\n  }, {\n    key: \"getContentEditableCaretPosition\",\n    value: function getContentEditableCaretPosition(selectedNodePosition) {\n      var markerTextChar = '';\n      var markerEl,\n          markerId = \"sel_\".concat(new Date().getTime(), \"_\").concat(Math.random().toString().substr(2));\n      var range;\n      var sel = this.getWindowSelection();\n      var prevRange = sel.getRangeAt(0);\n      range = this.getDocument().createRange();\n      range.setStart(sel.anchorNode, selectedNodePosition);\n      range.setEnd(sel.anchorNode, selectedNodePosition);\n      range.collapse(false); // Create the marker element containing a single invisible character using DOM methods and insert it\n\n      markerEl = this.getDocument().createElement('span');\n      markerEl.id = markerId;\n      markerEl.appendChild(this.getDocument().createTextNode(markerTextChar));\n      range.insertNode(markerEl);\n      sel.removeAllRanges();\n      sel.addRange(prevRange);\n      var rect = markerEl.getBoundingClientRect();\n      var doc = document.documentElement;\n      var windowLeft = (window.pageXOffset || doc.scrollLeft) - (doc.clientLeft || 0);\n      var windowTop = (window.pageYOffset || doc.scrollTop) - (doc.clientTop || 0);\n      var left = 0;\n      var top = 0;\n\n      if (this.menuContainerIsBody) {\n        left = rect.left;\n        top = rect.top;\n      } else {\n        left = markerEl.offsetLeft;\n        top = markerEl.offsetTop;\n      }\n\n      var coordinates = {\n        left: left + windowLeft,\n        top: top + markerEl.offsetHeight + windowTop\n      };\n      var windowWidth = window.innerWidth;\n      var windowHeight = window.innerHeight;\n      var menuDimensions = this.getMenuDimensions();\n      var menuIsOffScreen = this.isMenuOffScreen(coordinates, menuDimensions);\n\n      if (menuIsOffScreen.right) {\n        coordinates.left = 'auto';\n        coordinates.right = windowWidth - rect.left - windowLeft;\n      }\n\n      var parentHeight = this.tribute.menuContainer ? this.tribute.menuContainer.offsetHeight : this.getDocument().body.offsetHeight;\n\n      if (menuIsOffScreen.bottom) {\n        var parentRect = this.tribute.menuContainer ? this.tribute.menuContainer.getBoundingClientRect() : this.getDocument().body.getBoundingClientRect();\n        var scrollStillAvailable = parentHeight - (windowHeight - parentRect.top);\n        coordinates.top = 'auto';\n        coordinates.bottom = scrollStillAvailable + (windowHeight - rect.top);\n      }\n\n      menuIsOffScreen = this.isMenuOffScreen(coordinates, menuDimensions);\n\n      if (menuIsOffScreen.left) {\n        coordinates.left = windowWidth > menuDimensions.width ? windowLeft + windowWidth - menuDimensions.width : windowLeft;\n        delete coordinates.right;\n      }\n\n      if (menuIsOffScreen.top) {\n        coordinates.top = windowHeight > menuDimensions.height ? windowTop + windowHeight - menuDimensions.height : windowTop;\n        delete coordinates.bottom;\n      }\n\n      markerEl.parentNode.removeChild(markerEl);\n      return coordinates;\n    }\n  }, {\n    key: \"scrollIntoView\",\n    value: function scrollIntoView(elem) {\n      var reasonableBuffer = 20,\n          clientRect;\n      var maxScrollDisplacement = 100;\n      var e = this.menu;\n      if (typeof e === 'undefined') return;\n\n      while (clientRect === undefined || clientRect.height === 0) {\n        clientRect = e.getBoundingClientRect();\n\n        if (clientRect.height === 0) {\n          e = e.childNodes[0];\n\n          if (e === undefined || !e.getBoundingClientRect) {\n            return;\n          }\n        }\n      }\n\n      var elemTop = clientRect.top;\n      var elemBottom = elemTop + clientRect.height;\n\n      if (elemTop < 0) {\n        window.scrollTo(0, window.pageYOffset + clientRect.top - reasonableBuffer);\n      } else if (elemBottom > window.innerHeight) {\n        var maxY = window.pageYOffset + clientRect.top - reasonableBuffer;\n\n        if (maxY - window.pageYOffset > maxScrollDisplacement) {\n          maxY = window.pageYOffset + maxScrollDisplacement;\n        }\n\n        var targetY = window.pageYOffset - (window.innerHeight - elemBottom);\n\n        if (targetY > maxY) {\n          targetY = maxY;\n        }\n\n        window.scrollTo(0, targetY);\n      }\n    }\n  }, {\n    key: \"menuContainerIsBody\",\n    get: function get() {\n      return this.tribute.menuContainer === document.body || !this.tribute.menuContainer;\n    }\n  }]);\n\n  return TributeRange;\n}();\n\nvar _default = TributeRange;\nexports[\"default\"] = _default;\nmodule.exports = exports.default;\n\n},{}],5:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\n// Thanks to https://github.com/mattyork/fuzzy\nvar TributeSearch =\n/*#__PURE__*/\nfunction () {\n  function TributeSearch(tribute) {\n    _classCallCheck(this, TributeSearch);\n\n    this.tribute = tribute;\n    this.tribute.search = this;\n  }\n\n  _createClass(TributeSearch, [{\n    key: \"simpleFilter\",\n    value: function simpleFilter(pattern, array) {\n      var _this = this;\n\n      return array.filter(function (string) {\n        return _this.test(pattern, string);\n      });\n    }\n  }, {\n    key: \"test\",\n    value: function test(pattern, string) {\n      return this.match(pattern, string) !== null;\n    }\n  }, {\n    key: \"match\",\n    value: function match(pattern, string, opts) {\n      opts = opts || {};\n      var patternIdx = 0,\n          result = [],\n          len = string.length,\n          totalScore = 0,\n          currScore = 0,\n          pre = opts.pre || '',\n          post = opts.post || '',\n          compareString = opts.caseSensitive && string || string.toLowerCase(),\n          ch,\n          compareChar;\n\n      if (opts.skip) {\n        return {\n          rendered: string,\n          score: 0\n        };\n      }\n\n      pattern = opts.caseSensitive && pattern || pattern.toLowerCase();\n      var patternCache = this.traverse(compareString, pattern, 0, 0, []);\n\n      if (!patternCache) {\n        return null;\n      }\n\n      return {\n        rendered: this.render(string, patternCache.cache, pre, post),\n        score: patternCache.score\n      };\n    }\n  }, {\n    key: \"traverse\",\n    value: function traverse(string, pattern, stringIndex, patternIndex, patternCache) {\n      // if the pattern search at end\n      if (pattern.length === patternIndex) {\n        // calculate score and copy the cache containing the indices where it's found\n        return {\n          score: this.calculateScore(patternCache),\n          cache: patternCache.slice()\n        };\n      } // if string at end or remaining pattern > remaining string\n\n\n      if (string.length === stringIndex || pattern.length - patternIndex > string.length - stringIndex) {\n        return undefined;\n      }\n\n      var c = pattern[patternIndex];\n      var index = string.indexOf(c, stringIndex);\n      var best, temp;\n\n      while (index > -1) {\n        patternCache.push(index);\n        temp = this.traverse(string, pattern, index + 1, patternIndex + 1, patternCache);\n        patternCache.pop(); // if downstream traversal failed, return best answer so far\n\n        if (!temp) {\n          return best;\n        }\n\n        if (!best || best.score < temp.score) {\n          best = temp;\n        }\n\n        index = string.indexOf(c, index + 1);\n      }\n\n      return best;\n    }\n  }, {\n    key: \"calculateScore\",\n    value: function calculateScore(patternCache) {\n      var score = 0;\n      var temp = 1;\n      patternCache.forEach(function (index, i) {\n        if (i > 0) {\n          if (patternCache[i - 1] + 1 === index) {\n            temp += temp + 1;\n          } else {\n            temp = 1;\n          }\n        }\n\n        score += temp;\n      });\n      return score;\n    }\n  }, {\n    key: \"render\",\n    value: function render(string, indices, pre, post) {\n      var rendered = string.substring(0, indices[0]);\n      indices.forEach(function (index, i) {\n        rendered += pre + string[index] + post + string.substring(index + 1, indices[i + 1] ? indices[i + 1] : string.length);\n      });\n      return rendered;\n    }\n  }, {\n    key: \"filter\",\n    value: function filter(pattern, arr, opts) {\n      var _this2 = this;\n\n      opts = opts || {};\n      return arr.reduce(function (prev, element, idx, arr) {\n        var str = element;\n\n        if (opts.extract) {\n          str = opts.extract(element);\n\n          if (!str) {\n            // take care of undefineds / nulls / etc.\n            str = '';\n          }\n        }\n\n        var rendered = _this2.match(pattern, str, opts);\n\n        if (rendered != null) {\n          prev[prev.length] = {\n            string: rendered.rendered,\n            score: rendered.score,\n            index: idx,\n            original: element\n          };\n        }\n\n        return prev;\n      }, []).sort(function (a, b) {\n        var compare = b.score - a.score;\n        if (compare) return compare;\n        return a.index - b.index;\n      });\n    }\n  }]);\n\n  return TributeSearch;\n}();\n\nvar _default = TributeSearch;\nexports[\"default\"] = _default;\nmodule.exports = exports.default;\n\n},{}],6:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _Tribute = _interopRequireDefault(require(\"./Tribute\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\n/**\n* Tribute.js\n* Native ES6 JavaScript @mention Plugin\n**/\nvar _default = _Tribute[\"default\"];\nexports[\"default\"] = _default;\nmodule.exports = exports.default;\n\n},{\"./Tribute\":1}],7:[function(require,module,exports){\n\"use strict\";\n\nif (!Array.prototype.find) {\n  Array.prototype.find = function (predicate) {\n    if (this === null) {\n      throw new TypeError('Array.prototype.find called on null or undefined');\n    }\n\n    if (typeof predicate !== 'function') {\n      throw new TypeError('predicate must be a function');\n    }\n\n    var list = Object(this);\n    var length = list.length >>> 0;\n    var thisArg = arguments[1];\n    var value;\n\n    for (var i = 0; i < length; i++) {\n      value = list[i];\n\n      if (predicate.call(thisArg, value, i, list)) {\n        return value;\n      }\n    }\n\n    return undefined;\n  };\n}\n\nif (window && typeof window.CustomEvent !== \"function\") {\n  var CustomEvent = function CustomEvent(event, params) {\n    params = params || {\n      bubbles: false,\n      cancelable: false,\n      detail: undefined\n    };\n    var evt = document.createEvent('CustomEvent');\n    evt.initCustomEvent(event, params.bubbles, params.cancelable, params.detail);\n    return evt;\n  };\n\n  if (typeof window.Event !== 'undefined') {\n    CustomEvent.prototype = window.Event.prototype;\n  }\n\n  window.CustomEvent = CustomEvent;\n}\n\n},{}]},{},[6])(6)\n});\n"]},"metadata":{},"sourceType":"module"}